---
author: laurenhughes
ms.assetid: 96361CAF-C347-4671-9721-8208CE118CA4
title: UWP アプリのパッケージ化
description: ユニバーサル Windows プラットフォーム (UWP) アプリを配布または販売するには、そのアプリのアプリ パッケージを作成する必要があります。
ms.author: lahugh
ms.date: 06/10/2018
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP
f1_keywords:
- vs.packagewizard
- vs.storeassociationwizard
ms.localizationpriority: medium
ms.openlocfilehash: eb930c5e6b2c1c1f864f2e63fbce97c89bb89e1f
ms.sourcegitcommit: 1e5590dd10d606a910da6deb67b6a98f33235959
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/31/2018
ms.locfileid: "3228524"
---
# <a name="package-a-uwp-app-with-visual-studio"></a>Visual Studio で UWP アプリをパッケージ化する

ユニバーサル Windows プラットフォーム (UWP) アプリを販売、または他のユーザーに配布するには、パッケージ化する必要があります。 Microsoft Store を通じてアプリを配布しない場合は、アプリ パッケージを直接デバイスにサイドローディングしたり、[Web インストール](installing-UWP-apps-web.md)を通じて配布したりすることができます。 この記事では、Visual Studio を使って UWP アプリ パッケージを構成、作成、テストする方法について説明します。 基幹業務 (LOB) アプリの管理および展開について詳しくは、[エンタープライズ アプリ管理に関するページ](https://docs.microsoft.com/windows/client-management/mdm/enterprise-app-management)をご覧ください。

Windows 10 では、アプリ パッケージ (.appx)、アプリ バンドル (.appxbundle)、または完全なアプリ パッケージ アップロードファイル (.appxupload) を Windows デベロッパー センターに提出できます。 これらのオプションのうち、パッケージ アップロード ファイルの提出が最適なエクスペリエンスになります。 

## <a name="types-of-app-packages"></a>アプリ パッケージの種類

- **アプリ パッケージ (.appx)**  
    デバイスにサイドローディングできる形式でアプリが含まれているファイル。 Visual Studio により作成される単一の .appx パッケージ ファイルはどれもデベロッパー センターに提出するためのものでは**なく**、サイドローディングおよびテスト目的でのみ使う必要があります。 デベロッパー センターにアプリを提出する場合、アプリ パッケージ アップロード ファイルを使います。  

- **アプリ バンドル (.appxbundle)**  
    アプリ バンドルは、複数のアプリ パッケージを含めることができるパッケージの種類であり、それぞれ特定のデバイス アーキテクチャをサポートするようにビルドされます。 たとえば、アプリ バンドルには x86、x64、および ARM 構成用の別個のアプリ パッケージを含めることができます。 アプリ バンドルによってできる限り広範なデバイスでアプリが利用できるようになるため、アプリ バンドルは可能であれば必ず生成してください。  

- **アプリ パッケージ アップロード ファイル (.appxupload)**  
    さまざまなプロセッサ アーキテクチャをサポートする複数のアプリ パッケージまたは 1 つのアプリ バンドルを含めることができる 1 つのファイルです。 アプリが Microsoft Store に公開されると、アップロード ファイルには[アプリのパフォーマンスを分析](https://docs.microsoft.com/windows/uwp/publish/analytics)するためのシンボル ファイルも含められます。 このファイルは、デベロッパー センターに提出して公開することを目的として Visual Studio を使ってアプリをパッケージ化する場合は自動的に作成されます。 Visual Studio を使って作成できる有効なアプリ パッケージのデベロッパー センター申請はこれ**だけ**である点に注意することは重要です。

アプリ パッケージを準備して作成する手順の概要は次のとおりです。

1.  [アプリ パッケージを作成する前に](#before-packaging-your-app)。 ここでの手順に従って、アプリがデベロッパー センターへの申請用にパッケージ化の準備ができていることを確認します。
2.  [アプリ パッケージを構成する](#configure-an-app-package)。 Visual Studio マニフェスト デザイナーを使って、パッケージを構成します。 たとえば、タイル画像を追加し、アプリでサポートされる向きを選びます。
3.  [アプリ パッケージ アップロード ファイルを作成する](#create-an-app-package-upload-file)。 Visual Studio のアプリ パッケージ ウィザードを使ってアプリ パッケージを作成してから、Windows アプリ認定キットを使ってそのパッケージを認定します。
4.  [アプリ パッケージをサイドローディングする](#sideload-your-app-package)。 アプリをサイドローディングした後、そのアプリが期待どおりに動作することをテストできます。

これらの手順を完了したら、アプリを配布できるようになります。 内部ユーザー専用で販売する予定がない基幹業務 (LOB) アプリがある場合は、そのアプリをサイドローディングして、任意の Windows 10 デバイスにインストールできます。

## <a name="before-packaging-your-app"></a>アプリ パッケージを作成する前に

1.  **アプリをテストする。** デベロッパー センターへの申請用にアプリ パッケージを作成する前に、サポート予定のすべてのデバイス ファミリでそのアプリが想定どおりに動作することを確認します。 これらのデバイス ファミリには、デスクトップ、モバイル、Surface Hub、Xbox、IoT デバイスなどが含まれる場合があります。
2.  **アプリを最適化する。** Visual Studio のプロファイリングおよびデバッグ ツールを使って、UWP アプリのパフォーマンスを最適化できます。 たとえば、UI 応答のタイムライン ツール、メモリ使用率のツール、CPU 使用率のツールを使えます。 これらのコマンド ライン ツールについて詳しくは、[プロファイリング機能ツアーに関するページ](https://docs.microsoft.com/visualstudio/profiling/profiling-feature-tour)をご覧ください。
3.  **.NET ネイティブ互換性を確認する (VB と C# のアプリの場合)。** ユニバーサル Windows プラットフォームには、アプリの実行時のパフォーマンスを向上させるネイティブ コンパイラがあります。 この変更により、新しいコンパイル環境でアプリをテストする必要があります。 既定では、**リリース** ビルド構成により、.NET ネイティブ ツール チェーンが可能であるため、重要なのは、この**リリース**構成でアプリをテストし、想定どおりにアプリが動作することを確認することです。 .NET ネイティブで発生する可能性のあるいくつかの一般的なデバッグの問題について詳しくは、[.NET Native Windows ユニバーサル アプリのデバッグ](http://blogs.msdn.com/b/visualstudioalm/archive/2015/07/29/debugging-net-native-windows-universal-apps.aspx)に関するブログをご覧ください。

## <a name="configure-an-app-package"></a>アプリ パッケージを構成する

アプリ マニフェスト ファイル (Package.appxmanifest) は、アプリ パッケージの作成に必要なプロパティと設定が含まれている XML ファイルです。 たとえば、アプリ マニフェスト ファイル内のプロパティには、アプリのタイルとして使う画像や、ユーザーがデバイスを回転するときにアプリでサポートされる向きを定義します。

Visual Studio のマニフェスト デザイナーを使えば、生の XML を編集することなくマニフェスト ファイルを更新できます。

**マニフェスト デザイナーを使ってパッケージを構成する**

1.  **ソリューション エクスプローラー**で、UWP アプリのプロジェクト ノードを展開します。
2.  **[Package.appxmanifest]** ファイルをダブルクリックします。 マニフェスト ファイルが既に XML コード ビューで開かれている場合は、ファイルを閉じるよう指示するプロンプトが Visual Studio で表示されます。
3.  この時点で、アプリをどのように構成するかを決めることができます。 各タブには、アプリについて構成可能な情報や、さらに情報が必要なときのためのリンクがあります。  
    ![Visual Studio マニフェスト デザイナー](images/packaging-screen1.jpg)

    [**ビジュアル資産**] タブで、UWP アプリに必要なすべての画像があることを確認します。

    [**パッケージ化**] タブで、公開するデータを入力できます。 ここで、アプリの署名に使う証明書を選べます。 すべての UWP アプリは証明書で署名する必要があります。 
    
    >[!IMPORTANT]
    >Microsoft Store でアプリを公開する場合、アプリが信頼済み証明書で自動的に署名されます。 これにより、ユーザーは関連付けられているアプリの署名証明書をインストールしなくてもアプリをインストールして実行できます。 
    
    アプリを公開せず、アプリ パッケージをサイドローディングするだけの場合、まずパッケージを信頼する必要があります。 パッケージを信頼するには、証明書がユーザーのデバイスにインストールされていなければなりません。 サイドローディングについて詳しくは、「[デバイスを開発用に有効にする](https://docs.microsoft.com/windows/uwp/get-started/enable-your-device-for-development)」をご覧ください。

4.  アプリに必要な編集を行った後に、**Package.appxmanifest** ファイルを保存します。

Microsoft Store を使ってアプリを配布する場合、Visual Studio は Microsoft Store でパッケージを関連付けることができます。 アプリを関連付けると、マニフェスト デザイナーの [パッケージ化] タブの一部のフィールドが自動的に更新されます。

## <a name="create-an-app-package-upload-file"></a>アプリ パッケージ アップロード ファイルの作成

Microsoft Store を通じてアプリを配布するには、アプリ パッケージ (.appx)、アプリ バンドル (.appxbundle)、またはアップロード パッケージ (.appxupload) を作成し、[パッケージ化されたアプリをデベロッパー センターに提出](https://docs.microsoft.com/windows/uwp/publish/app-submissions)する必要があります。 アプリ パッケージやアプリ バンドルを単独でデベロッパー センターに提出することはできますが、アップロード パッケージを提出することをお勧めします。

>[!NOTE]
> Visual Studio を使って作成可能なデベロッパー センターの有効なアプリ パッケージの種類は、アプリ パッケージ アップロード ファイル (.appxupload) **だけ**です。 その他の有効な[アプリ パッケージは、Visual Studio を使わずに手動で作成することができます](https://docs.microsoft.com/windows/uwp/packaging/create-app-package-with-makeappx-tool)。 

これは**アプリ パッケージの作成**ウィザードを使って行えます。 次の手順に従って、Visual Studio でデベロッパー センターへの申請用にパッケージを作成します。

**アプリ パッケージ アップロード ファイルを作成するには**

1.  **ソリューション エクスプローラー**で、UWP アプリ プロジェクトのソリューションを開きます。
2.  プロジェクトを右クリックし、**[ストア]** -> **[アプリ パッケージの作成]** の順に選択します。 このオプションが無効になっているか、まったく表示されない場合は、プロジェクトがユニバーサル Windows プロジェクトであることを確認します。  
    ![コンテキスト メニューと [アプリ パッケージの作成] へのナビゲーション](images/packaging-screen2.jpg)

    **アプリ パッケージの作成**ウィザードが表示されます。

3.  デベロッパー センターにアップロードするパッケージを作成するかどうかを確認する最初のダイアログ ボックスで [はい] を選び、[次へ] をクリックします。  
    ![[パッケージの作成] ダイアログ ウィンドウ](images/packaging-screen3.jpg)

    [いいえ] を選んだ場合、Visual Studio では、デベロッパー センターへの申請に使うアプリ パッケージ アップロード (.appxupload) ファイルは生成されません。 アプリをサイドローディングして社内デバイスで実行するだけの場合やテスト目的の場合は、このオプションを選ぶことができます。 サイドローディングについて詳しくは、「[デバイスを開発用に有効にする](https://docs.microsoft.com/windows/uwp/get-started/enable-your-device-for-development)」をご覧ください。
4.  開発者アカウントで Windows デベロッパー センターにログインします  まだ開発者アカウントがない場合は、ウィザードで作成できます。
5.  パッケージのアプリ名を選びます。または、Windows デベロッパー センター ポータルでまだ予約していない場合は、新しいアプリ名を予約します。  
    ![[アプリ パッケージの作成] ウィンドウのアプリ名の選択画面](images/packaging-screen4.jpg)
6.  必ず、**[パッケージの選択と構成]** ダイアログ ボックスで 3 つのアーキテクチャ構成 (x86、x64、ARM) をすべて選択し、できるだけ広範なデバイスにアプリを展開できるようにしてください。 **[アプリケーション バンドルの生成]** ボックスで **[常に行う]** を選びます。 アプリ バンドル (.appxbundle) は、プロセッサ アーキテクチャの種類ごとに構成されているアプリ パッケージのコレクションが含まれているため、単一のアプリ パッケージ (.appx) よりも優先されます。 アプリ バンドルの生成を選ぶと、デバッグおよびクラッシュ分析情報と共に、アプリ バンドルが最終的なアプリ パッケージ アップロード (.appxupload) ファイルに含められます。 どのアーキテクチャを選べばよいかわからない場合や、各種デバイスにより使用されるアーキテクチャについて詳しく調べる場合は、「[アプリ パッケージのアーキテクチャ](https://docs.microsoft.com/windows/uwp/packaging/device-architecture)」をご覧ください。  
    ![[アプリ パッケージの作成] ウィンドウのパッケージ構成画面](images/packaging-screen5.jpg)


7.  アプリが公開された後に Windows デベロッパー センターから[アプリのパフォーマンスを分析](https://docs.microsoft.com/windows/uwp/publish/analytics)するために完全な PDB シンボル ファイルを含めます。 バージョンの番号付けやパッケージの出力場所など、他の詳細情報を構成します。
9.  **[作成]** をクリックして、アプリ パッケージを生成します。 手順 3 で **[はい]** を選び、デベロッパー センターへの申請用のパッケージを作成している場合、ウィザードによりパッケージ アップロード (.appxupload) ファイルが作成されます。 手順 3 で **[いいえ]** を選んだ場合、手順 6 での選択内容に基づいてウィザードにより単一のアプリ パッケージまたはアプリ バンドルが作成されます。
10. アプリが正常にパッケージ化されると、このダイアログ ボックスが表示されます。  
    ![[パッケージの作成が完了しました] ウィンドウの検証オプション](images/packaging-screen6.jpg)

    アプリをデベロッパー センターに提出する前に、認定されるようにローカルまたはリモート コンピューターで検証します。 アプリ パッケージのデバッグ ビルドではなくリリース ビルドのみを検証できます。

11. アプリをローカルで検証するには、**[ローカル コンピューター]** オプションを選んだままで、**[Windows アプリ認定キットを起動する]** をクリックします。 Windows アプリ認定キットでアプリをテストする方法について詳しくは、「[Windows アプリ認定キット](https://msdn.microsoft.com/library/windows/apps/Mt186449)」をご覧ください。

    Windows アプリ認定キットはさまざまなテストを実行し、結果を返します。 より具体的な情報については、「[Windows アプリ認定キットのテスト](https://msdn.microsoft.com/library/windows/apps/mt186450)」をご覧ください。

    リモート Windows 10 デバイスを使ってテストする場合は、そのデバイスに Windows アプリ認定キットを手動でインストールする必要があります。 この手順については、次のセクションで説明します。 その後、[**リモート コンピューター**] を選び、[**Windows アプリ認定キットを起動する**] をクリックしてリモート デバイスに接続し、検証テストを実行します。

12. WACK の終了後、アプリが認定に合格したら、デベロッパー センターにアプリを提出できるようになります。 必ず正しいファイルをアップロードしてください。 ファイルは既定の位置は、ソリューションのルート フォルダー `\[AppName]\AppPackages` にあり、.appxupload というファイル拡張子が付いています。 パッケージ アーキテクチャがすべて選択されたアプリ バンドルを選んだ場合、名前は `[AppName]_[AppVersion]_x86_x64_arm_bundle.appxupload` の形式になります。

デベロッパー センターへのアプリの申請について詳しくは、「[アプリの申請](https://docs.microsoft.com/windows/uwp/publish/app-submissions)」をご覧ください。

**リモート Windows 10 デバイスでアプリ パッケージを検証する**

1.  「[デバイスを開発用に有効にする](https://msdn.microsoft.com/library/windows/apps/Dn706236)」の手順に従って、開発用に Windows 10 デバイスを有効にします。
    **重要:** Windows 10 対応のリモート ARM デバイスでアプリ パッケージを検証することはできません。
2.  Visual Studio のリモート ツールをダウンロードしてインストールします。 これらのツールを使って Windows アプリ認定キットをリモートで実行します。 これらのツールについてダウンロード場所など詳しくは、[リモート コンピューターでの UWP アプリの実行](https://msdn.microsoft.com/library/hh441469.aspx#BKMK_Starting_the_Remote_Debugger_Monitor)に関するページをご覧ください。
3.  必要な [Windows アプリ認定キット](http://go.microsoft.com/fwlink/p/?LinkID=309666)をダウンロードし、リモート Windows 10 デバイスにインストールします。
4.  **パッケージの作成が完了しました**ウィザードのページで、[**リモート コンピューター**] オプション ボタンを選び、[**テスト接続**] ボタンの横にある省略記号ボタンをクリックします。
    **注:** **[リモート コンピューター]** オプション ボタンを使用できるのは、検証をサポートするソリューション構成を少なくとも 1 つ選んだ場合のみです。 WACK でアプリをテストする方法について詳しくは、「[Windows アプリ認定キット](https://msdn.microsoft.com/library/windows/apps/Mt186449)」をご覧ください。
5.  サブネットの内部にあるデバイスの形式を指定するか、サブネットの外部にあるデバイスのドメイン ネーム サーバー (DNS) 名または IP アドレスを指定します。
6.  Windows 資格情報を使ってデバイスにログオンする必要がない場合は、**[認証モード]** ボックスの一覧で **[なし]** を選びます。
7.  **[選択]**、**[Windows アプリ認定キットを起動する]** の順に選びます。 デバイスでリモート ツールが実行されていれば、Visual Studio がデバイスに接続されてから、検証テストが実行されます。 「[Windows アプリ認定キットのテスト](https://msdn.microsoft.com/library/windows/apps/mt186450)」をご覧ください。

## <a name="sideload-your-app-package"></a>アプリ パッケージをサイドローディングする

Windows 10 Anniversary Update 以降では、アプリ パッケージ ファイルをダブルクリックするだけでアプリ パッケージをインストールできます。 これを使うには、アプリ パッケージ (.appx) ファイルまたはアプリ バンドル (.appxbundle) ファイルに移動してダブルクリックします。 アプリのインストーラーが起動し、アプリの基本情報と、インストール ボタン、インストール進行状況バー、関連するエラー メッセージが表示されます。 

![Contoso というサンプル アプリをインストールするために、アプリのインストーラーが表示されます。](images/appinstaller-screen.png)

> [!NOTE]
> アプリのインストーラーは、アプリがデバイスによって信頼されていることを前提としています。 開発者アプリまたはエンタープライズ アプリをサイドローディングする場合、デバイス上の信頼されたユーザー ストアまたは信頼された発行元証明機関ストアに署名証明書をインストールする必要があります。 この方法がわからない場合は、[テスト証明書のインストール](https://docs.microsoft.com/windows-hardware/drivers/install/installing-test-certificates)に関するページをご覧ください。

### <a name="sideload-your-app-on-previous-versions-of-windows"></a>以前のバージョンの Windows でアプリをサイドローディングする
UWP アプリ パッケージの場合、デスクトップ アプリを使っているときは、アプリがデバイスにインストールされません。 通常、Microsoft Store から UWP アプリをダウンロードし、デバイスにアプリをインストールします。 アプリは Microsoft Store で公開せずにインストールできます (サイドローディング)。 これにより、作成したアプリ パッケージ (.appx) を使って、アプリをインストールし、テストできます。 基幹業務 (LOB) アプリのように、ストアで販売しないアプリの場合は、そのアプリをサイドローディングして、社内の他のユーザーが使えるようにできます。

次に示しているのは、アプリをサイドローディングするための要件です。

-   [開発用にデバイスを有効にする](https://msdn.microsoft.com/library/windows/apps/Dn706236)必要があります。
-   Windows 10 Mobile デバイスにアプリをサイドローディングするには、[WinAppDeployCmd.exe](install-universal-windows-apps-with-the-winappdeploycmd-tool.md) ツールを使います。

**デスクトップ、ノート PC、またはタブレットにアプリをサイドローディングする**

1.  インストールするアプリ バージョンのフォルダーをターゲット デバイスにコピーします。

    アプリ バンドルを作成した場合は、バージョン番号に基づいたフォルダーと `*_Test` フォルダーが必要です。 たとえば、2 つのフォルダーは次のようになります (インストールするバージョンは 1.0.2.0)。

    -   `C:\Projects\MyApp\MyApp\AppPackages\MyApp_1.0.2.0`
    -   `C:\Projects\MyApp\MyApp\AppPackages\MyApp_1.0.2.0_Test`

    アプリ バンドルがない場合は、適切な構造になっているフォルダーと対応する `*_Test` フォルダーをコピーします。 次の 2 つのフォルダーは、x64 アーキテクチャのアプリ パッケージとその `*_Test` フォルダーの例です。

    -   `C:\Projects\MyApp\MyApp\AppPackages\MyApp_1.0.2.0_x64`
    -   `C:\Projects\MyApp\MyApp\AppPackages\MyApp_1.0.2.0_x64_Test`

2.  ターゲット デバイスで `*_Test` フォルダーを開きます。
3.  **Add-AppDevPackage.ps1** ファイルを右クリックします。 **[PowerShell で実行]** を選んで、画面の指示に従います。  
    ![エクスプローラーでの PowerShell スクリプトへのナビゲーション](images/packaging-screen7.jpg)

    アプリ パッケージがインストールされると、PowerShell のウィンドウで "**アプリが正常にインストールされました**" というメッセージが表示されます。

    **ヒント**: タブレットでショートカット メニューを開くには、右クリックする画面をタッチし、完全な円が表示されてから指を離します。 指を放した後にショートカット メニューが表示されます。
4.  スタート ボタンをクリックし、アプリをアプリ名で検索してから起動します。
