---
author: awkoren
Description: "Windows デスクトップ アプリケーション (Win32、WPF、Windows フォームなど) を、デスクトップの変換拡張機能を使ってユニバーサル Windows プラットフォーム (UWP) アプリに変換する準備を行います。"
Search.Product: eADQiWindows 10XVcnh
title: "デスクトップ アプリケーションをユニバーサル Windows プラットフォーム (UWP) アプリに変換する"
ms.sourcegitcommit: 37d4c8ef6178fe78c7333c47848177b5185c6d61
ms.openlocfilehash: 16d75ebd2499e56af742c1c9994fd92cc320c22b

---

# デスクトップ アプリケーションをユニバーサル Windows プラットフォーム (UWP) アプリに変換する

\[一部の情報はリリース前の製品に関することであり、正式版がリリースされるまでに大幅に変更される可能性があります。 ここに記載された情報について、マイクロソフトは明示または黙示を問わずいかなる保証をするものでもありません。\]

Windows デスクトップ アプリケーション (Win32、WPF、Windows フォームなど) を、デスクトップの変換拡張機能を使ってユニバーサル Windows プラットフォーム (UWP) アプリに変換する準備を行います。

## アプリケーションを UWP に変換する利点

デスクトップの変換拡張機能を使う UWP は、従来のデスクトップ アプリケーション (Win32、Windows フォーム、WPF など) やゲームをユニバーサル Windows プラットフォーム (UWP) アプリやゲームに変換するためのブリッジです。 詳しくは、「[UWP アプリ ガイド](https://msdn.microsoft.com/library/windows/apps/dn894631.aspx)」をご覧ください。 従来のデスクトップ アプリは、変換後、Windows 10 デスクトップをターゲットとする UWP アプリ パッケージ (.appx または .appxbundle) の形式でパッケージ化され、処理されて、展開されます。

デスクトップ アプリの UWP パッケージへの変換を可能にするテクノロジは、2 つあります。 1 つ目は、Desktop App Converter です。既存のバイナリを取り込んで、UWP パッケージとして再パッケージ化します。 コードは、同じままで、パッケージ化の方法だけが異なります。 2 つ目は、Windows Anniversary Update の各種ランタイムテクノロジーで、UWP パッケージを、アプリ コンテナーではなく完全な信頼として実行される実行可能ファイルにします。 このテクノロジにより、変換済みのアプリにパッケージ ID が与えられます。パッケージ ID は一部の UWP API を使用するときに必要です。

次に、従来のデスクトップ アプリを変換する利点をいくつか示します。

* アプリのインストール エクスペリエンスが、お客様にとってスムーズになります。 サイドローディングを使ってアプリをコンピューターに展開でき (「[Windows 10 での LOB アプリのサイドローディング](https://technet.microsoft.com/library/mt269549.aspx)」を参照)、アンインストール後に何も残りません。 長い間、Windows ストアにアプリを公開できます。

* 変換済みのアプリにはパッケージ ID があるので、完全に信頼できるパーティションからでも、以前よりも多くの UWP API を呼び出すことができます。

* 自分のペースで、XAML ユーザー インターフェイス、ライブ タイルの更新、UWP バックグラウンド タスク、アプリ サービスなどの多くの UWP 機能をアプリのパッケージに追加できます。 他の UWP アプリで利用できるすべての機能を、自分のアプリで利用できます。

* アプリのすべての機能をアプリの完全に信頼できるパーティションから、アプリ コンテナー パーティションに移動すると、すべての Windows 10 デバイスでアプリを実行できるようになります。

* アプリは、UWP アプリとして、従来のデスクトップ アプリと同じことを実行できます。 アプリは、実際のレジストリおよびファイル システムからは区別されている、仮想化ビューのレジストおよびファイル システムと通信します。

* アプリは、Windows ストアの組み込みライセンスと自動更新機能に参加できます。 自動更新機能は、ファイルの変更された部分だけがダウンロードされるため、非常に信頼性が高く効率的なメカニズムです。

## デスクトップ アプリを UWP に変換する準備をする
アプリの変換プロセス準備に多くの作業は必要ありません。 Windows ストアがライセンスを処理して自動更新するため、これらの機能をコードベースから削除できることを思い出してください。 次の状況のいずれかがアプリケーションに該当する場合は、変換する前に、この問題に対処する必要があります。

+ __アプリでバージョン 4.6.1 よりも前のバージョンの .NET を使用している__。 .NET 4.6.1 のみがサポートされています。 変換する前にアプリのターゲットを .NET 4.6.1 に変更する必要があります。 

+ __常に管理者特権のセキュリティ権限でアプリを実行する__。 アプリは、対話ユーザーとして実行中にも機能する必要があります。 Windows ストアからアプリをインストールするユーザーはシステム管理者ではない可能性があります。そのため、アプリは、標準ユーザーでは正しく動作しない、管理者だけが実行できる方法で実行する必要があります。

+ __アプリにカーネル モード ドライバーや Windows サービスが必要__。 ブリッジはアプリには適していますが、システム アカウントで実行する必要があるカーネル モード ドライバーや Windows サービスはサポートしていません。 Windows サービスの代わりに、[バックグラウンド タスク](https://msdn.microsoft.com/windows/uwp/launch-resume/create-and-register-a-background-task)を使います。

+ __アプリのモジュールが AppX パッケージに含まれていないプロセスに読み込まれるインプロセスである__。 これは許可されていません。つまり、[シェルの拡張機能](https://msdn.microsoft.com/library/windows/desktop/dd758089.aspx)などのインプロセスの拡張機能はサポートされていません。 ただし、同じパッケージに 2 つのアプリが含まれている場合に、そのアプリ間でプロセス間通信することはできます。

+ __アプリでカスタム アプリケーション ユーザー モデル ID (AUMID) を使う__。 プロセスから [SetCurrentProcessExplicitAppUserModelID](https://msdn.microsoft.com/library/windows/desktop/dd378422.aspx) を呼び出して独自の AUMID を設定する場合、アプリ モデル環境/AppX パッケージでその目的で生成された AUMID しか使えません。 カスタムの AUMID を定義することはできません。

+ __アプリが HKEY_LOCAL_MACHINE (HKLM) レジストリ ハイブを変更する__。 アプリから HKLM キーを作成しようとしたり、変更のために開こうとしたりすると、アクセス拒否エラーが発生します。 アプリには、レジストリを仮想化した独自のプライベート ビューがあるため、ユーザーやマシン全体のレジストリ ハイブ (HKLM はこれに相当) の概念は適用されないことに注意してください。 HKLM を使って実現していたことを、HKEY_CURRENT_USER (HKCU) に書き込むなど別の方法で実現する必要があります。

+ __アプリで、別のアプリを起動する手段として ddeexec レジストリ サブキーを使っている__。 代わりに、[アプリ パッケージ マニフェスト](https://msdn.microsoft.com/library/windows/apps/br211474.aspx)のさまざまなアクティブ化可能* な拡張機能で構成する DelegateExecute verb ハンドラーの 1 つを使います。

+ __アプリが、別のアプリとデータを共有するために AppData フォルダーに書き込みを行う__。 変換後、AppData はローカル アプリ データ ストアにリダイレクトされます。このストアは、各 UWP アプリのプライベート ストアです。 プロセス間データ共有に別の方法を使います。 詳しくは、「[設定と他のアプリ データを保存して取得する](https://msdn.microsoft.com/windows/uwp/app-settings/store-and-retrieve-app-data)」をご覧ください。

+ __アプリが、アプリのインストール ディレクトリに書き込みを行う__。 たとえば、exe と同じディレクトリに置いたログ ファイルにアプリが書き込む場合などです。 この書き込みは、サポートされていないため、ローカル アプリ データ ストアなどの別の場所にする必要があります。

+ __アプリのインストールでユーザーの対話式操作を求める__。 アプリ インストーラーはサイレント実行でき、クリーンな状態の OS イメージには既定では存在しないすべての前提条件をインストールする必要があります。

+ __アプリで現在の作業ディレクトリを使う__。 変換済みのアプリでは、実行時に、デスクトップで以前に指定していたのと同じ作業ディレクトリ (.LNK ショートカット) を取得しません。 アプリを正しく動作させるために現在のディレクトリを取得することが重要な場合は、実行時に CWD を変更する必要があります。

+ __アプリで UIAccess が必要__。 アプリケーションが UAC マニフェストの `requestedExecutionLevel` 要素で `UIAccess=true` を指定している場合の UWP への変換は現在サポートされていません。 詳しくは、「[UI オートメーション セキュリティの概要](https://msdn.microsoft.com/library/ms742884.aspx)」をご覧ください。

+ __アプリが COM オブジェクトや GAC アセンブリを他のプロセスで使用できるように公開している__。 現在のリリースでは、AppX パッケージ外部の実行可能ファイルから生成されたプロセスで使用できるように、アプリが COM オブジェクトや GAC アセンブリを公開することはできません。 パッケージ内のプロセスは、通常どおり、COM オブジェクトや GAC アセンブリを登録して使用できますが、外部からは認識されません。 つまり、OLE などの相互運用機能のシナリオは、外部プロセスによって呼び出された場合、機能しません。 

+ __アプリがサポートされていない方法で C ランタイム ライブラリにリンクされている__。 Microsoft C/C++ ランタイム ライブラリは、Microsoft Windows オペレーティング システムのプログラミングのルーチンを提供します。 これらのルーチンは、C および C++ 言語では提供されない、多くの一般的なプログラミング タスクを自動化します。 アプリで C/C++ ランタイム ライブラリを使用している場合、サポートされている方法でリンクされていることを確認する必要があります。 
    
    Visual Studio 2015 は、現在のバージョンの CRT に対して、コードで共通の DLL ファイルを使用できるようにするダイナミック リンクと、コードに直接ライブラリをリンクするスタティック リンクの両方をサポートしています。 可能であれば、アプリで VS 2015 へのダイナミック リンクを使用することをお勧めします。 

    以前のバージョンの Visual Studio でのサポートは異なります。 詳しくは、次の表をご覧ください。 

    <table>
    <th>Visual Studio のバージョン</td><th>ダイナミック リンク</th><th>スタティック リンク</th></th>
    <tr><td>2005 (VC 8)</td><td>サポートされない</td><td>サポートされる</td>
    <tr><td>2008 (VC 9)</td><td>サポートされない</td><td>サポートされる</td>
    <tr><td>2010 (VC 10)</td><td>サポートされる</td><td>サポートされる</td>
    <tr><td>2012 (VC 11)</td><td>サポートされる</td><td>サポートされない</td>
    <tr><td>2013 (VC 12)</td><td>サポートされる</td><td>サポートされない</td>
    <tr><td>2015 (VC 14)</td><td>サポートされる</td><td>サポートされる</td>
    </table>
    
    注: いずれの場合も、最新の公開されている CRT にリンクする必要があります。

+ __アプリが Windows サイドバイサイド フォルダーからアセンブリをインストールする/読み込む__。 たとえば、アプリが C ランタイム ライブラリ VC8 または VC9 を使用しており、Windows サイドバイサイド フォルダーから動的にリンクしている、つまり、コードが共有フォルダーから共通の DLL ファイルを使用しているとします。 これはサポートされていません。 再頒布可能なライブラリ ファイルをコードに直接リンクして、静的にリンクする必要があります。


## このセクションの内容

| トピック | 説明 |
|-------|-------------|
| [Desktop App Converter プレビュー (Project Centennial)](desktop-to-uwp-run-desktop-app-converter.md) | Desktop App Converter を実行する方法が説明されています。 通常は、アプリの変換プロセス準備にそれほど多くの作業は必要ありません。 |
| [手動で Windows デスクトップ アプリケーションをユニバーサル Windows プラットフォーム (UWP) アプリに変換する](desktop-to-uwp-manual-conversion.md) | 手動でアプリ パッケージとマニフェストを作成する方法について説明します。 |
| [変換済みの UWP アプリを展開してデバッグする](desktop-to-uwp-deploy-and-debug.md) | 変換後のアプリの正常な展開とデバッグに役立つ情報が含まれています。 また、デスクトップの変換拡張機能の内部に関心をお持ちの場合にも、このトピックは役に立ちます。 |
| [デスクトップ アプリから UWP へのブリッジのコード サンプル](https://github.com/Microsoft/DesktopBridgeToUWP-Samples) | 変換されたアプリの機能の示す GitHub のコード サンプルです。 |



<!--HONumber=Jun16_HO4-->


