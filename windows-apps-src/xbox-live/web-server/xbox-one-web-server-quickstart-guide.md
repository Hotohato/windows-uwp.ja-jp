---
title: "Xbox One Web サーバー クイックスタート ガイド"
author: KevinAsgari
description: "Xbox One Web サーバーをセットアップする方法について説明します。"
ms.assetid: 2f6831ab-2dea-4f21-bb32-39cb4de4799c
ms.author: kevinasg
ms.date: 04-04-2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: "Xbox Live, Xbox, ゲーム, UWP, Windows 10, Xbox One, Web サーバー"
ms.openlocfilehash: 58c2d3adb667a02f9540c7fd25346a68e93d71b9
ms.sourcegitcommit: a7a1b41c7dce6d56250ce3113137391d65d9e401
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/11/2017
---
# <a name="xbox-one-web-server-quickstart-guide"></a>Xbox One Web サーバー クイックスタート ガイド

> **注** このトピックは、高度なトピックであり、対象パートナーと ID@Xbox メンバーだけが利用できるアクセス許可が制限されたサイトへのアクセスが必要です。

Xbox One 開発に使用するシンプルな Web サーバーのセットアップ手順について説明します。

-   [概要](#introduction)
-   [サーバーのセットアップ](#server-setup)
-   [SimpleAuthService サンプル Web サイトの配置用の構築](#build-sample-website)
-   [IIS の構成とサンプル Web サイトの実行](#configure-sample-website)
-   [証明書利用者および XSTS トークンのセットアップの検証](#verify-tokens)
-   [Web サービスの HTTPS の有効化](#enable-https)
-   [FAQ とトラブルシューティング](#faqs-and-troubleshooting)


## <a name="introduction"></a>概要

Xbox One および Xbox Live プラットフォームでは、RESTful HTTPS 通信が多用されます。 また Xbox One では、デベロッパーは、Xbox 360 で必須とされていた Xbox Live サーバー プラットフォーム (XLSP) 接続ではなく、HTTPS を使用した独自のゲーム サーバーをセットアップできます。 これにより、さらに柔軟で、高速で、信頼性の高いゲーム サービスをタイトルで提供できるようになります。

このクイックスタート ガイドでは、Game Developer Network (GDN) から入手できる Simple Web Server サンプル ("SimpleAuthService") を使用して、動作する HTTP/HTTPS Web サービスを Xbox One タイトルのためにセットアップする方法について学びます。 ガイドでは、Xbox One タイトルおよびサーバー間の通信に Xbox Secure Token Service (XSTS) トークンおよび HTTPS を使用した検証を開始できるよう、サンプルの Web サービスを実行する Windows サーバーのセットアップについてひととおり説明します。 Microsoft Azure を通じて、サーバー用の新しい仮想マシンをすばやく簡単にセットアップする手順についても説明します。


## <a name="server-setup"></a>サーバーのセットアップ

Xbox One Web サービスを実行するための Relying Party SDK およびサンプルは GDN で提供され、Windows Server 2008 R2 以降で動作します。 以下の手順は、Windows Server 2012 R2 を実行するサーバーをセットアップすることを想定しています。 バージョンが異なっていても必要なセットアップは基本的に同じですが、サーバーのセットアップ機能のいくつかについて、アクセスする場所が若干異なる可能性があります。 Windows Server ソフトウェアがインストールされた物理マシンをサーバーとして使用するか、または Azure を使用して仮想マシンをセットアップすることができます。

-   [Azure 仮想マシンのセットアップ](#azure-virtual-machine-setup)
-   [サーバーの役割と機能のセットアップ](#server-roles-and-features-setup)
-   [証明書のインストール](#certificate-installation)


### <a name="azure-virtual-machine-setup"></a>Azure 仮想マシンのセットアップ

Azure にアクセスできる場合、開発およびテスト用の仮想サーバーをすばやく簡単にセットアップできます。 以下の手順に従うだけです。

1. 自分のアカウントを使用して [Azure Portal](https://manage.windowsazure.com/) にログインします。

1. **[仮想マシン]** を選択して **[+ 新規]** をクリックします。

1. **[簡易作成]** を選択します。

1. サービスの DNS 名を入力します。 その名前に ".cloudapp.net" を付け加えたものが、サーバーの HTTP 呼び出しを行うために使用するドメイン名になります。

1. [Windows Server 2012 R2] と、[A1] のサイズ設定を選択します (他のサイズも選択できますが、サンプルは A1 で正常に動作します)。

1. 仮想マシンへのリモート デスクトップ接続 (RDC) に使用するユーザー名とパスワードを入力します。また、サーバーを実行する地域 (できるだけ実際の所在地に近い地域) を選択します。

1. 終了するには、**[仮想マシンの作成]** をクリックします。

1. プロビジョニングが完了するまで少し待ってから、マシンの名前をクリックして Azure 構成設定を開きます。

1. **[エンドポイント]** タブを選択します。

1. **[+ 追加]** をクリックし、**[スタンドアロン エンドポイントの追加]** を選択します。

1. **[名前]** ドロップダウン リストから **[HTTP (TCP ポート 80)]** を選択し、**[OK]** (またはチェックマーク ボタン) をクリックします。

| 注                                                                                                                |
|----------------------------------------------------------------------------------------------------------------------------------|
| [DIRECT SERVER RETURN の有効化] オプションをオンにしないでください。オンにすると、Web サービスへの着信トラフィックを実際にブロックする可能性があります。 |

1. HTTP エンドポイントを追加した後で、HTTPS 用の別のエンドポイントを追加します。
 1.  **[エンドポイント]** タブを選択します。
 1.  **[+ 追加]** をクリックし、**[スタンドアロン エンドポイントの追加]** を選択します。
 1.  **[名前]** ドロップダウン リストから **[HTTPS (TCP ポート 443)]** を選択し、**[OK]** (またはチェックマーク ボタン) をクリックします。

1. **[ダッシュボード]** タブに移動し、仮想マシンが起動していることを確認し、**[接続]** を選択して .rdp ファイルを開き、RDC を使用してマシンに接続します。
1. 手順 6 で設定したユーザー名とパスワードを使用してマシンにログインします。

| 注                                                                                                     |
|-----------------------------------------------------------------------------------------------------------------------|
| ドメインに参加中のコンピューターを操作している場合、マシンに直接ログインするために "\\選択したユーザー名" を使用することが必要なことがあります。 |


### <a name="server-roles-and-features-setup"></a>サーバーの役割と機能のセットアップ

Azure 仮想マシンを実行した後、または Windows Server を物理マシンにインストールした後に、インターネット インフォメーション サービス (IIS) を実行する Web サーバーにマシンを変える必要があります。 これを行うには、役割をサーバーに追加する必要があります。

1.  **スタート** メニューから [サーバー マネージャー] を開きます。
2.  **[管理]** をクリックし、**[役割と機能の追加]** を選択します。
3.  オプションから **[役割ベース]** または **[機能ベース]** のインストールを選択して **[次へ]** をクリックします。
4.  [サーバー プール] リストからサーバーを選択して **[次へ]** をクリックします。
5.  [サーバーの役割] リストから、[アプリケーション サーバー] および [Web サーバー (IIS)] を選択して [次へ] をクリックします。
6.  **[機能]** リストで、**[.NET Framework 4.5 Features]** の下にある **[ASP.NET 4.5]** と、同じグループ内の **[WCF サービス]** の下にある **[HTTP アクティベーション]** を選択します。
7.  **[次へ]** を数回クリックして、[アプリケーション サーバー] の [役割サービス] 画面を表示します。
8.  **[Web サーバー (IIS) サポート]** をオンにし、ポップアップ表示されたウィンドウで **[機能の追加]** をクリックします。
9.  **[次へ]** を数回クリックして、**[Web サーバーの役割 (IIS) サービス]** 画面を表示します。
10. すべての既定値がオンになった状態のままで **[次へ]** をクリックします。
11. インストールされる項目のリストを確認したら **[インストール]** をクリックします。
12. すべてのソフトウェアおよびサービスのインストールが完了するまで待ちます。


### <a name="certificate-installation"></a>証明書のインストール

Xbox Secure Token Service (XSTS) トークンを使用して Xbox One 本体から独自サーバーへの Web サービス呼び出しを行えるようにするには、以下の証明書をインストールする必要があります。

-   [XSTS 署名証明書](https://developer.xboxlive.com/_layouts/xna/download.ashx?file=xsts.auth.xboxlive.com.cer.zip&folder=platform\RelyingParty)
    -   証明書をダウンロードします。
    -   "ローカル コンピューター/個人" および "ローカル コンピューター/信頼されたユーザー" 証明書ストアに証明書をインストールします。

| 重要                                                                                                                                                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| MMC から web.config ファイルに証明書のサムプリントを直接貼り付けると、サムプリントに非表示の Unicode 文字が追加される場合があります。 この問題とその修正方法の詳細については、「[Certificate thumbprint displayed in MMC certificate snap-in has extra invisible unicode character](http://support.microsoft.com/kb/2023835?wa=wsignin1.0)」を参照してください。 |

-   独自サービスの証明書利用者証明書
    -   証明書利用者の証明書の公開キーは、XDP を介してアップロードされます。 XDP でサンドボックスに移動し、**[Manage]**、**[Web Services]** の順にクリックします。 **[Web Services]** ページで、既存の Web サービスを使用するか、新規作成します。 Web サービスのエンドポイントを作成した後、新しいトークンの定義を追加して、キーをアップロードする必要があります。 XDP 内での Web サービスの設定の詳細については、[XDP のドキュメント](https://developer.xboxlive.com/en-us/xdp/documentation/xdphelp/Pages/AboutWebServiceManagement_SS_xdpdocs.aspx)を参照してください。
    -   "ローカル コンピューター/個人" 証明書ストアに証明書をインストールします。

さらに、独自の Web サービスがユーザーの代わりに Xbox Live サービスと直接やり取りする場合 (代理認証)、次の証明書が必要です。

### <a name="business-partner-certificate"></a>ビジネス パートナー証明書

この証明書は、『Xbox One Service Config Workbook』の「ビジネス パートナー証明書」タブに記載されている手順に従って、開発者またはパブリッシャーが作成します。 ワークブックには、証明書の作成後、証明書についてマイクロソフトに提出する必要がある情報に関するガイダンスも含まれています。
-   "ローカル コンピューター/個人" 証明書ストアに証明書をインストールします。

| 注                                                                                                                                                                                                                                |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 証明書利用者証明書またはビジネス パートナー証明書をまだ用意していない場合、『Service Config Workbook』の指示に従い、担当の開発者アカウント マネージャーに問い合わせて、証明書をマイクロソフトに提出するための準備を行います。 |

証明書が正しい場所にインストールされていることを確認し、秘密キーへの適切なアクセス許可を付与するための最も簡単な方法は、Microsoft 管理コンソール (mmc.exe) を使用することです。

1.  スタート メニューから mmc.exe を開きます。
2.  **[ファイル]** メニューから **[スナップ インの追加と削除]** を選択します。
3.  **[証明書]** を選択して **[追加]** をクリックします。
4.  **[コンピューター アカウント]** を選択して **[次へ]** をクリックします。
5.  [ローカル コンピューター] が選択されていることを確認して **[完了]** をクリックします。
6.  **[OK]** をクリックします。
7.  **[証明書 (ローカル コンピューター)]** リストを展開します。
8.  証明書をインポートするフォルダー (証明書ストア) を開きます。
9.  **[操作]**-&gt;**[すべてのタスク]**-&gt;**[インポート]** の順に選択します。
10. 証明書のインポート ウィザードに従って、証明書の .pfx または .cer ファイルを指定します。

| 注 |
|------|
| ファイル ピッカーの既定のファイルの種類は .cer です。 証明書利用者証明書またはビジネス パートナー証明書をインストールするために、ファイルの種類を **[すべてのファイル (\*.\*)]** に変更することが必要な場合があります。 |

また、証明書利用者証明書およびビジネス パートナー証明書には、XSTS トークンを処理するために IIS サービスが読み取る必要がある秘密キーが存在します。 秘密キーへのアクセスを IIS サービスに許可するには、mmc.exe 内で次の手順を実行します。

1.  証明書の名前を右クリックします。
2.  **[すべてのタスク]**-&gt;**[秘密キーの管理]** の順に選択します。
3.  **[追加]** をクリックします。
4.  \[ローカル コンピューター名\]\\SERVICE アカウントを追加して **[OK]** をクリックします。
5.  SERVICE アカウントに秘密キーの読み取りアクセスが付与されていることを確認します。
6.  **[OK]** をクリックします。


## <a name="building-the-simpleauthservice-sample-website-for-deployment-a-namebuild-sample-website"></a>SimpleAuthService サンプル Web サイトの配置用の構築 <a name="build-sample-website">

サーバーを構成し、IIS が正しくセットアップされていることを確認した後で、サンプルをセットアップしてコンパイルし、Web サーバー上で実行できます。

1.  Visual Studio 2012 がインストールされていることを確認します。
2.  最新の Xbox One Simple Web Server サンプル ("SimpleAuthService") を、GDN の [XDK ソフトウェア ダウンロード](https://developer.xboxlive.com/en-us/platform/development/downloads/Pages/home.aspx) ページからダウンロードします。
3.  Xbox One Relying Party SDK を、GDN のソフトウェア ダウンロード ページからダウンロードします。
4.  SimpleAuthService プロジェクトを Visual Studio で開きます。
5.  [JSON Web Token (JWT) 処理用 IdentityModel](https://www.nuget.org/packages/Microsoft.IdentityModel.Tokens.JWT) をインストールします。
6.  SimpleAuthService プロジェクトを右クリックして **[参照の追加]** を選択します。
7.  **[参照]** を選択し、Relying Party SDK から展開した Microsoft.XboxLive.Auth.dll をターゲットにします。
8.  **[OK]** を選択します。
9.  Web.config ファイルを開き、audienceUris ノードを探します。
10. パブリッシャーまたはサービスの証明書利用者名を反映するように <http://Your_Relying_Party.com/> を変更します。
11. Web サイトがアクティブであることの確認テストのために、Web.config ファイルで directoryBrowse 設定を true に変更して、ディレクトリの参照を一時的に有効にします。 この設定の既定値は false です。
12. ソリューションをコンパイルし、成功を確認します。 成功した場合、サービスを発行する準備ができています。
13. **SimpleAuthService** プロジェクトを右クリックして **[発行]** を選択します。
14. ドロップダウン リストから [&lt;新しいプロファイル...&gt;] を選択します。
15. 発行プロファイルに「**SimpleAuthService**」という名前を付けて **[次へ]** をクリックします。
16. [接続] ページで、ドロップダウン リストから **[ファイル システム]** を選択します。
17. ターゲットの場所を開発用 PC 上の新しいフォルダーに設定して **[次へ]** をクリックします。
18. 必要な場合にサイトを後からデバッグできるよう、構成に対して **[デバッグ]** を選択し、**[発行]** をクリックします。
19. 手順 16 の出力フォルダーに生成されたファイルを、サーバー上の C:\\SampleService\\ フォルダーにコピーします。


## <a name="configuring-iis-and-running-the-sample-website-a-nameconfigure-sample-website"></a>IIS の構成とサンプル Web サイトの実行<a name="configure-sample-website">

本体が Web サーバーと通信できるようにするには、IIS でサービスを構成する必要があります。 単純化のために、SimpleAuthService サンプルを実行するところから始めます。 以下の手順により、このサンプル用に IIS を通じて HTTP/HTTPS Web サービスをセットアップできます。

1.  インターネット インフォメーション サービス (IIS) マネージャーを開きます。
2.  サーバーのリストを展開して **[アプリケーション プール]** を右クリックし、**[新しいプールの追加]** を選択します。
3.  プールに「SampleServicePool」という名前を付け、プールを [.NET Framework 4.0] に設定します。
4.  **[サイト]** リストを展開して **[Default Web Site]** を選択します。
5.  **[Web サイトの管理]** で、**[停止]** を選択します。
6.  **[サイト]** を右クリックして **[Web サイトの追加...]** を選択します。
7.  サイトに「SampleService」という名前を付け、アプリケーション プールを [SampleServicePool] に設定し、物理パスを C:\\SampleService\\ に設定します。
8.  バインドのポートを既定の 80 のままにして **[OK]** をクリックし、バインドの警告に対して **[はい]** をクリックします。
9.  管理者のコマンド プロンプトから次のコマンドを実行します。

           %windir%\Microsoft.Net\Framework64\v4.0.30319\aspnet_regiis.exe -ir

10. [サイト] で、既定の Web サイトが停止していることを確認し、Web サービスを再起動します。

この時点では、サーバーは HTTP トラフィック用にセットアップされているはずです。 すべての Xbox One リテール環境で、すべての Web ベース通信には HTTPS が必要ですが、HTTPS を有効にする手順に進む前に、IIS で構成したサイト上で、HTTP のみが有効な状態でシステムが稼働していることを確認することが重要です。 これにより、この文書の後のセクションで説明する、HTTPS を有効にしたときに起きる可能性がある問題のトラブルシューティングが行いやすくなります。

ここまでの手順で問題がないことを検証するには、`http://localhost/` にアクセスしてみて、配置した SampleService Web サイトのディレクトリ情報が表示されることを確認します。 この時点でパブリック インターネットからサーバーにアクセスできる場合、Web.config ファイルで directoryBrowse の設定を更新して false に戻すことによって、ディレクトリの参照を無効にします。 これにより、サービスの不正アクセスおよび検出を防ぎます。

      <directoryBrowse enabled=?false?>

IIS がセットアップされていることが確認できたので、サーバーからいずれかのサービスを呼び出してみて、.json 応答が戻ることを検証します。

      http://localhost/RESTService.svc/messageoftheday


## <a name="verifying-relying-party-and-xsts-token-setup-a-nameverify-tokens"></a>証明書利用者および XSTS トークンのセットアップの検証 <a name="verify-tokens">

配置されたサービスを HTTP を通じてサーバー上で実行できるようになったので、次のステップとして、XSTS トークンを使用して Xbox One 本体から呼び出しを行い、証明書が正しくインストールされていることを検証します。

Xbox One 用の Web Services コード サンプルを [GDN のサンプル ページ](https://developer.xboxlive.com/en-us/platform/development/education/Pages/Samples.aspx)からダウンロードし、Xbox One XDK がインストールされている開発用 PC に展開します。
\\live\\WebServices\\WebServices110.sln ファイルを開きます。
WebServices.cpp ファイルを開きます。
MYSERVERNAME の定義をテスト サーバーのドメイン (例: yourserver.cloudapp.net) に更新します。
Package.Appxmanifest を開きます。
TitleID および PrimaryServiceConfigID の値を、開発タイトルのそれらの値と一致するように更新します。
Xbox One 開発用本体 (開発キット) が、証明書利用者証明書がセットアップされているサンドボックス内にあることを確認します。
開発キット上で、自分の開発者アカウントのいずれかを使用してサインインします。
NSAL.json ファイルを開いて更新し、テスト サーバー ホストおよび証明書利用者 (証明書利用者証明書のネットワーク セキュリティ承認リスト (NSAL) 設定をまだセットアップしていない場合) をターゲットにします。

NSAL.json ファイルの構成の詳細については、エンターテインメント デベロッパー フォーラムの投稿「How to configure the NSAL.json file」を参照してください。

1.  SetNSAL.bat コマンドを実行し、必要な NSAL ファイルを開発キットにコピーします。

ソリューションをコンパイルして実行します。
**Y** ボタンを押して People サービスの呼び出しを行い、クライアント サンプルが正しく実行されていることを検証します。
**A** および **X** ボタンを押して、テスト Web サービスの呼び出しを行います。


## <a name="enabling-https-for-your-web-service-a-nameenable-https"></a>Web サービスの HTTPS の有効化 <a name="enable-https">

-   [自己署名証明書の公開キーをエクスポートする](#export-key)
-   [IIS で Web サービスの HTTPS バインドを作成する](#create-https-binding)
-   [自己署名証明書を Xbox One 本体にインストールする](#install-certificate)

サーバーがセットアップされ、HTTP 経由で Xbox One 本体とエンド ツー エンドで稼働していることを検証した後で、HTTPS トラフィックを受け入れるようにサーバーのセットアップを更新します。 以前に述べたように、Xbox One では、本体からリテール環境へのすべての Web ベース トラフィックに HTTPS が必須です。

Azure を通じてサーバーをセットアップした場合、サーバーでは既に証明書の準備ができています。 これを検証するには、次の手順を実行します。

1.  スタート メニューから [インターネット インフォメーション サービス (IIS) マネージャー] を開きます。
2.  [接続] ページからサーバー名を選択します。
3.  **[サーバー証明書]** を開きます。
4.  サーバーのドメイン (例: server.cloudapp.net) の証明書がリストにあることを確認します。
5.  証明書を選択して **[表示...]** をクリックします。
6.  [証明のパス] を選択し、サーバーの DNS 名 (例: server.cloudapp.net) が入っていることを確認します。

Azure を使用していないか、SSL 通信用の証明書を作成する必要がある場合、次のホワイトペーパーの手順に従って自己署名証明書を作成できます。

[方法: 開発中に使う一時的な証明書を作成する](http://msdn.microsoft.com/en-us/library/ms733813(v=vs.110).aspx)

証明書を作成するときは必ず、証明書の名前にサーバーの完全 DNS 名 (server.contoso.com など) を使用します。 そうしないと、証明書の名前とサーバー名が厳密に一致せず、本体は証明書を信頼しません。 証明書の準備ができたら、サーバーのセットアップで他の証明書について行ったように、マシンの [個人] 証明書ストアに証明書をインストールします。


### <a name="export-the-self-signed-certificates-public-key-a-nameexport-key"></a>自己署名証明書の公開キーをエクスポートする <a name="export-key">

1.  スタート メニューから mmc.exe を開きます。
2.  **[ファイル]** メニューから **[スナップ インの追加と削除]** を選択します。
3.  **[証明書]** を選択して **[追加]** をクリックします。
4.  **[コンピューター アカウント]** を選択して **[次へ]** をクリックします。
5.  [ローカル コンピューター] が選択されていることを確認して **[完了]** をクリックします。
6.  **[OK]** をクリックします。
7.  [証明書 (ローカル コンピューター)]、[個人]、[証明書] の順にリストを展開します。
8.  以前に作成した (または、マシン上に既に作成されている) 自己署名 SSL 証明書の名前を右クリックします。
9.  **[すべてのタスク]**、**[エクスポート...]** の順に選択します。
10. 証明書のエクスポート ウィザードで、**[次へ]** をクリックします。
11. **[いいえ、秘密キーをエクスポートしません]** を選択して **[次へ]** をクリックします。
12. **[Base-64 encoded X.509 (.CER)]** を選択して **[次へ]** をクリックします。
13. サーバーの認識可能な名前を証明書ファイルに付けて **[次へ]** をクリックし、**[完了]** をクリックします。
14. 生成された .cer ファイルを開発用コンピューターにコピーします。


### <a name="create-an-https-binding-for-your-web-service-in-iis-a-namecreate-https-binding"></a>IIS で Web サービスの HTTPS バインドを作成する <a name="create-https-binding">

1.  サービスの Web サイトを IIS マネージャーで開きます。
2.  **[バインド]** をクリックします。
3.  **[追加]** をクリックします。
4.  ドロップダウン リストから **[https]** を選択します。
5.  SSL 証明書のドロップダウン リストから自己署名証明書を選択します。
6.  **[OK]** をクリックします。

これで https://localhost を試行することが可能になり、試行すると、Web サイトの証明書に問題があるという警告が Internet Explorer で表示されます。 その理由は単に、証明書が自己署名であり、信頼された証明機関 (CA) にチェーンがつながらないためです。 タイトルをリリースする前に、信頼された CA に依頼して、独自ドメイン用の真正な証明書を取得し、Web サービスにセットアップする必要があります。

https://localhost/RESTService.svc/messageoftheday にアクセスしようとすると、エラー メッセージが表示されます。 その理由は、HTTPS 要求をサポートするようにサービスの Web.config ファイルを更新する必要もあるためです。 それを行うには、次の設定のコメントを解除して、Web.config ファイルを保存し、リンクを再試行します。

      <!-- Uncomment this block to enable HTTPS

      <endpoint behaviorConfiguration="webHttpBehavior" binding="webHttpBinding"
      bindingConfiguration="webHttpsBindingConfig" contract="SimpleAuthService.IRESTService" /> -->

インターネット ブラウザーを使用して HTTPS 経由でサービスに到達できるようになったので、最後のステップとして、開発キットから HTTPS 経由でサービス呼び出しを行います。 信頼された CA にチェーンがつながる SSL 証明書をサーバーが使用している場合、追加の手順なしで Web サービスの HTTPS バージョンをそのまま呼び出すことができるはずです。 または、前に説明したように SSL 通信用の自己署名証明書を作成した場合、証明書を取得して本体にインストールする必要があります。そうしないと、本体は、HTTPS 経由で通信しようとしているサーバーを信頼しません。 また、本体をシャットダウンすると一時的な証明書がすべて削除されるため、本体を再起動するたびに証明書を再インストールする必要があります。


### <a name="install-the-self-signed-certificate-on-your-xbox-one-console-a-nameinstall-certificate"></a>自己署名証明書を Xbox One 本体にインストールする <a name="install-certificate">

1.  Xbox One XDK コマンド プロンプトを開き、サーバーの SSL 証明書を保存した場所に移動します。
2.  以下のコマンドを実行します (証明書をすばやく簡単に再インストールするには、.bat ファイルを使用します)。

        xbcp "%DurangoXDK%\bin\setproxy.exe" xd:\
        xbcp "%DurangoXDK%\bin\certmgr.exe" xd:\
        xbcp [YourSSLCert].cer xd:\
        xbrun /o d:\certmgr.exe -add -all d:\[YourSSLCert].cer -s -r localmachine root

最後のステップでは、単に現在の HTTP 定義をコピーしてプロトコルの値を *HTTPS* に更新することによって、NSAL.json ファイルにサービスの HTTPS 定義を含めます。


## <a name="faqs-and-troubleshooting"></a>FAQ とトラブルシューティング

 **クライアント側サンプルがサービスを呼び出そうとすると、GetTokenAndSignatureAsync() からエラーが返されます。 どうすればこれらのエラーを解決できますか。**   
本体から返される、NSAL またはトークン関連のエラーの大半は 0x87DD\* で始まります。 [XboxLive.com のこのフォーラム投稿](https://forums.xboxlive.com/AnswerPage.aspx?qid=10ef67c1-db3a-4f29-b4bf-3eacd77313cb&tgt=1)で、最も起こりやすいエラーの一覧とそれらの解決方法が示されています。

 **Web サービスの URL にアクセスしようとすると HTTP エラー 404.3 が返されます。 この原因は何ですか。どうすれば修正できますか。**   
サーバーにサンプルを最初にセットアップしようとするときの 404 エラーは通常、.NET 3.5、4.5、または ASP.NET のコンポーネントが不足していることを示します。 役割と機能の追加ウィザードで、以下のサービスの役割 (機能) が有効になっていることを確認してください。

-   .NET 3.5 の HTTP アクティベーション (Windows Server 2008)
-   .NET 4.5 の ASP.NET 4.5
-   .NET 4.5 / WCF サービスの HTTP アクティベーション

Windows Server 2008 R2 上で実行している場合、管理者のコマンド プロンプトから次のコマンドを実行します。

      %windir%\"Microsoft.NET\Framework\v3.0\Windows Communication Foundation\ servicemodelreg" –i

 **Windows Server 2008 R2 – 構成エラー: セクション宣言が見つからないため、構成セクション "system.serviceModel" を読み取れません。**   
.NET 3.5 をインストールします。 詳細については、[こちらの MSDN の技術情報](http://blogs.msdn.com/b/sqlblog/archive/2010/01/08/how-to-install-net-framework-3-5-sp1-on-windows-server-2008-r2-environments.aspx)を参照してください。

 **Windows Server 2008 R2 – HTTP エラー 500.21: ハンドラー "svc-Integrated" のモジュール リストにあるモジュール "ManagedPipelineHandler" が正しくありません。**   
管理者のコマンド プロンプトから、次を実行します。

    %windir%\Microsoft.NET\Framework\v4.0.21006\aspnet_regiis.exe –i

 **HTTP エラー 500.19 および 0x80070021 とは何ですか。**   
サーバー上の handlers セクションが現在ロックされています。 管理者のコマンド プロンプトから次のコマンドを実行すると、問題が修正されるはずです。

    %windir%\system32\inetsrv\appcmd.exe unlock config "Default Web Site/exchange" -section:handlers -commitpath:apphost

 **HTTPS 経由で本体から Web サービスを呼び出そうとすると HRESULT エラー 0x800c0019 が返されます。 どうしてでしょうか。**   
これは、HTTPS トラフィックに使用した SSL 証明書が本体によって信頼されていないか、サーバー上で正しく構成されていないことを意味します。 まず、サーバーの SSL 用に作成および使用した証明書について、エクスポートした .cer ファイルをダブルクリックしたときに、サーバーの完全ドメイン名が [発行先:] の値に入っていることを確認します。 例: [発行先: Server.Contoso.com] 次に、.cer ファイルをエクスポートしたときに Base-64 オプションを選択したことを確認します。 最後に、IIS を開き、別の証明書ではなくエクスポートした証明書を HTTPS ポート (443) で使用していることを確認できます。 また、証明書を開発キットに確実に再インストールします。
