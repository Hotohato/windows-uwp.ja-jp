---
title: "高度な Xbox Live のサンドボックス"
author: KevinAsgari
description: "対象パートナーによる開発中に、サンドボックスを使用してコンテンツを分離する方法について説明します。"
ms.assetid: bd8a2c51-2434-4cfe-8601-76b08321a658
ms.author: kevinasg
ms.date: 04-04-2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: "Xbox Live, Xbox, ゲーム, UWP, Xbox One, XDK, 対象パートナー, サンドボックス, コンテンツの分離"
ms.openlocfilehash: c2dfd17d0548a73293c8c56341dc8a6859a75985
ms.sourcegitcommit: 90fbdc0e25e0dff40c571d6687143dd7e16ab8a8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/06/2017
---
# <a name="advanced-xbox-live-sandboxes"></a>高度な Xbox Live のサンドボックス

> **注** この記事では、サンドボックスの高度な使用について説明します。この記事は主に、複数のチームが参加していて、アクセス許可の要件が複雑な大規模ゲーム スタジオに適用されます。  Xbox Live クリエーターズ プログラムに参加している場合、または ID@Xbox 開発者である場合、「[Xbox Live のサンドボックスの概要](xbox-live-sandboxes.md)」をお読みになることをお勧めします。

Xbox Live の*サンドボックス*は、開発用の完全にプライベートな環境を提供します。 このドキュメントでは、サンドボックスとは何か、サンドボックスが存在する理由、サンドボックスがパブリッシャーに適用されるしくみ、および、サンドボックスが内部の Xbox チームにどのような影響を及ぼすかについて説明します。 このドキュメントの対象読者は、Xbox One コンテンツを構築したり、サンドボックスを利用したりするパブリッシャーです。

## <a name="summary"></a>概要

Xbox Live では、単一の実稼働環境のみが存在し、すべてのプレリリース (開発中およびベータ) コンテンツ、サーティフィケーション コンテンツ、およびリテール コンテンツがその環境に存在します。

コンテンツの分離は、実稼働環境でパブリッシャーのコンテンツの漏洩がないことを保証するための手段です。 その中心的な機能として、コンテンツの分離は、リソース (タイトルまたはサービス) にアクセスするための権限を要求するプリンシパル ユーザー、デバイス、またはタイトルが、リソースへのアクセスを承認されていることを保証します。 コンテンツの分離により、パーティションはサンドボックスに分割され、タイトルまたはサービスのデータはサンドボックスに格納されます。 言い方を変えれば、承認ポリシーはサンドボックスのスコープの内部で定義されます。

サンドボックスは、実稼働環境内のデータをパーティション分割するための手段です。 Xbox 360 の ERA サービスでは、PartnerNet と ProductionNet は 2 つの異なる環境です。 Xbox One の ERA サービスでは、単一の実稼働環境に *n* 個の異なる仮想化環境が含まれ、それぞれの仮想環境がサンドボックスと呼ばれます。 すべてのコンテンツ向けの単一の実稼働環境が存在するので、サンドボックスは実際には、ある環境で生成されたデータが別の環境に移動できない一意の仮想環境です。

次の図は単一の実稼働環境を示しており、パブリッシャーはこの環境に、自社用の非公開の開発サンドボックスを作成できます。 承認されたデベロッパー アカウントまたは開発キットのみが、これらのサンドボックスへのアクセスを許可されます。

図 1. 実稼働環境内のサンドボックス

![](images/sandboxes/sandboxes_image1.png)

PublisherA が自社用の開発サンドボックスを持っているのと同じように、他のパブリッシャーも自社専用の開発サンドボックスを持っています。 同じタイトル ID が複数の異なるサンドボックスに存在することもできますが、そのタイトル ID に対して生成されるデータはサンドボックス間で別個です。

CERT と RETAIL の 2 つのシステム サンドボックスは Microsoft のみが追加できます。 名前が示すように、CERT サンドボックスはリリース前のサーティフィケーションを受けているタイトル用のサンドボックスであり、RETAIL サンドボックスはすべてのリテール ユーザーおよびリテール デバイスがアクセス可能な実際の製品を表しているサンドボックスです。

タイトル ID は従来、Xbox Live 内で一意でしたが、現在ではタイトル ID にサンドボックス ID を加えたものが一意です。 以前は一意のものとして扱われていたプロダクト ID やその他の ID 空間にも、同じことが当てはまります。 これらはサンドボックス ID とペアにすることが必要になりました。 Xbox Live のすべてのデータは主に、システム全体を通じてサンドボックス ID によってパーティション分割されることになります。

## <a name="initial-setup-for-a-title"></a>タイトル用の初期セットアップ

タイトルは Xbox デベロッパー ポータル (XDP) または Windows デベロッパー センターで作成されます。 タイトルには、タイトル ID、プロダクト ID、サービス構成 ID (SCID) が割り当てられます。

この新しい世界では、タイトルまたはプロダクト単体では Xbox Live にとって何の意味もありません。 1 つのタイトルをリテールおよび開発に同時使用することをサポートする必要があるため、必要な区別を付けて維持するためにタイトルの*インスタンス化*をサポートする必要があります。 タイトルのインスタンスはサンドボックスに存在し、これがサンドボックスの役割です。

タイトルを作成するために、パブリッシャーはプロダクト グループを作成し、プロダクト グループのジャンルを指定してから、その中に個別のプロダクトを作成します。 (詳細については、XDP ドキュメントを参照してください)。次の図は、プロダクト グループ、プロダクト、プロダクト インスタンス、およびサンドボックス間の関係を示しています。

図 2. プロダクト グループ、プロダクト、プロダクト インスタンス、およびサンドボックス間の関係

![](images/sandboxes/sandboxes_image2.png)

<a name="product-instances"></a>プロダクト インスタンス
-----------------

*プロダクト インスタンス*は、特定のサンドボックス内のタイトル、プロダクト、および構成データを投影したものです。 このデータについて、サービス構成、カタログ メタデータ、およびバイナリの 3 つの領域に分けて説明します。

### <a name="service-configuration"></a>サービス構成

> サービス構成の定義 (イベント、統計、実績など)。 サービス構成はプロダクト インスタンスのレベルで定義されます。

### <a name="catalog-metadata"></a>カタログ メタデータ

> カタログに含まれるメタデータであり、販促テキスト、アート アセット、提供/オファー情報、ライセンス データなどが含まれます。

### <a name="binary"></a>バイナリ

> バイナリは 2 つの形態のいずれかで表される可能性があります。

1.  メタデータのみ。サイドローディングを可能にします。 これにはコンテンツ ID、バージョン情報、およびライセンス情報が含まれます。

2.  CDN に伝達されてクライアントにダウンロード可能となる完全なバイナリ。

<a name="getting-the-access-right"></a>アクセス権の取得
------------------------

Xbox One でのコンテンツへのアクセスには、以下の 2 種類があります。

*設計時アクセス* - PC からの XDP ツールを介したアクセスであり、プロダクトに携わる要員がコンテンツ、構成、およびメタデータをアップロード、整理、および操作することを許可しますが、プロダクトのインスタンスを実行または再生することは許可しません。

*実行時アクセス* - Xbox 本体からのアクセスであり、デベロッパー、テスト担当者、レビュー担当者、そして最終的にはユーザーがプロダクト インスタンスを実行および再生することを許可します。

**注** 実行時アクセスが可能となるためには、プロダクト インスタンスがサンドボックスに配置されている必要があります。 ビルドがサンドボックスに配置されると、そのサンドボックスへのアクセスを許可されている XDP ユーザーまたは開発キット デバイスがインスタンスを実行できます。 ユーザーまたはデバイスはそのために、各自のデベロッパー アカウント (実行時アクセスのための仮想ユーザーとして機能する特別なアカウント) の 1 つを使用して Xbox 本体から Xbox One にログオンします。

サンドボックスについて言及するとき、通常は、Xbox Live 上で実行されるコンテンツへの実行時アクセスのことを指しています。 Xbox Live 内のサービスにアクセスするためには、タイトル ID が必要です。 **appxmanifest** にタイトル ID が入力されると、本体はタイトル ID を Xbox Live に送信します。 プリンシパル (デバイスまたはユーザー) がタイトルへのアクセスを許可されていない場合、Xbox Live セキュリティ サービスは有効なトークンを返しません。

この検証プロセスはコンテンツ分離の核心です。 概略レベルで見た場合、以下のようになります。

-   プリンシパル グループには Xbox ユーザー ID (XUID)、デバイス ID、タイトル ID、またはサービス ID が含まれる可能性があります。

-   サンドボックスにはタイトル ID、プロダクト ID、またはサービス構成 ID (SCID) が含まれる可能性があります。

-   プリンシパル グループにはサンドボックスへのアクセス権が与えられます。

したがって、ユーザーまたはデバイスがサンドボックス内のプレリリース タイトルにアクセスするには、まず XDP を通じてアクセスを許可する必要があります。

図 3. XDP を通じてアクセスをセットアップする場合のモデル

![](images/sandboxes/sandboxes_image3.png)

コンテンツの分離の有効性は、組織で以下のプロセスが実施されているという事実に基づきます。

-   XDP ユーザー アカウント、各ユーザーが実行時アクセスのためのログオンに使用するデベロッパー アカウント、および、その中で各ユーザーがメンバーシップを付与されるユーザー グループを作成します。

-   信頼された本体のデバイス グループを作成します。

-   どのユーザー グループおよびデバイス グループがサンドボックス内のプロダクト インスタンスにアクセスできるかを、開発サンドボックスごとに正確に指定します。

このセットアップの例は次のように示されます。

図 4. 承認されていないユーザーの資格情報ではサンドボックスへのアクセスに失敗します。承認された XDP ユーザー アカウントの通常の資格情報でも同様です。 承認された XDP ユーザー アカウントによって所有されるデベロッパー アカウントの資格情報のみが、サンドボックスと、現在そのサンドボックス内にあるすべてのプロダクト インスタンスへの実行時アクセスに成功します。

![](images/sandboxes/sandboxes_image4.png)

### <a name="dev-accounts-setup"></a>デベロッパー アカウントのセットアップ

Xbox One のデベロッパー アカウントは、特別なルールが適用された標準の Microsoft アカウント (MSA) にすぎません。 開発のために Xbox Live で使用されます。 デベロッパー アカウントの特性は以下のとおりです。

-   XDP または Windows デベロッパー センターで作成される必要があります。

-   パブリッシャーによって作成されるときに、外部デベロッパーのロールを割り当てられます。

-   開発アカウントを作成した XDP アカウントまたは Windows デベロッパー センター アカウントと結び付けられます。

-   開発キットにしかログインできません。 リテール デバイス上ではデベロッパー アカウントへのログインは拒否されます。

-   テストを行うために、Xbox Live デベロッパー ゴールド メンバーシップまたはその他のメンバーシップを無料で購入できます。

### <a name="user-group-setup"></a>ユーザー グループのセットアップ

第 1 の種類のプリンシパル グループであるユーザー グループは XDP ユーザーのコレクションです。 XDP ユーザーがユーザー グループに追加されるとき、これらの XDP ユーザーにはデベロッパー アカウントが付随します。

したがって、ユーザー グループがサンドボックスに割り当てられるとき、そのユーザー グループ内の XDP ユーザーと関連付けられたデベロッパー アカウントが適切なプリンシパル グループに追加され、プリンシパル グループは、サンドボックスの裏付けとなるプライマリー リソース セットによってポリシーをセットアップします。

**注** サンドボックスにアクセスするために作成されるユーザー グループは、プロダクト グループおよびプロダクトの XDP 内構成データへのアクセスを防ぐために使用されるものと同じユーザー グループです。

### <a name="device-setup"></a>デバイスのセットアップ

デバイスもプリンシパル グループに追加されます。 Game Developer Store を通じて資格を購入し、デバイスを開発キットとしてプロビジョニングする場合、デバイスは開発キットとしてのみ使用できます。 デバイスが開発キットとしてプロビジョニングされると、デバイス グループに追加できるデバイスの一覧にそのデバイスが表示されます。

### <a name="device-group-setup"></a>デバイス グループのセットアップ

第 2 の種類のプリンシパル グループであるデバイス グループにもサンドボックスへのアクセス権を付与できます。 セットアップは、前に詳しく説明したユーザー グループのセットアップと同様です。

## <a name="sandboxes"></a>サンドボックス

<a name="what-is-a-sandbox"></a>サンドボックスとは
------------------

簡潔に言えば、*サンドボックスは実稼働環境のデータをパーティション分割するための手段です*。

<a name="why-do-we-need-sandboxes"></a>サンドボックスが必要な理由
-------------------------

ユーザーやデバイスがタイトルにアクセスするのと同じように、タイトルはサービスにアクセスします。 タイトルの集合がサービス リソースへのアクセスを許可される "タイトル グループ" の概念が導入されます。

Xbox One では、すべてのコンテンツ (プレリリースおよびリテール) 向けの単一の実稼働環境しか存在しないため、リソースの同じインスタンス上で 1 つのタイトルの複数のインスタンス (プレリリース/リテール) を稼働させることは避ける必要があります。

<a name="what-is-in-a-sandbox"></a>サンドボックスの内容
---------------------

サンドボックスには、サンドボックスに追加されるすべてのタイトルのプロダクト インスタンスが含まれます。

<a name="what-is-a-sandbox-id"></a>サンドボックス ID とは
---------------------

サンドボックス ID は、タイトル、プロダクト、またはサービス構成のデータのパーティション分割単位です。 複数のタイトルが同じサンドボックスに共存でき、そのことは、それらのタイトルが何らかのサービス構成データを共有するための前提条件です。

大文字と小文字が区別されるサンドボックス ID は、&lt;PublisherMoniker&gt;.*n* という形式の文字列です。 XLDP.5 というサンドボックス ID の例の説明は次のようになります。

-   *パブリッシャー モニカー*はすべてのパブリッシャー間で一意です。 したがって、"XLPD" はこの特定のパブリッシャーのパブリッシャー モニカーです。 パブリッシャー モニカーは、デベロッパー アカウント マネージャーによってパブリッシャーが XDP 内で "アクティベーション" されるときに作成されます。

-   数字 "*n*" はサンドボックスの数を識別します。 この場合、"5" はこのパブリッシャー用に作成される 6 番目のサンドボックスです。

タイトルのデータがサービスを通って移動するとき、Xbox サービスはサンドボックス ID を使用して、生成されるデータの "環境" を一意に識別します。

<a name="what-data-is-sandboxed"></a>どのようなデータがサンドボックス化されるか
-----------------------

次の図では、どのようなユーザー データやタイトル データがサンドボックス化されるかを示しています。

![](images/sandboxes/sandboxes_image5.png)

<a name="global-override-sandbox"></a>グローバル オーバーライド サンドボックス
-----------------------

デベロッパーは、開発キット上でサンドボックス ID を設定することによって、開発キットが動作するサンドボックスを設定します。これはグローバル オーバーライド サンドボックスとも呼ばれます。 したがって、開発キットで Xbox Live サービス (実績、マッチメイキング、ライセンス、EDS など) に対してタイトル (シェル アプリおよび通常のアプリ) から実行されるすべての要求はそのサンドボックスで実行されます。

グローバル オーバーライド サンドボックスには、このサンドボックスに取り込まれたコンテンツのみがブラウズ時に表示されるという効力もあります。

<a name="types-of-sandboxes"></a>サンドボックスの種類
-------------------------------------------------------------------------------------------------------------------------------------------------------

サンドボックスには 2 つの異なるカテゴリーがあります。 これらのカテゴリーは以下のように定義されます。

-   *パブリッシャー サンドボックス*。 パブリッシャーは各自の開発中サンドボックスにアクセスできます。 これらは XLDP.0、XLDP.1、XLDP.2、XLDP.3 のような名前になります。これは、パブリッシャーが自社タイトルのプロダクト インスタンスを配置する場所です。 これらのサンドボックスへのアクセスは、パブリッシャーがアクセスを許可するユーザー/デバイスに限定されます。

-   *Microsoft サンドボックス*。 これらは組み込みのサンドボックスである RETAIL および CERT です。Microsoft のみが、これらの保護されたサンドボックスに公開することを許可されています。

<a name="cert-sandbox"></a>CERT サンドボックス
------------

一般提供の準備ができたタイトルは、まずサーティフィケーションを通過する必要があります。 CERT サンドボックスは Microsoft が管理するサンドボックスであり、サーティフィケーションの担当者のみがアクセスできます。 パブリッシャーは、自社が保有するどのコンテンツがサーティフィケーションを通過しているかを確認できます。

サーティフィケーション中に不合格となったプロダクト インスタンスは、パブリッシャーが XDP を使用してデバッグと修正を行えるよう、開発サンドボックスに戻すことができます。

<a name="retail-sandbox"></a>RETAIL サンドボックス
--------------

RETAIL サンドボックスは、Xbox One 向けに作成されるすべてのコンテンツの最終目的地です。

サーティフィケーションに合格した後、タイトルは RETAIL サンドボックスに追加されます。 署名済みコンテンツのみが RETAIL サンドボックスでの実行を許可されます。 これには、パブリッシャー主導型のベータも RETAIL サンドボックスで実行されるという重要な意味があります。 RETAIL サンドボックスで生成されるデータは実際の顧客の実稼働データを表します。

RETAIL サンドボックス内のコンテンツへのアクセスは、引き続き、コンテンツの分離を通じて制御可能であることに注意してください。

たとえば、パブリッシャー主導型のベータは RETAIL サンドボックスで実行され、ここでは、パブリッシャーが定義するベータ リソース セット タイトルにどのプリンシパル グループがアクセスできるかをパブリッシャーが選択します。 ベータ タイトルによって生成されるサービス データは実際の実稼働データであり、タイトルが一般提供に移行した後も存続します。

<a name="cross-sandbox-data-interaction"></a>サンドボックス間のデータのやり取り
------------------------------

定義によれば、サンドボックスはデータの共有を制限するコンテナーです。 したがって、サンドボックス間のデータのやり取りは不可能です。

## <a name="organizing-your-sandboxes"></a>サンドボックスの整理

このセクションでは、パブリッシャーが実行できるサンドボックスの整理方法の例を示します。 パブリッシャーは、サンドボックスを使用してデータを整理する方法を理解する必要があります。

**注** 以下の例では、コンテンツの分離による実行時アクセス管理のみを示します。

### <a name="scenario-1-two-titles-one-sandbox"></a>シナリオ 1: 2 つのタイトル、1 つのサンドボックス

パブリッシャーにとっての基本的な構造として次のようなものが考えられます。

-   設計時と実行時のいずれにおいても、すべてのユーザー、およびパブリッシャーが保有するすべてのデバイスがアクセスできる 2 つのタイトル。

-   タイトルごとに 1 つのプロダクト インスタンス。

この場合、パブリッシャーに必要なのは、すべてのプレリリース コンテンツ用の 1 つのサンドボックスだけです。

次の図にユーザー グループを示します。 パブリッシャーは、その方が容易だと思われるのであれば、ユーザー グループの代わりにデバイス グループを使用してもかまいません。 また、このユーザー グループは、サンドボックス XLDP.1 とこのサンドボックス内のタイトルに、実行時および設計時にアクセスできます。

![](images/sandboxes/sandboxes_image6.png)

### <a name="scenario-2-one-title-different-teams"></a>シナリオ 2: 1 つのタイトル、異なるチーム

このモデルでの要件は以下のとおりです。

-   1 つのタイトル。

-   開発チームは日単位のビルドを使用して作業する。

-   QA チームは週単位の LKG を使用して作業する。

-   バグがあった場合、開発チームは週単位の LKG をデバッグする必要がある。

-   ファイナンス チームは、タイトルのカタログ リリースに関連する価格カードやその他のメタデータにアクセスする必要がある。

次の図は、TitleX に 2 つのプロダクト インスタンス PI-1 および PI-2 があることを示します。 プロダクト インスタンスはサンドボックス内に存在する必要がありますが、同じタイトルの 2 つのプロダクト インスタンスが同じサンドボックス内に存在することはできません。 そのため、TitleX-PI-1 はサンドボックス XLDP.1 内にあり、TitleX-PI-2 はサンドボックス XLDP.2 内にあります。

開発ユーザー グループは両方のサンドボックスにアクセスできますが、QA ユーザー グループはサンドボックス XLDP.2 にしかアクセスできません。

また、ファイナンス ユーザー (Group C) は TitleX への設計時アクセスが可能です。 ファイナンス ユーザー グループは通常、タイトルの実行時デバッグにはかかわらないため、分離されています。

**注** 組織に関係なく、XDP ユーザーは複数のユーザー グループに属することができます。

![](images/sandboxes/sandboxes_image7.png)

### <a name="scenario-3-two-titles-completely-separate"></a>シナリオ 3: 2 つのタイトル、完全に分離

この例では、要件が少し異なります。

-   2 つのタイトル。

-   各タイトルへのアクセスを特定の個人の集合に制限する必要がある。

-   タイトルごとに 1 つのプロダクト インスタンス。

-   タイトルの設計時 XDP 構成データにアクセスする必要がある管理ユーザー グループ。 このグループ内の個人は全員がパブリッシャーの管理者であり、カタログに発行されるすべてのデータ (カタログ メタデータ、ファイナンス、マーケティング、サーティフィケーション提出物など) を制御できます。

このモデルでは、パブリッシャーは両方のタイトルの完全な分離を維持することを選択し、これら 2 つのタイトルを 2 つの異なるサンドボックスに割り当てました。 またパブリッシャーは、別個の管理ユーザー グループを作成することを選択し、2 つのプロダクトへのアクセスを割り当てました。

![](images/sandboxes/sandboxes_image8.png)

### <a name="scenario-4-anyway-you-like-it"></a>シナリオ 4: 自由自在に

以下の例では、接続の数を少なくして説明を短くするために、サンドボックスの実行時接続のみを示しました。 設計時のその他のアクセス許可も自由に追加することができます。

この例では、要件は以下のとおりです。

-   パブリッシャー内部の特定の要員のみが特定のタイトルにアクセスできる。

-   パブリッシャーはさまざまな企業のベンダーと協業し、これらのベンダーは短期契約である場合がある。

-   パブリッシャーは、タイトルを使用停止にすることによって、ベンダーまたは FTE がアクセスしていたデータへのアクセスを遮断できる必要がある。

この要件をモデル化するために、次のような構造を採用することができます。

従ったモデルは次のとおりです。

-   TitleX と TitleY のプロダクト インスタンスが、サンドボックス XLDP.1 にそれぞれ 1 つだけある。

-   TitleZ には 2 つのプロダクト インスタンスがあり、1 つはサンドボックス XLDP.2 に、もう 1 つはサンドボックス XLDP.3 にある。

-   FTE User Group B は、すべてのサンドボックス内のプロダクト インスタンスへのアクセスを付与される。

-   Vendor User Group A はベンダーのみのユーザー グループであり、サンドボックス XLDP.1 へのアクセスを付与される。

-   Vendor Device Group C はベンダーのみのユーザー グループであり、サンドボックス XLDP.3 へのアクセスを付与される。

![](images/sandboxes/sandboxes_image9.png)

## <a name="summary"></a>まとめ

Xbox Live 開発では、実稼働品質のサービスと MSA デベロッパー アカウントを使用して実稼働環境でテストを行うための、これ以上ない機会がパブリッシャーに提供されます。 機能と柔軟性の向上に伴い、開発中および一般提供後、タイトル データを作成したり、タイトルへのアクセスを管理したりするための新しい構成手順が XDP で必要になっています。

サンドボックスは実稼働環境のデータをパーティション分割するための手段です。 すべてのコンテンツ向けの単一の実稼働環境が存在するので、サンドボックスは、ある環境で生成されたデータが他の環境に移動しない "仮想環境" として機能します。
