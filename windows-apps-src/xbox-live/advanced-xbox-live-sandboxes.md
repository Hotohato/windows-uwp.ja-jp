---
title: 高度な Xbox Live のサンドボックス
author: KevinAsgari
description: 対象パートナーによる開発中に、サンドボックスを使用してコンテンツを分離する方法について説明します。
ms.assetid: bd8a2c51-2434-4cfe-8601-76b08321a658
ms.author: kevinasg
ms.date: 04/04/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Xbox Live, Xbox, ゲーム, UWP, Xbox One, XDK, 対象パートナー, サンドボックス, コンテンツの分離
ms.localizationpriority: medium
ms.openlocfilehash: 02817869aeba78ad1b86e12d4bbd31a1107d3195
ms.sourcegitcommit: e4f3e1b2d08a02b9920e78e802234e5b674e7223
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/26/2018
ms.locfileid: "4205673"
---
# <a name="advanced-xbox-live-sandboxes"></a>高度な Xbox Live のサンドボックス

> **注** この記事では、サンドボックスの高度な使用について説明します。この記事は主に、複数のチームが参加していて、アクセス許可の要件が複雑な大規模ゲーム スタジオに適用されます。  Xbox Live クリエーターズ プログラムに参加している場合、または ID@Xbox 開発者である場合は、「[Xbox Live のサンドボックスの概要](xbox-live-sandboxes.md)」をお読みになることをお勧めします。

Xbox Live の*サンドボックス*は、開発用の完全に非公開な環境を提供します。 このドキュメントでは、サンドボックスとは何か、サンドボックスが存在する理由、サンドボックスが公開元に適用されるしくみ、および、サンドボックスが内部の Xbox チームにどのような影響を及ぼすかについて説明します。 このドキュメントの対象読者は、Xbox One コンテンツを構築したり、サンドボックスを利用したりする公開元です。

## <a name="summary"></a>概要

Xbox Live では、単一の運用環境のみが存在し、プレリリース版 (開発中の製品とベータ版)、認定、および製品版に関するコンテンツがすべてその環境に存在します。

コンテンツの分離は、運用環境で公開元のコンテンツの漏洩がないことを保証するための手段です。 その中心的な機能として、コンテンツの分離は、リソース (タイトルまたはサービス) にアクセスするための権限を要求するプリンシパル ユーザー、デバイス、またはタイトルが、リソースへのアクセスを承認されていることを保証します。 コンテンツの分離により、パーティションはサンドボックスに分割され、タイトルまたはサービスのデータはサンドボックスに格納されます。 言い換えれば、承認ポリシーはサンドボックスの範囲内で定義されます。

サンドボックスは、運用環境内のデータをパーティション分割するための方法です。 Xbox 360 の ERA サービスでは、PartnerNet と ProductionNet は 2 つの異なる環境です。 Xbox One の era サービスでは、単一の運用環境には、 *n*の異なる仮想環境がそれぞれの仮想環境がサンド ボックスと呼ばれる場所が含まれています。 すべてのコンテンツを対象とした単一の運用環境が存在するので、サンドボックスは実際には、ある環境で生成されたデータが別の環境に移動できない一意の仮想環境です。

次の図は単一の運用環境を示しています。公開元は、この環境内に自社用の非公開の開発サンドボックスを作成できます。 承認された開発者アカウントまたは開発キットのみが、これらのサンドボックスへのアクセスを許可されます。

図 1. 運用環境内のサンドボックス

![](images/sandboxes/sandboxes_image1.png)

PublisherA が自社用の開発サンドボックスを持っているのと同じように、他の公開元も自社専用の開発サンドボックスを持っています。 同じタイトル ID が複数の異なるサンドボックスに存在することもできますが、そのタイトル ID に対して生成されるデータは、サンドボックス間では別個のデータとなります。

CERT と RETAIL の 2 つのシステム サンドボックスは Microsoft のみが設定できます。 名前が示すように、CERT サンドボックスはリリース前の認定を受けているタイトル用のサンドボックスであり、RETAIL サンドボックスはすべての製品ユーザーおよび製品デバイスがアクセスできる実際の製品を表しているサンドボックスです。

タイトル ID は従来、Xbox Live 内で一意でしたが、現在ではタイトル ID にサンドボックス ID を加えたものが一意な ID となります。 以前は一意の ID として扱われていた製品 ID やその他の ID 空間にも、同じことが当てはまります。 これらはサンドボックス ID とペアにすることが必要になりました。 Xbox Live のすべてのデータは主に、システム全体を通じてサンドボックス ID によってパーティション分割されることになります。

## <a name="initial-setup-for-a-title"></a>タイトル用の初期セットアップ

タイトルは Xbox デベロッパー ポータル (XDP) または Windows デベロッパー センターで作成されます。 このドキュメントでは、XDP で生まれタイトルについて説明します。 タイトルには、タイトル ID、製品 ID とサービス構成 ID (SCID) が割り当てられます。

タイトルを新たに作成しても、タイトルや製品だけでは Xbox Live にとって何の意味もありません。 1 つのタイトルを、製品版や開発用に同時に使用できるようにする必要があります。そのため、タイトルの*インスタンス化*をサポートして、タイトルを必要に応じて区別し、これを維持する必要があります。 タイトルのインスタンスはサンドボックスに存在します。これがサンドボックスの役割です。

XDP でタイトルを作成するためには、発行元は製品グループを作成、製品グループのジャンルを指定し、内の個々 の製品を作成します。 (詳しくは、XDP ドキュメントをご覧ください)。次の図は、製品グループ、製品、製品インスタンス、およびサンドボックス間の関係を示しています。

図 2. 製品グループ、製品、製品インスタンス、およびサンドボックス間の関係

![](images/sandboxes/sandboxes_image2.png)

<a name="product-instances"></a>製品インスタンス
-----------------

*製品インスタンス*は、特定のサンドボックス内のタイトル、製品、および構成データを投影したものです。 このデータについて、サービス構成、カタログ メタデータ、およびバイナリの 3 つの領域に分けて説明します。

### <a name="service-configuration"></a>サービス構成

> サービス構成の定義 (イベント、統計、実績など)。 サービス構成は製品インスタンスのレベルで定義されます。

### <a name="catalog-metadata"></a>カタログ メタデータ

> カタログに含まれるメタデータであり、販促テキスト、アート アセット、可用性や提供に関する情報、ライセンス データなどが含まれます。

### <a name="binary"></a>バイナリ

> バイナリは次の 2 つの形態のいずれかで表すことができます。

1.  メタデータのみ。サイドローディングを可能にします。 これにはコンテンツ ID、バージョン情報、およびライセンス情報が含まれます。

2.  CDN に伝達されてクライアントがダウンロードできるようになる完全なバイナリ。

<a name="getting-the-access-right"></a>アクセス権の取得
------------------------

Xbox One でのコンテンツへのアクセスには、以下の 2 種類があります。

*設計時アクセス* - PC からの XDP ツールを介したアクセスであり、製品に携わる要員がコンテンツ、構成、メタデータをアップロード、整理、および操作することを許可しますが、製品のインスタンスを実行またはプレイすることは許可しません。

*実行時アクセス* - Xbox 本体からのアクセスであり、開発者、テスト担当者、レビュー担当者、そして最終的にはユーザーが製品インスタンスを実行および再生することを許可します。

**注** 実行時アクセスが可能となるためには、製品インスタンスがサンドボックスに配置されている必要があります。 ビルドがサンドボックスに配置されると、そのサンドボックスへのアクセスを許可されている XDP ユーザーや開発キット デバイスは、インスタンスを実行することができます。 実行するために、これらのユーザーやデバイスは、各自の開発者アカウント (実行時アクセスのための仮想ユーザーとして機能する特別なアカウント) の 1 つを使用して Xbox 本体から Xbox One にログオンします。

サンドボックスについて説明するとき、通常は、Xbox Live 上で実行されるコンテンツへの実行時アクセスに関する説明をしています。 Xbox Live 内のサービスにアクセスするためには、タイトル ID が必要です。 **appxmanifest** にタイトル ID が入力されると、本体はタイトル ID を Xbox Live に送信します。 プリンシパル (デバイスまたはユーザー) がタイトルへのアクセスを許可されていない場合、Xbox Live セキュリティ サービスは有効なトークンを返しません。

この検証プロセスは、コンテンツ分離の最も重要な機能です。 このプロセスの概要を次に説明します。

-   プリンシパル グループには、Xbox ユーザー ID (XUID)、デバイス ID、タイトル ID、またはサービス ID を含めることができます。

-   サンドボックスには、タイトル ID、製品 ID、またはサービス構成 ID (SCID) を含めることができます。

-   プリンシパル グループにはサンドボックスへのアクセス権が与えられます。

したがって、ユーザーやデバイスがサンドボックス内のプレリリース タイトルにアクセスするには、まず XDP を通じてアクセス権が与えられる必要があります。

図 3. XDP を通じてアクセスをセットアップする場合のモデル

![](images/sandboxes/sandboxes_image3.png)

コンテンツの分離は、組織で以下のプロセスが実施されている場合に効果があります。

-   XDP ユーザー アカウント、各ユーザーが実行時アクセスのためのログオンに使用する開発者アカウント、およびユーザー グループを作成している (ユーザー グループ内で各ユーザーはメンバーシップを付与されます)。

-   信頼された本体のデバイス グループを作成している。

-   どのユーザー グループおよびデバイス グループがサンドボックス内の製品インスタンスにアクセスできるかを、開発サンドボックスごとに正確に指定している。

このセットアップに関する例を、次の図で示します。

図 4. 承認されていないユーザーの資格情報ではサンドボックスへのアクセスに失敗します。承認された XDP ユーザー アカウントの通常の資格情報でも同様です。 承認された XDP ユーザー アカウントによって所有される開発者アカウントの資格情報のみが、サンドボックスと、現在そのサンドボックス内にあるすべての製品インスタンスへの実行時アクセスに成功します。

![](images/sandboxes/sandboxes_image4.png)

### <a name="dev-accounts-setup"></a>開発者アカウントのセットアップ

Xbox One の開発者アカウントは、特別なルールが適用された標準の Microsoft アカウント (MSA) であり、 開発のために Xbox Live で使用されます。 開発者アカウントについて次に説明します。

-   XDP または Windows デベロッパー センターで作成される必要があります。

-   公開元によって作成されるときに、外部開発者のロールが割り当てられます。

-   開発者アカウントを作成した XDP アカウントや Windows デベロッパー センター アカウントと関連付けられます。

-   開発キットのみにログインできます。 製品デバイス上では開発者アカウントへのログインは拒否されます。

-   テストを目的とした場合は、Xbox Live 開発者向けのゴールド サブスクリプションまたは他のサブスクリプションを無料で購入できます。

### <a name="user-group-setup"></a>ユーザー グループのセットアップ

第 1 の種類のプリンシパル グループであるユーザー グループは XDP ユーザーのコレクションです。 XDP ユーザーがユーザー グループに追加されると、そのグループの開発者アカウントが、これらの XDP ユーザーに適用されます。

したがって、ユーザー グループがサンドボックスに割り当てられるとき、そのユーザー グループ内の XDP ユーザーに関連付けられた開発者アカウントが適切なプリンシパル グループに追加され、プリンシパル グループは、サンドボックスの背景にあるプライマリー リソース セットによってポリシーをセットアップします。

**注** サンドボックスにアクセスするために作成されるユーザー グループは、XDP 内にある製品グループや製品の構成データへのアクセスを防ぐために使用されるものと同じユーザー グループです。

### <a name="device-setup"></a>デバイスのセットアップ

デバイスもプリンシパル グループに追加されます。 Game Developer Store を通じて資格を購入し、デバイスを開発キットとしてプロビジョニングする場合、デバイスは開発キットとしてのみ使用できます。 デバイスが開発キットとしてプロビジョニングされると、デバイス グループに追加できるデバイスの一覧にそのデバイスが表示されます。

### <a name="device-group-setup"></a>デバイス グループのセットアップ

第 2 の種類のプリンシパル グループであるデバイス グループにもサンドボックスへのアクセス権を付与できます。 セットアップは、前に詳しく説明したユーザー グループのセットアップと同様です。

## <a name="sandboxes"></a>サンドボックス

<a name="what-is-a-sandbox"></a>サンドボックスとは
------------------

簡潔に言えば、*サンドボックスは運用環境のデータをパーティション分割するための方法です*。

<a name="why-do-we-need-sandboxes"></a>サンドボックスが必要な理由
-------------------------

ユーザーやデバイスがタイトルにアクセスするのと同じように、タイトルはサービスにアクセスします。 一連のタイトルに対してサービス リソースへのアクセスを許可するために、"タイトル グループ" という概念が採用されました。

Xbox One では、すべてのコンテンツ (プレリリース版および製品版) を対象とした運用環境は 1 つしか存在しないため、リソースの同じインスタンス上で、1 つのタイトルに関する複数のインスタンス (プレリリース版/製品版) を稼働させることは避ける必要があります。

<a name="what-is-in-a-sandbox"></a>サンドボックスの内容
---------------------

サンドボックスには、サンドボックスに追加されるすべてのタイトルの製品インスタンスが含まれます。

<a name="what-is-a-sandbox-id"></a>サンドボックス ID とは
---------------------

サンドボックス ID は、タイトル、製品、サービス構成に関するデータのパーティション分割単位を表します。複数のタイトルが同じサンドボックス内に共存することができます。これは、それらのタイトルがサービス構成データを共有するための前提条件となります。

(大文字と小文字) サンド ボックス ID は、次の形式で文字列: &lt;PublisherMoniker&gt;します。*n*があります。 XLDP.5 というサンドボックス ID の例について、次に説明します。

-   *パブリッシャー モニカー*はすべての公開元の間で一意です。 したがって、"XLPD" はこの特定の公開元のパブリッシャー モニカーとなります。 パブリッシャー モニカーは、開発者アカウント情報マネージャーによって公開元が XDP 内で "アクティブ化" されるときに作成されます。

-   数字 "*n*" はサンドボックスの数を示します。 この場合、"5" はこの公開元用に作成される 6 番目のサンドボックスです。

タイトルのデータがサービスを介して移行されるとき、Xbox サービスはサンドボックス ID を使用して、生成されるデータの "環境" を一意に識別します。

<a name="what-data-is-sandboxed"></a>どのようなデータがサンドボックス化されるか
-----------------------

次の図では、どのようなユーザー データやタイトル データがサンドボックス化されるかを示しています。

![](images/sandboxes/sandboxes_image5.png)

<a name="global-override-sandbox"></a>グローバル オーバーライド サンドボックス
-----------------------

開発者は、開発キット上でサンドボックス ID を設定することによって、開発キットが動作するサンドボックスを設定します。これはグローバル オーバーライド サンドボックスとも呼ばれます。 したがって、開発キットで Xbox Live サービス (実績、マッチメイキング、ライセンス、EDS など) に対してタイトル (シェル アプリおよび通常のアプリ) から実行されるすべての要求はそのサンドボックスで実行されます。

グローバル オーバーライド サンドボックスでは、このサンドボックスに取り込まれたコンテンツのみが参照時に表示されます。

<a name="types-of-sandboxes"></a>サンドボックスの種類
-------------------------------------------------------------------------------------------------------------------------------------------------------

サンドボックスには 2 つの異なるカテゴリーがあります。 これらのカテゴリーは以下のように定義されます。

-   *パブリッシャー サンドボックス*。 公開元はそれぞれの開発中サンドボックスにアクセスできます。 これらのサンドボックスは、XLDP.0、XLDP.1、XLDP.2、XLDP.3 のような名前になります。これは、公開元が自社タイトルの製品インスタンスを配置する場所です。 これらのサンドボックスへのアクセスは、公開元がアクセスを許可するユーザー/デバイスに限定されます。

-   *Microsoft サンドボックス*。 これらは組み込みのサンドボックスである RETAIL および CERT です。Microsoft のみが、これらの保護されたサンドボックスに公開することを許可されています。

<a name="cert-sandbox"></a>CERT サンドボックス
------------

一般提供の準備ができたタイトルは、まず認定に合格する必要があります。 CERT サンドボックスは Microsoft が管理するサンドボックスであり、認定の担当者のみがアクセスできます。 公開元は、自社が保有するどのコンテンツが認定に合格しているかを確認できます。

認定で不合格となった製品インスタンスは、発行元が XDP または Windows デベロッパー センターを使用して固定し、デバッグの開発サンド ボックスに戻すことができます。

<a name="retail-sandbox"></a>RETAIL サンドボックス
--------------

RETAIL サンドボックスは、Xbox One 向けに作成されるすべてのコンテンツの最終目的地です。

認定に合格した後、タイトルは RETAIL サンドボックスに追加されます。 署名済みコンテンツのみが RETAIL サンドボックスでの実行を許可されます。 これには、発行元が運用できるベータ版も RETAIL サンドボックスで実行されるという重要な意味があります。 RETAIL サンドボックスで生成されるデータは、実際の顧客の運用データを表します。

RETAIL サンドボックス内のコンテンツへのアクセスは、引き続き、コンテンツの分離を通じて制御可能であることに注意してください。

たとえば、発行元が運用できるベータ版は RETAIL サンドボックスで実行され、この場合、発行元が定義するベータ リソース セットのタイトルにどのプリンシパル グループがアクセスできるかを、発行元が選択します。 ベータ タイトルによって生成されるサービス データは実際の運用データであり、タイトルが一般提供に移行した後も保持されます。

<a name="cross-sandbox-data-interaction"></a>サンドボックス間のデータのやり取り
------------------------------

定義によれば、サンドボックスはデータの共有を制限するコンテナーです。 したがって、サンドボックス間のデータのやり取りは不可能です。

## <a name="organizing-your-sandboxes"></a>サンドボックスの整理

このセクションでは、公開元が実行できるサンドボックスの整理方法の例を示します。 公開元は、サンドボックスを使用してデータを整理する方法を理解する必要があります。

**注** 以下の例では、コンテンツの分離による実行時アクセスの管理のみを示しています。

### <a name="scenario-1-two-titles-one-sandbox"></a>シナリオ 1: 2 つのタイトル、1 つのサンドボックス

公開元にとっての基本的な構造として次のようなものが考えられます。

-   設計時と実行時のどちらの場合も、公開元が所有するすべてのユーザーとすべてのデバイスがアクセスできる 2 つのタイトル。

-   タイトルごとに 1 つの製品インスタンス。

この場合、公開元に必要なのは、すべてのプレリリース コンテンツ用の 1 つのサンドボックスだけです。

次の図にユーザー グループを示します。 公開元は、必要に応じてユーザー グループの代わりにデバイス グループを使用することもできます (デバイス グループの方が簡単である場合など)。 また、このユーザー グループは、サンドボックス XLDP.1 とこのサンドボックス内のタイトルに、実行時および設計時にアクセスできます。

![](images/sandboxes/sandboxes_image6.png)

### <a name="scenario-2-one-title-different-teams"></a>シナリオ 2: 1 つのタイトル、異なるチーム

このモデルでの要件は以下のとおりです。

-   1 つのタイトル。

-   開発チームは日単位のビルドを使用して作業する。

-   QA チームは週単位の LKG を使用して作業する。

-   バグがあった場合、開発チームは週単位の LKG をデバッグする必要がある。

-   ファイナンス チームは、タイトルのカタログ リリースに関連する価格カードやその他のメタデータにアクセスする必要がある。

次の図は、TitleX に 2 つの製品インスタンス PI-1 と PI-2 があることを示しています。 製品インスタンスはサンドボックス内に存在する必要がありますが、同じタイトルの 2 つの製品インスタンスが同じサンドボックス内に存在することはできません。 そのため、TitleX-PI-1 はサンドボックス XLDP.1 内にあり、TitleX-PI-2 はサンドボックス XLDP.2 内にあります。

開発ユーザー グループは両方のサンドボックスにアクセスできますが、QA ユーザー グループはサンドボックス XLDP.2 にしかアクセスできません。

また、ファイナンス ユーザー (Group C) は TitleX への設計時アクセスが可能です。 ファイナンス ユーザー グループは通常、タイトルの実行時デバッグにはかかわらないため、分離されています。

**注** 組織に関係なく、XDP ユーザーは複数のユーザー グループに属することができます。

![](images/sandboxes/sandboxes_image7.png)

### <a name="scenario-3-two-titles-completely-separate"></a>シナリオ 3: 2 つのタイトル、完全に分離

この例では、要件が少し異なります。

-   2 つのタイトル。

-   各タイトルへのアクセスを特定の個人の集合に制限する必要がある。

-   タイトルごとに 1 つの製品インスタンス。

-   タイトルの設計時 XDP 構成データにアクセスする必要がある管理ユーザー グループ。 このグループ内の個人は全員が公開元の管理者であり、カタログに公開されるすべてのデータ (カタログ メタデータ、ファイナンス、マーケティング、認定の申請などに関するデータ) を制御できます。

このモデルでは、公開元は両方のタイトルを完全に分離しておくことを選択し、これら 2 つのタイトルを 2 つの異なるサンドボックスに割り当てました。 また公開元は、独立した管理ユーザー グループを作成することを選択し、2 つの製品へのアクセスを割り当てました。

![](images/sandboxes/sandboxes_image8.png)

### <a name="scenario-4-anyway-you-like-it"></a>シナリオ 4: 自由自在に

以下の例では、接続の数を少なくして説明を短くするために、サンドボックスの実行時接続のみを示しました。 設計時のその他のアクセス許可も自由に追加することができます。

この例では、要件は以下のとおりです。

-   公開元内部の特定の要員のみが特定のタイトルにアクセスできる。

-   公開元はさまざまな企業のベンダーと協業し、これらのベンダーは短期契約である場合がある。

-   公開元は、タイトルを使用停止にすることによって、ベンダーまたは FTE がアクセスしていたデータへのアクセスを遮断できる必要がある。

この要件をモデル化するために、次のような構造を採用することができます。

使用したモデルは次のとおりです。

-   TitleX と TitleY の製品インスタンスが、サンドボックス XLDP.1 にそれぞれ 1 つだけある。

-   TitleZ には 2 つの製品インスタンスがあり、1 つはサンドボックス XLDP.2 に、もう 1 つはサンドボックス XLDP.3 にある。

-   FTE User Group B は、すべてのサンドボックス内の製品インスタンスへのアクセスが許可される。

-   Vendor User Group A はベンダーのみのユーザー グループであり、サンドボックス XLDP.1 へのアクセスが許可される。

-   Vendor Device Group C はベンダーのみのユーザー グループであり、サンドボックス XLDP.3 へのアクセスが許可される。

![](images/sandboxes/sandboxes_image9.png)

## <a name="summary"></a>まとめ

Xbox Live 開発では、運用品質のサービスと運用レベルの MSA 開発者アカウントを使用して運用環境でテストを実行できるため、公開元にとっては非常に有用な開発を実現できます。 機能と柔軟性の向上に伴い、開発中および一般提供後、タイトル データを作成したり、タイトルへのアクセスを管理したりするための新しい構成手順が XDP で必要になっています。

サンドボックスは運用環境のデータをパーティション分割するための方法です。 すべてのコンテンツを対象とした運用環境は 1 だけしか存在しないため、サンドボックスは、ある環境で生成されたデータが他の環境に移行されない "仮想環境" として機能します。
