---
title: 大規模なセッション
author: KevinAsgari
description: Xbox Live マルチプレイヤー プラットフォームで大規模なセッションを使用する方法について説明します。
ms.author: kevinasg
ms.date: 07/11/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Xbox Live, Xbox, ゲーム, UWP, Windows 10, Xbox One, マルチプレイヤー, 大規模なセッション, 最近のプレイヤー
ms.localizationpriority: medium
ms.openlocfilehash: cead1a3ca1d56185ef97fe3f3271484bfbc58f18
ms.sourcegitcommit: 9354909f9351b9635bee9bb2dc62db60d2d70107
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/16/2018
ms.locfileid: "4681882"
---
# <a name="large-sessions"></a>大規模なセッション

100 人を超えるメンバーを処理できるマルチプレイヤー セッションが必要な場合は、"大規模なセッション" を使用する必要があります。 このシナリオは、大規模マルチプレイヤー オンライン (MMO) のゲームやブロードキャスト (この場合はメンバーの大半が観戦者になります) への適用が最も一般的ですが、他のスタイルのゲームにも応用できることがあります。

状況によっては、もっと少数のプレイヤー グループを扱う場合にも大規模なセッションを使用できます。 同じセッションに複数のプレイヤーが参加しても、ゲーム内で遭遇しなければ互いに知らなくても良いという場合は、大規模なセッションの "encounters" プロパティを使用できます。

現在、[Xbox Integrated Multiplayer (XIM)](../xbox-integrated-multiplayer.md) や [Multiplayer Manager (MPM)](../multiplayer-manager.md) では大規模なセッションがサポートされていないため、Multiplayer 2015 API を使用してマルチプレイヤー サービス ディレクトリ (MPSD) の直接呼び出しを行う必要があります。

大規模なセッションの扱いは、通常のセッションとは若干異なります。

* 通常のセッションより格納できる情報量は少なくなりますが、効率的です。
* 最大 10,000 人のメンバーがサポートされます。
* 大規模なセッションをサブスクライブすることはできません。
* 大規模なセッションのメンバーは、自動的にはプレイヤーの履歴 (最近のプレイヤー) 一覧に含まれません。

## <a name="recent-players"></a>プレイヤーの履歴

Xbox Live の機能の 1 つは、Xbox Live プレイヤーがマルチプレイヤー ゲームを新しいユーザーとプレイする場合、ゲームの後に、これらのプレイヤーがダッシュボードの **[プレイヤーの履歴]** 一覧に表示されることです。 プレイヤーが新しいプレイヤーと楽しくゲームをプレイできた場合は、これらのプレイヤーと再度プレイしたり、フレンドに追加することができます。 あるプレイヤーとプレイした際に楽しくなかった場合は、今後はこれらのプレイヤーとのプレイを避けたり、ゲームの終了後にそのプレイヤーの不快な行為を報告することもできます。

通常のセッションでは、同じセッションのプレイヤーが Xbox Live によって自動的にプレイヤーの履歴一覧に追加されます。 大規模なセッションでは、プレイヤーの履歴一覧が正しく設定されているか確認するには、追加の手順が必要になります。

## <a name="set-up-a-large-session"></a>大規模なセッションのセットアップ

大規模なセッションをセットアップするには、セッション テンプレートの capabilities セクションに `“large”: true` を追加します。 これにより、`maxMembersCount` に 10,000 までの値を設定できます。 次のようなセッション テンプレートを使用できます。

```json
{
    "constants": {
        "system": {
            "version": 1,
            "maxMembersCount": 2000,
            "visibility": "open",
            "capabilities": {
                "gameplay": true,
                "large": true
            },
            "timeouts": {
                "inactive": 0,
                "ready": 180000,
                "sessionEmpty": 0
            }
        },
        "custom": { }
    }
}
```

## <a name="working-with-large-sessions"></a>大規模なセッションの操作

大規模なセッションを MPSD に書き込む場合、1 秒あたりの書き込みが 10 件を超えないようにすることをお勧めします。 これは、1000 プレイヤーのセッションで各プレイヤーの書き込み (参加/退出など) が 2 分ごとに発生することを想定した場合の一般的な設定です。

その他のプロパティは、大規模なセッションでは管理しないでください。

### <a name="associating-players-from-the-same-large-session"></a>同じ大規模セッションのプレイヤーどうしを関連付ける

MPSD から大規模なセッションを取得する場合、応答と共にメンバーの一覧が返されず、完全な一覧を取得する方法はありません。 呼び出し元がセッションに参加している場合、"members" コレクション内にあるのは、そのメンバーのメンバー レコードのみです (要求内の場合と同様、"me" というラベルが付いています)。

つまり、クライアント メンバーがセッション内で更新できるのは自身のエントリのみです。一緒にプレイしたプレイヤーどうしを関連付けるために Xbox Live で使用できる共通の識別子は、サーバーから取得する必要があります。

セッションで一緒にプレイしたユーザーを示す方法 (評判や最近のプレイヤーの状態を更新する目的で必要になります) は 2 つあります。

#### <a name="1-persistent-groups"></a>1. 永続的なグループの場合

ユーザーのグループが継続的に行動を共にしている場合 (ユーザーの参加や退出は可能)、そのグループに名前を付けることができます (通常のセッションについては同じ名前付け規則に従い、guid などを使用します)。  各メンバーがグループに参加またはグループから退出する際には、このグループ名を自身の "groups" プロパティ (文字列の配列) に対して追加または削除する必要があります。

```json
{
    "members": {
        "me": {
            "properties": {
                "system": {
                    "groups": [ "boffins-posse" ]
                }
            }
        }
    }
}
```

#### <a name="2-brief-encounters"></a>2. 一時的な遭遇の場合

2 人のユーザーが一時的に遭遇した場合、ゲームでは "encounters" 配列を使用します。 各遭遇に名前を付けておき、遭遇の後、両方 (すべて) の参加者はその名前を自身の "encounters" に書き込みます。

```json
{
    "members": {
        "me": {
            "properties": {
                "system": {
                    "encounters": [ "trade.0c7bbbbf-1e49-40a1-a354-0a9a9e23d26a" ]
                }
            }
        }
    }
}
```

同じ名前を "groups" と "encounters" の両方に使うことができます。たとえば、1 人のプレイヤーがグループと遭遇した場合、グループ内のユーザーは (グループ名を自身の "groups" に追加していれば) 何もする必要がありません。遭遇した個人のプレイヤーは、グループ名を自身の "encounters" リストにアップロードします。 これで、個人のプレイヤーの [プレイヤーの履歴] に、グループ内のすべてのメンバーが表示されます (その逆も同様)。

遭遇は、30 秒の間グループのメンバーであったとしてカウントされます。 遭遇は偶発的な出来事であると見なされるため、"encounters" 配列は常に即時処理され、セッションからクリアされます。  応答に含まれることはありません   ("groups" 配列は変更または削除されるか、メンバーがセッションから退出するまで存続します)。
