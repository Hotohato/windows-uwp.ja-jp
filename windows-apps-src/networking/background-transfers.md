---
xxxxxxxxxxx: Xxx xxx xxxxxxxxxx xxxxxxxx XXX xx xxxx xxxxx xxxxxxxx xxxx xxx xxxxxxx.
xxxxx: Xxxxxxxxxx xxxxxxxxx
xx.xxxxxxx: YYYYXYYY-XXYY-YXXY-XXXY-XXYYYYYXYYYX
---

# Xxxxxxxxxx xxxxxxxxx

\[ Xxxxxxx xxx XXX xxxx xx Xxxxxxx YY. Xxx Xxxxxxx Y.x xxxxxxxx, xxx xxx [xxxxxxx](http://go.microsoft.com/fwlink/p/?linkid=619132) \]


**Xxxxxxxxx XXXx**

-   [**Xxxxxxx.Xxxxxxxxxx.xxxxxxxxxxXxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207242)
-   [**Xxxxxxx.Xxxxxxxxxx.Xxx**](https://msdn.microsoft.com/library/windows/apps/br225998)
-   [**Xxxxxxx.Xxxxxxxxxx.Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226960)

Xxx xxx xxxxxxxxxx xxxxxxxx XXX xx xxxx xxxxx xxxxxxxx xxxx xxx xxxxxxx. Xxx xxxxxxxxxx xxxxxxxx XXX xxxxxxxx xxxxxxxx xxxxxx xxx xxxxxxxx xxxxxxxx xxxx xxx xx xxx xxxxxxxxxx xxxxxx xxx xxxxxxxxxx xxx xxxxxxx xxxxxx xxx xxxxxxxxxxx. Xxx XXX xxxxxxxx xxxxxxx xxxxxx xxx xxxxxxxxxxxxx xxxxxxxx xxx xxxxxxx xxxxxxxxx xxxx xxxxxxxxxxxx xx xxxx, xxx xxxxxxxxx xxx xxxx Xxxx Xxxxx-xxxxx xxx Xxxxxxx Xxxxx-xxxxx, xxxxxxx xxxx xxxxxxxx xxxxxxxx xxxxxxx xxxxx xx xxxx xxxxxxx xxxxxxxxxxxx xxx xxxxxx xxxxxxx xxxxxx. Xxx XXX xx xxxxx xxx xxxxxxxxx xxx xxxxxxxxxxx xxxxx xxxxx xxxxx XXXX(X). XXX xx xxxx xxxxxxxxx, xxx xxxx xxx xxxxxxxxx.

Xxxxxxxxxx Xxxxxxxx xxxx xxxxxxxxxx xxxx xxx xxxxxxx xxx xxx xx xxxxxxxxx xxxxxxxx xxx xxxx-xxxx xxxxxxxx xxxxxxxxxx xxx xxxxxxxxx xxxx xxxxx, xxxxx, xxx xxxxx xxxxxx. Xxx xxxxx xxxxxxxxx, xxxxx Xxxxxxxxxx Xxxxxxxx xx xxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxxx xx xxxxxxxx xxxx xxxx xxx xxx xx xxxxxxxxx.

Xx xxx xxx xxxxxxxxxxx xxxxx xxxxxxxxx xxxx xxx xxxxxx xx xxxxxxxx xxxxxxx, xxx xxxxxx xxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639) XXXx xxxxxxx xx Xxxxxxxxxx Xxxxxxxx.

## Xxxxx Xxxxxxx.Xxxxxxxxxx.XxxxxxxxxxXxxxxxxx


### Xxx xxxx xxx Xxxxxxxxxx Xxxxxxxx xxxxxxx xxxx?

Xxxx xx xxx xxxx Xxxxxxxxxx Xxxxxxxx xx xxxxxxxx x xxxxxxxx, xxx xxxxxxx xx xxxxxxxxxx xxx xxxxxxxxxxx xxxxx [**XxxxxxxxxxXxxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207126) xx [**XxxxxxxxxxXxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207140) xxxxx xxxxxxx. Xxxx xxxxxxxx xxxxxxxxx xx xxxxxxx xxxxxxxxxxxx xx xxx xxxxxx xxx xxxxxxxx xxxx xxx xxxxxxx xxx. Xxxxxxxx xxxxxxxxxxx xx xxxxxxxxx xx xxx xxxx xx xxxx xxxxxx xx xxx xxxx xx xxxx xxx'x XX, xxx xxxx xxx xxx xxxxx, xxxxxx, xxxxxx, xx xxxx xxxx xxxx xxx xxxx xxxxx xxx xxxxxxxx xx xxxxxxxxx. Xxx xxx xxxxxxxxx xxx xxxxxxx xx xxx xxxxxx xxxxxxxx xxxxx xxxxx xxxxx xxx xxxxxxxx xxxxxxxx xxxx xxx xxxxx xxxx x xxxxxxxxx xxx xxxxxxxxxx xxxxxx xxxx xx xxx xxxxxxxxxx, xxxxxxxxxxx, xx xxxxxx xxxxxxx xxxxxx xxxxxxx.

### Xxxxxxxxxx xxxxxxxxxxxxx xxxx xxxxxxxx xxxx Xxxxxxxxxx Xxxxxxxx

Xxxxxxxxxx Xxxxxxxx xxxxxxxx xxxxxxx xxxx xxxxxxx xxxxx xxxxxx xxx xxxxx xxxxxxxxxxx, xxxxxxx, xxx xxx xxx xx xxxxxx XXXX xxxxxxx (xxx [**XxxXxxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207146)) xxx xxxx xxxxxxxx xxxxxxxxx.

### Xxx xxxx xxxx xxxxxxx xxxxx xx xxxxxxx xxxxxx xxxxxxx xx xxxxxxxxxx xxxxxxxxx?

Xxx Xxxxxxxxxx Xxxxxxxx xxxxxxx xxxxxxxxx x xxxxxxxxxx xxxxxxxxxx xxx xxxx xxxxxxxx xxxxxxxxx xxxx xxxxxxx xxxxxx xxxxxxx xxxxx, xx xxxxxxxxxxxxx xxxxxxxxxx xxxxxxxxxxxx xxx xxxxxxx xxxx-xxxx xxxxxx xxxxxxxxxxx xxxxxxxx xx xxx [Xxxxxxxxxxxx](https://msdn.microsoft.com/library/windows/apps/hh452990) xxxxxxx. Xx xxxxxx xxxxxxxx xxx xxxxxxxxx xxxxxxx xxxxxxxxx, xx xxx xxxx x xxxx xxxxxx xxx xxxx xxxxxxxxx xxxxx xxxxxx xxxxxxx xx [**XxxxxxxxxxXxxxxxxxXxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207138).

Xxx xxxxxxx, xxx xxxx xxxxxx xxxxxxx xxx xx xxxxxxxxx xxx xxxxxxxx xxxx xxx xxxxxxxxx xxxxxx xx xxxxxx xxxxxxxxxxxxx xxxx xxx xxxxxx xx xxxxx x xxxxxxx xxxxxxx. Xxx xxxxxxxx xx xxxx xxxxxxxxxxxxx xxxxxxx (xx xxxxxxxxx) xxxx x xxxxxxxxxx xx xx "xxxxxxxxxxxx" xxxxxxx xxx xxxx xxxxxxxxxxx. Xxx xxxx xxxxxxxxxxx xx xxx xxxxxxxx xxx xxxxxxx xx xxxx, xxx [**XxxxxxxXxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br207292).

Xxxxx xxx Xxxxxxxxxx Xxxxxxxx xxxxxxx xxx xxx xxx xxxxxxxxxx xxx xxxxxxxx xxxxxxx xxxxxx xxxxxxx, xxxxx xxx xxxxx xxxxxxx xxxxxxxxxxxx xxxxxxxxxxxxxx xxx xxxxxxx-xxxxxxxxx xxxx. Xxxx [Xxxxxxxxxx xxxxxxxxx xxxxxxx xxxxxxxxxx xxxxxxxxxxx](https://msdn.microsoft.com/library/windows/apps/hh452983) xxx xxxxxxxxxx xxxx.

> **Xxxx**  Xxx xxxx xxxxxxx xx xxxxxx xxxxxxx, xxxxx xxx xxxxxxxx xxxx xxxxx xxx xxxx xx xxxxxxx xxx xxxxxxxx xxx xxxxxx xx xxxx xxxx xx xxxxxxxxxxx xxxxx xx xxx xxxx xx xxxxxxxxxx, xxxxxxx xxxxxx, xxx xxx xxxx'x xxxx xxxx. Xxxxxxx xx xxxx, xxxxxxxxxx xxxxxxxxx xxx xx xxxxxx xx xxx xxxxx xxxx xxxx xxx [**XxxxxxxxxxXxxxxxxxXxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207138) xxxxxxxxx xxxx xxx xxxxxxxx xxxxxx xxxxxxx.

Xxx xxxxxxxxx xxxxx xxxxxxxxx xxxx xxxxxxxxxx xxxxxxxxx xxx xxxxxxx xx xxx xxxxx xxx xxxx [**XxxxxxxxxxXxxxxxxxXxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207138) xxxxx, xxxxx xxx xxxxxxx xxxxx xx xxx xxxxx. Xxx xxx xxx xxx [**XxxxxxxxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br207244) xxxxx xx xxxxxxxxx xxx xxxxx'x xxxxxxx xxxxx.

| Xxxxxx Xxxxx                                                                                                                      | XxxxxxxxxxxxXxxx | Xxxxxxx | Xxxxxx |
|-----------------------------------------------------------------------------------------------------------------------------------|------------------|---------|--------|
| Xxxxxxxxx xx XxXx                                                                                                                 | Xxxxx            | Xxxxx   | Xxxxx  |
| Xxxxxxx Xxxxxxxxxx, xxx xxxxxxx, xxxxx xxxx xxxxx, xx xxxxx xx xxxx xxxxx xxxxx                                                   | Xxxx             | Xxxxx   | Xxxxx  |
| Xxxxxxx Xxxxxxxxxx, xxx xxxxxxx, xxxxx xxxx xxxxx, xx xxxxx xx xxxxxx xxxxx                                                       | Xxxx             | Xxxx    | Xxxxx  |
| Xxxxxxx Xxxxxxxxxx, xxxxxxx, xxxxx xxxx xxxxx                                                                                     | Xxxx             | Xxxx    | Xxxxx  |
| Xxxxxxx Xxxxxxxxxx, xxxx xxxx xxxxx. Xxxx xxxxx xxxx xxxxxx xxxx xxx xxxx xxxxxxx "Xxxxxxxx xxxxxxxxxx xxxx xx xxx Xxxx Xxxxx XX. | Xxxx             | Xxxx    | Xxxx   |

 

## Xxxxxxxxx xxxxx


Xxxx xxxxx Xxxxxxxxxx Xxxxxxxx xx xxxxxx xxxxxx xx xx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224) xxxx xxxxxxx x xxxxxx xx xxxxxxx xxxxxxx xxxx xxx xxxx xx xxxxxxx xx xxxxxx xxx xxxxxxxxx. Xxx xxxxxx (x.x. xxxxxxxxxx xx xxxxxxxxxxx) xxx xxxxxxxxxxxx xxxxxxx xxx xxxxxxx xxxxxxxxxxxxx xx xxx xxxxxx xxx **XxxxxxXxxxxxxxx**; xxxxxxx xxxx xxxxxxxx xxxxxx xxx xxxxxxxxxx xxxxxxx xx xxxxx xxx xxxxxxx xxxxxx xxx xxxxxxxxxxx. Xxxxxxxxxxxx, xxxxxxx xxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh701018) xxxxxxxx xxxx xxxxxxxx xxxxxxx xx xxx xxxx xxx xxxx xxxxx xxxxxxx xxxxx x xxxxxxx xxxxxxx xx xxxxx xxxx xxx Xxxxxxxx xxxxxxxxxxxx.

Xxx xxxxxxxxx xxxxxxxx xxxx xxxx xxx xxxxxxx xxx xxxxxxxx xxx xxxxxxxxxxxxxx xx x xxxxx xxxxxx xxx xxx xx xxxxxxxxx xxx xxxxxxxxxxx xxxxxxxxxx xxxxxxxxx xxxx x xxxxxxxx xxx xxxxxxx.

### Xxxxxxxxx x xxxxxx xxxx

Xxx xxxxxxxx xx xx xxxxxx xxxxxx xxxx [**XxxxxxxxxxXxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207140). Xxxx xxxxx xx xxxx xx xxxxxxx xxx xxxxxxx xxxx xxxxxx xxxx xxx xx xxxxxxxxx xxx xxxxxx xxxxxx xxxxxxxx xxx xxxxxxxxx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224). Xxx xxxxxxxxx xxxxxxx xxxxx xxx xx xx xxxx xxxx xxx xxxxxxxx [**Xxx**](https://msdn.microsoft.com/library/windows/apps/br225998) xxx [**XxxxxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br227171) xxxxxxx.

**Xxxxxxxx xxx xxxx xxx xxxxxxxxxxx xxx xxx xxxxxx**

Xxxxxx xx xxx xxxxx xxxx xxx xxxxxxxx xx xx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224), xx xxxxx xxxx xx xxxxxxxx xxx XXX xx xxx xxxxxxxx xx xxxxxx xx, xxx xxx xxxx xxxx xxxx xx xxxxxxxx. Xx xxx xxxxxxxxx xxxxxxx, xxx *xxxXxxxxx* xxxxx xx xxxxxxxxx xxxxx x xxxxxx xxxx XX xxxxx, xxx xxx *xxxx* xxxxx xxxxx xxx [**XxxxxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br227171) xxxxxx xxxxxxxx xx x [**XxxxXxxxxxXxxxXxxxx**](https://msdn.microsoft.com/library/windows/apps/jj635275) xxxxxxxxx.

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_B "Xxxxxxxx xxx xxxx xxx xxxxxxxxxxx xxx xxx xxxxxx")]

**Xxxxxx xxx xxxxxxxxxx xxx xxxxxx xxxxxxxxx**

Xx xxx xxxxxxxx xxxx xxx *xxxXxxxxx* xxx *xxxx* xxxxxx xxx xxxxxx xx xx xxxxxxxx xx xxx xxxx xxxxxxx, XxxxxxXx, xxxxx xxxx xxx xxxx xx xxxxxxxxx xxx xxxxx xxx xxx xxxxxx xxxxxxxxx. Xxxxx, *xxxXxxxxx* xx xxxxxx xx xxxxxx xxx xxxxxxxx [**Xxx**](https://msdn.microsoft.com/library/windows/apps/br225998) xxxxxx.

Xxxx, xxx xxxxxxxxxx xx xxx xxxxxxxx [**XxxxxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br227171) (*xxxx*) xxx xxxx xx [**XxxxxxxxxxXxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207140) xx xxxxxxxx xxx xxxxxxx xxxxxx xxx xxx xxx *XxxxxxXxxx* xxxxxxxx xxxx xxx **XxxxxxxXxxx** xxxxxx. Xxx [**XxxXxxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207146) xxxxxx xx xxxx xxxxxx xx xxxxxx xxx xxxx xxxx, xxxxxxxx xx x xxxxxx, xxx xxx [**XxxxxxxXxxx.Xxxx**](https://msdn.microsoft.com/library/windows/apps/br227220) xxxxxxxx.

Xxxxxxx, [**XxxxxxxxxxXxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207140) xxxxxxx xxx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224) (*xxxxxx*).

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_A "Xxxxxx xxx xxxxxxxxxx xxx xxxxxx xxxxxxxxx")]

Xxxx xxx xxxxxxxxxxxx xxxxxx xxxxx xxxxxxx xxxxx XxxxXxxxxx xxxxxxxx. Xxxxxxx xx x xxxx xxxx xxx xxxx xxxxxxx:

```javascript
promise = upload.startAsync().then(complete, error, progress);
```

    The async method call is followed by a then statement which indicates methods, defined by the app, that are called when a result from the async method call is returned. For more information on this programming pattern, see [Asynchronous programming in JavaScript using promises](http://msdn.microsoft.com/library/windows/apps/hh464930.aspx).

### Xxxxxxxxx xxxxxxxx xxxxx

**Xxxxxxxx xxx xxxxx xxx xxxxxxxxxxx xxx xxx xxxxxx**

    In a scenario involving multiple files transferred with a single [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224), the process begins as it usually does by first providing the required destination URI and local file information. Similar to the example in the previous section, the URI is provided as a string by the end-user and [**FileOpenPicker**](https://msdn.microsoft.com/library/windows/apps/br207847) can be used to provide the ability to indicate files through the user interface as well. However, in this scenario the app should instead call the [**PickMultipleFilesAsync**](https://msdn.microsoft.com/library/windows/apps/br207851) method to enable the selection of multiple files through the UI.

```javascript
function uploadFiles() {
       var filePicker = new Windows.Storage.Pickers.FileOpenPicker();
       filePicker.fileTypeFilter.replaceAll(["*"]);

       filePicker.pickMultipleFilesAsync().then(function (files) {
          if (files === 0) {
             printLog("No file selected");
                return;
          }

          var upload = new UploadOperation();
          var uriString = document.getElementById("serverAddressField").value;
          upload.startMultipart(uriString, files);

          // Persist the upload operation in the global array.
          uploadOperations.push(upload);
       });
    }
```

**Xxxxxx xxxxxxx xxx xxx xxxxxxxx xxxxxxxxxx**

    The next two examples use code contained in a single example method, **startMultipart**, which was called at the end of the last step. For the purpose of instruction the code in the method that creates an array of [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029) objects has been split from the code that creates the resultant [**UploadOperation**](https://msdn.microsoft.com/library/windows/apps/br207224).

    First, the URI string provided by the user is initialized as a [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998). Next, the array of [**IStorageFile**](https://msdn.microsoft.com/library/windows/apps/br227102) objects (**files**) passed to this method is iterated through, each object is used to create a new [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029) object which is then placed in the **contentParts** array.

```javascript
upload.startMultipart = function (uriString, files) {
        try {
            var uri = new Windows.Foundation.Uri(uriString);
            var uploader = new Windows.Networking.BackgroundTransfer.BackgroundUploader();

            var contentParts = [];
            files.forEach(function (file, index) {
                var part = new Windows.Networking.BackgroundTransfer.BackgroundTransferContentPart("File" + index, file.name);
                part.setFile(file);
                contentParts.push(part);
            });
```

**Xxxxxx xxx xxxxxxxxxx xxx xxxxx-xxxx xxxxxx xxxxxxxxx**

    With our contentParts array populated with all of the [**BackgroundTransferContentPart**](https://msdn.microsoft.com/library/windows/apps/hh923029) objects representing each [**IStorageFile**](https://msdn.microsoft.com/library/windows/apps/br227102) for upload, we are ready to call [**CreateUploadAsync**](https://msdn.microsoft.com/library/windows/apps/hh923973) using the [**Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) to indicate where the request will be sent.

```javascript
        // Create a new upload operation.
            uploader.createUploadAsync(uri, contentParts).then(function (uploadOperation) {

               // Start the upload and persist the promise to be able to cancel the upload.
               upload = uploadOperation;
               promise = uploadOperation.startAsync().then(complete, error, progress);
            });

         } catch (err) {
             displayError(err);
         }
     };
```

### Xxxxxxxxxx xxxxxxxxxxx xxxxxx xxxxxxxxxx

Xx xxxxxxxxxx xx xxxxxxxxxxxx xx xx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224), xxx xxxxxxxxxx xxxxxx xxxxxxxxx xxx xxxxxxxx. Xxxxxxx, xx xxxx xxx xx xxxxxxxxxx xxxxxx xxxxxx xx xxxxx xxxxxx xxx xxxxx, xxx xxxxxx xxxxxxxxxx xxx xxxxxx xxx xxx xxxxxxxxx xxxxxxxxxx xxxx xxxx xxxxxx xxxxxxxx. Xx xxxxx xxxxxxxxxx xxx xxx xxxxxxxxxx xxx xx-xxxxxxxxxx xx xxx xxxx xxx xxxxxxx, xxxx xxxx xxx xx xxxxxxxxx xxx xxxx xxxxxxxx xx xxxxxx xxxxxx xxxxxxxxx.

1.  Xxxxxx xxxxxxxx xxx xxxxxxxx xxxx xxxxxxxxxx xxxxxxxxx xxxxxxxxxx, xx xxxx xx xxxxxx xx xxxxx xxxx xxxx xxxxxxx xxx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224) xxxxxxx xxxx xx xxxx xxxxxx:

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_C "Xxxxxxx xxxxxxxxxxx xxxxxx xxxxxxxxx")]

2.  Xxxx xx xxxxxx xxx xxxxxxxx xxxx xxxxxxxxxx xxxxxxxxx xxxxxxxxxx xxx xxxxxx xxxx xx xxx xxxxx. Xxxx xxxx xxx **xxxx** xxxxxx xxxxxx xx xx-xxxxxx xxxxxxxxx xx xxx [**XxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207224), xxxxxx xx xxxxxxx xxxxxxx xxx xxxxxxxxxxx, xx xx xxx XxxxxxXx xxxxx xx xxxxxx xxxxx xx xxxx xxxxxxx.

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/upload_quickstart/js/main.js#Snippetupload_quickstart_D "Xxxxxxxxx xxxxxxxxx xxxxxxxxxx")]

## Xxxxxxxxxxx xxxxx

Xxxx xxxxx Xxxxxxxxxx Xxxxxxxx, xxxx xxxxxxxx xxxxxx xx x [**XxxxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207154) xxxx xxxxxxx x xxxxxx xx xxxxxxx xxxxxxx xxxx xx xxxxx, xxxxxx, xxxxxxx, xxx xxxxxx xxx xxxxxxxxx. Xxx xxxxxx (x.x. xxxxxxxxxx xx xxxxxxxxxxx) xxx xxxxxxxxxxxx xxxxxxx xxx xxxxxxx xxxxxxxxxxxxx xx xxx xxxxxx xxx **XxxxxxxxXxxxxxxxx**; xxxxxxxxx xxxx xxxxxxxx xxxxxx xxx xxxxxxxxxx xxxxxxx xx xxxxx xxx xxxxxxx xxxxxx xxx xxxxxxxxxxx. Xxx xxxxxx xxxxxxx xxxxxxxxx, xxxxxxx xxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh701018) xxxxxxxx xxxx xxxxxxxx xxxxxxx xx xxx xxxx xxx xxxx xxxxx xx xxxxxxxx xxxxxxxxx xxxxx x xxxxxxx xxxxxxx xx xxxxx xxxx xxx Xxxxxxxx xxxxxxxxxxxx.

Xx xxx xxx xxxxxxxxxxx xxxxx xxxxxxxxx xxxx xxx xxxxxx xx xxxxxxxx xxxxxxx, xxx xxxxxx xxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639) XXXx xxxxxxx xx Xxxxxxxxxx Xxxxxxxx.

Xxx xxxxxxxxx xxxxxxxx xxxx xxxx xxx xxxxxxx xxx xxxxxxxx xxx xxxxxxxxxxxxxx xx x xxxxx xxxxxxxx, xxx xxx xx xxxxxxxxx xxx xxxxxxxxxxx xxxxxxxxxx xxxxxxxxx xxxx x xxxxxxxx xxx xxxxxxx.

### Xxxxxxxxx xxx xxxxx x Xxxxxxxxxx Xxxxxxxx xxxx xxxxxxxx

Xxx xxxxxxxxx xxxxxxx xxxxxxxxxxxx xxx xxxxxxx xxxxxxxxxxxx x XXX xxx x xxxx xxxx xxx xx xxxx xx xxxxxx x [**Xxx**](https://msdn.microsoft.com/library/windows/apps/br225998) xxxxxx xxx xxx [**XxxxxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br227171) xxxx xxxx xxxxxxx xxx xxxxxxxxx xxxx. Xx xxxx xxxxxxx, xxx xxx xxxx xx xxxxxxxxxxxxx xxxxxx xx x xxx-xxxxxxx xxxxxxxx. Xxxxxxxxxxxxx, [**XxxxXxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207871) xxx xx xxxx xxxxx xxxxx xx xxxxxxxx xxxxx xx xxxx xxx xxxx xx xxx xxxxxx. Xxxx xxxx xxx **xxxx** xxxxxx xxxxxx xx xx-xxxxxx xxxxxxxxx xx xxx [**XxxxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207154), xxxxxx xx xxxxxxx xxxxxxx xxx xxxxxxxxxxx, xx xx xxx XxxxxxxxXx xxxxx xxxxxxx xxxxx xx xxxx xxxxxxx.

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_A)]

Xxxx xxx xxxxxxxxxxxx xxxxxx xxxxx xxxxxxx xxxxx XxxxXxxxxx xxxxxxxx. Xxxxxxx xx xxxx YY xxxx xxx xxxxxxxx xxxx xxxxxxx:

```javascript
promise = download.startAsync().then(complete, error, progress);
```

Xxx xxxxx xxxxxx xxxx xx xxxxxxxx xx x xxxx xxxxxxxxx xxxxx xxxxxxxxx xxxxxxx, xxxxxxx xx xxx xxx, xxxx xxx xxxxxx xxxx x xxxxxx xxxx xxx xxxxx xxxxxx xxxx xx xxxxxxxx. Xxx xxxx xxxxxxxxxxx xx xxxx xxxxxxxxxxx xxxxxxx, xxx [Xxxxxxxxxxxx xxxxxxxxxxx xx XxxxXxxxxx xxxxx xxxxxxxx](http://msdn.microsoft.com/library/windows/apps/hh464930.aspx).

### Xxxxxx xxxxxxxxxx xxxxxxxxx xxxxxxx xxxxxxx

Xxx xxxxx xx xxxxxxx xxx xx xxxxxxxxx xx xxxxxxxxxxxx xxxxxxxxxx [**XxxxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207154) xxxxxxx. Xxx xxxxxxx, xxxxxx xxx xxxxxxxxx xxxx xx xxx xxxxxxx xxxxx xxxx xxxxxxxxx xxx xxxxxxx xx xxxxxx xxx xxxxxxxx.

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_B)]

### Xxxxxxxxxxx xxxxxxxxx xxxxxxxxxx xx xxxxx-xx

Xx xxxxxxxxxx xx xxxxxxxxxxxx xx x [**XxxxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207154), xxx xxxxxxxxxx xxxxxx xxxxxxxxx xxx xxxxxxxx. Xxxxxxx, xx xxxx xxx xx xxxxxxxxxx xxxxxx xxxxxx xx xxxxx xxxxxx xxxxx, xxxxxxxxx xxxx xxxxx xxx xxxxxxx xx xxx xxxxxxxxxx. Xxx xxxxxxxxx xxxxxxxx xxxxxxxxxxx xxx xx xx-xxxxxxxxx xxxxxxxxx xxxxxxxxx xxxx x xxx xxx xxxxxxx.

1.  Xxxxxx xxxxxxxx xxx xxxxxxxx xxxx xxxxxxxxxx xxxxxxxxx xxxxxxxxxx, xx xxxx xx xxxxxx xx xxxxx xxxx xxxx xxxxxxx xxx [**XxxxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207154) xxxxxxx xxxx xx xxxx xxxxxx:

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_D)]

2.  Xxxx xx xxxxxx xxx xxxxxxxx xxxx xxxxxxxxxx xxxxxxxxx xxxxxxxxxx xxx xxxxxx xxxx xx xxx xxxxx. Xxxx xxxx xxx **xxxx** xxxxxx xxxxxx xx xx-xxxxxx xxxxxxxxx xxx x xxxxxxxxx [**XxxxxxxxXxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br207154) xx xx xxx XxxxxxxxXx xxxxxxx xx xxxxxx xxxxx xx xxxx xxxxxxx.

[!xxxx-xx[xxxxxxXxxx](./code/backgroundtransfer/download_quickstart/js/main.js#Snippetdownload_quickstart_E)]

3.  Xxx xxx xxx xxx xxx xxxxxxxxx xxxx xx xxxxxxx xxxxxxx xxxxxxxxxx.

## Xxxx-xxxxxxxxxx

X xxx xxxxxxx xx Xxxxxxx YY xx xxx xxxxxxx xx xxx xxxxxxxxxxx xxxx xx xxx xxxxxxxxxx xx x xxxxxxxxxx xxxxxxxx xxxx xxxx xxx xxx xx xxx xxxxxxx. Xxx xxxxxxx, xxxx xxx xxxxx xxxx xx xxxxxx x xxxx xx xxxxxxxxx xxxxxx xxxxx x xxxxx xxx xxxxxxxx xxxxxxxxxxx, xxxxxx xxxx xxxx xxxx xxx xxxx xxx xxx xxxxxx xxxxx xxxx xx xxxxxx. Xx xxxx xxx xxxxx xxxx xx xxxxxx x xxxxxx xxxx xxxxxxxx xx xxxxxx xxxxx xxxxx x xxxxxxxxx xxxxxx xx xxxx. Xxxx-xxxxxxxxxx xx xxxxxxx xxx xxxx xxxxxxxxxx xxx xxxxxx xxxxxxxxx, xx xxx xxx xxx xx xx xxxxxxxxx xxxxxx xxxxx-xxxxxxxx xxx xxxxx xxxxx.

Xxxxxxxxxxxxxx xxxx xxx xxxxxxxx xxxxxxxxxx xxxx xxxxxxxxxxxxxx. Xxx xxxxxx x xxxxxxxxxx xxxx xxx xxxxxxxxx xx xxxx xxxx xxxxxxxxx xxxxxx xxx xxxxx xxx xxxxxxxxx. Xxx xxxxxxxxx xxx xxxx xxxxxxxx xx xxx xxxxxxxxxx, xxx xxxx xxxx xxx xxxxxxxx, xxxx xxxxxxxxxx xxxx xx xxxxxx xx xxxxxxx xxxx-xxxxxxxxxx.

Xxxx-xxxxxxxxxx xxxx x xxx xxxxx, [**XxxxxxxxxxXxxxxxxxXxxxxxxxxxXxxxx**](https://msdn.microsoft.com/library/windows/apps/dn804209). Xxxx xxxxx xx xxxxxxx xx xxx xxxxxxxx [**XxxxxxxxxxXxxxxxxxXxxxx**](https://msdn.microsoft.com/library/windows/apps/dn279030) xx xxxx xx xxxxxx xxx xx xxxxx xxxxxxxxxx xxxxxxxxx xxxxxxxx, xxx **XxxxxxxxxxXxxxxxxxXxxxxxxxxxXxxxx** xxxx xxx xxxxxxx xx xxxxxxxxx x xxxxxxxxxx xxxx xx xx xxx xxxx xxx xxxxxxxx xx xxxxxxxx.

Xxx xxxxxxxx x xxxxxxxxxx xxxxxxxx xxxx xxxx-xxxxxxxxxx xx xxxxxxx.

1.  Xxxxxx x [**XxxxxxxxxxXxxxxxxxXxxxxxxxxxXxxxx**](https://msdn.microsoft.com/library/windows/apps/dn804209) xxxxxx. Xxxx, xxxxxx x [**XxxxxxxxxxXxxxXxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br224768) xxxxxx. Xxx xxx **Xxxxxxx** xxxxxxxx xx xxx xxxxxxx xxxxxx xx xxx xxxxxxxxxx xxxxx xxxxxx, xxx xxx **XxxxXxxxxXxxxx** xxxxxxxx xx xxx xxxxxxx xx xxx xxxxx xxxxx xx xxx xxxxxxxxxx xxxx xxxx xxxxxx xxxxxxx xx xxxxxxxx xxxxxxxxxx. Xxxxxxx, xxxx xxx [**XxxxxxxxxxXxxxXxxxxxx.Xxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br224772) xxxxxx xx xxxxxxxx xxxx xxxxxxxxxx xxxx. Xxxx xxxx xxxx xxxxxxxxxx xxxxxx xxx xxxxx xxx xxxxxxxxxx xxxx xxxxx xxxxx, xxx xxx xxx xxxx xxxx xxx xxxxxxxxxx xxxxx xxx xxxxxxxxxx xxxx xxxxxxxxxxxx.

   ```csharp
    var completionGroup = new BackgroundTransferCompletionGroup();
    BackgroundTaskBuilder builder = new BackgroundTaskBuilder();

    builder.Name = "MyDownloadProcessingTask";
    builder.SetTrigger(completionGroup.Trigger);
    builder.TaskEntryPoint = "Tasks.BackgroundDownloadProcessingTask";

    BackgroundTaskRegistration downloadProcessingTask = builder.Register();
    ```

2.  Next you associate background transfers with the completion group. Once all transfers are created, enable the completion group.

   ```csharp
    BackgroundDownloader downloader = new BackgroundDownloader(completionGroup);
    DownloadOperation download = downloader.CreateDownload(uri, file);
    Task<DownloadOperation> startTask = download.StartAsync().AsTask();

    // App still sees the normal completion path
    startTask.ContinueWith(ForegroundCompletionHandler);

    // Do not enable the CompletionGroup until after all downloads are created.
    downloader.CompletinGroup.Enable();
    ```

3.  The code in the background task extracts the list of operations from the trigger details, and your code can then inspect the details for each operation and perform appropriate post-processing for each operation.

   ```csharp
    public class BackgroundDownloadProcessingTask : IBackgroundTask
    {
      public async void Run(IBackgroundTaskInstance taskInstance)
      {
        var details = (BackgroundTransferCompletionGroupTriggerDetails)taskInstance.TriggerDetails;
        IReadOnlyList<DownloadOperation> downloads = details.Downloads;

        // Do post-processing on each finished operation in the list of downloads
      }
    }
    ```

The post-processing task is a regular background task. It is part of the pool of all background tasks, and it is subject to the same resource management policy as all background tasks.

Also, note that post-processing does not replace foreground completion handlers. If your app defines a foreground completion handler, and your app is running when the file transfer completes, then both your foreground completion handler and your background completion handler will be called. The order in which foreground and background tasks are called is not guaranteed. If you define both, you should ensure that the two tasks will work properly and not interfere with each other if they are running concurrently.

## Request timeouts

There are two primary connection timeout scenarios to take into consideration:

-   When establishing a new connection for a transfer, the connection request is aborted if it is not established within five minutes.

-   After a connection has been established, an HTTP request message that has not received a response within two minutes is aborted.

> **Note**  In either scenario, assuming there is Internet connectivity, Background Transfer will retry a request up to three times automatically. In the event Internet connectivity is not detected, additional requests will wait until it is.

## Debugging guidance

Stopping a debugging session in Microsoft Visual Studio is comparable to closing your app; PUT uploads are paused and POST uploads are terminated. Even while debugging, your app should enumerate and then restart or cancel any persisted uploads. For example, you can have your app cancel enumerated persisted upload operations at app startup if there is no interest in previous operations for that debug session.

While enumerating downloads/uploads on app startup during a debug session, you can have your app cancel them if there is no interest in previous operations for that debug session. Note that if there are Visual Studio project updates, like changes to the app manifest, and the app is uninstalled and re-deployed, [**GetCurrentUploadsAsync**](https://msdn.microsoft.com/library/windows/apps/hh701149) cannot enumerate operations created using the previous app deployment.

When using Background Transfer during development, you may get into a situation where the internal caches of active and completed transfer operations can get out of sync. This may result in the inability to start new transfer operations or interact with existing operations and [**BackgroundTransferGroup**](https://msdn.microsoft.com/library/windows/apps/dn279030) objects. In some cases, attempting to interact with existing operations may trigger a crash. This result can occur if the [**TransferBehavior**](https://msdn.microsoft.com/library/windows/apps/dn279033) property is set to **Parallel**. This issue occurs only in certain scenarios during development and is not applicable to end users of your app.

Four scenarios using Visual Studio can cause this issue.

-   You create a new project with the same app name as an existing project, but a different language (from C++ to C#, for example).
-   You change the target architecture (from x86 to x64, for example) in an existing project.
-   You change the culture (from neutral to en-US, for example) in an existing project.
-   You add or remove a capability in the package manifest (adding **Enterprise Authentication**, for example) in an existing project.

Regular app servicing, including manifest updates which add or remove capabilities, do not trigger this issue on end user deployments of your app.
To work around this issue, completely uninstall all versions of the app and re-deploy with the new language, architecture, culture, or capability. This can be done via the **Start** screen or using PowerShell and the **Remove-AppxPackage** cmdlet.

## Exceptions in Windows.Networking.BackgroundTransfer

An exception is thrown when an invalid string for a the Uniform Resource Identifier (URI) is passed to the constructor for the [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) object.

**.NET:  **The [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998) type appears as [**System.Uri**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.aspx) in C# and VB.

In C# and Visual Basic, this error can be avoided by using the [**System.Uri**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.aspx) class in the .NET 4.5 and one of the [**System.Uri.TryCreate**](https://msdn.microsoft.com/library/windows/apps/xaml/system.uri.trycreate.aspx) methods to test the string received from the app user before the URI is constructed.

In C++, there is no method to try and parse a string to a URI. If an app gets input from the user for the [**Windows.Foundation.Uri**](https://msdn.microsoft.com/library/windows/apps/br225998), the constructor should be in a try/catch block. If an exception is thrown, the app can notify the user and request a new hostname.

The [**Windows.Networking.backgroundTransfer**](https://msdn.microsoft.com/library/windows/apps/br207242) namespace has convenient helper methods and uses enumerations in the [**Windows.Networking.Sockets**](https://msdn.microsoft.com/library/windows/apps/br226960) namespace for handling errors. This can be useful for handling specific network exceptions differently in your app.

An error encountered on an asynchronous method in the [**Windows.Networking.backgroundTransfer**](https://msdn.microsoft.com/library/windows/apps/br207242) namespace is returned as an **HRESULT** value. The [**BackgroundTransferError.GetStatus**](https://msdn.microsoft.com/library/windows/apps/hh701093) method is used to convert a network error from a background transfer operation to a [**WebErrorStatus**](https://msdn.microsoft.com/library/windows/apps/hh747818) enumeration value. Most of the **WebErrorStatus** enumeration values correspond to an error returned by the native HTTP or FTP client operation. An app can filter on specific **WebErrorStatus** enumeration values to modify app behavior depending on the cause of the exception.

For parameter validation errors, an app can also use the **HRESULT** from the exception to learn more detailed information on the error that caused the exception. Possible **HRESULT** values are listed in the *Winerror.h* header file. For most parameter validation errors, the **HRESULT** returned is **E\_INVALIDARG**.

<!--HONumber=Mar16_HO1-->
