---
author: jnHs
Description: The Microsoft Store enforces certain rules related to version numbers, which work somewhat differently in different OS versions.
title: パッケージ バージョンの番号付け
ms.assetid: DD7BAE5F-C2EE-44EE-8796-055D4BCB3152
ms.author: wdg-dev-content
ms.date: 10/26/2017
ms.topic: article
ms.prod: windows
ms.technology: uwp
keywords: Windows 10, UWP
ms.localizationpriority: high
ms.openlocfilehash: a5c9c676a3ccd8ff7f1e7d53d9019d722fefa722
ms.sourcegitcommit: 1773bec0f46906d7b4d71451ba03f47017a87fec
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/17/2018
---
# <a name="package-version-numbering"></a>パッケージ バージョンの番号付け


提供する各パッケージには、バージョン番号がある必要があります (アプリ マニフェストの **Package/Identity** 要素の **Version** 属性の値として提供されます)。 Microsoft Store ではバージョン番号に関する特定の規則が適用され、別の OS バージョンでは機能が多少異なります。

> [!NOTE]
> このトピックは "パッケージ" について説明していますが、特に記載のない限り、.appx ファイルと .appxbundle ファイルのバージョン番号にも同じ規則が適用されます。


## <a name="version-numbering-for-windows-10-packages"></a>Windows 10 パッケージのバージョン番号付け

Windows 10 パッケージのバージョン番号は、同じアプリについて公開中の Windows 8、Windows 8.1、Windows Phone 8.1 のパッケージ (または前に公開したこれらの OS バージョンのパッケージ) のバージョン番号より常に大きい必要があります  (詳しくは、「[以前に公開したアプリに Windows 10 用のパッケージを追加する](https://docs.microsoft.com/en-us/windows/uwp/publish/guidance-for-app-package-management#adding-packages-for-windows-10-to-a-previously-published-app)」をご覧ください)。

> [!IMPORTANT]
> バージョン番号の最後 (4 番目) のセクションはストア用に予約されており、パッケージをビルドする際に 0 のままにしておく必要があります (ただし、ストアはこのセクションの値を変更する可能性があります)。

公開された申請から Windows 10 パッケージを選択すると、Microsoft Store は常にユーザーのデバイスに適用可能で最も高いバージョンのパッケージを使用します。 これにより高い柔軟性が与えられ、特定のデバイスの種類のユーザーにどのパッケージを提供するかを管理することができます。 重要なことに、これらのパッケージは任意の順序で申請することができます。後続の各申請でより高いバージョンのパッケージを提供する必要はありません。

同じバージョン番号を持つ複数の Windows 10 パッケージを提供することもできます。 ただし、バージョン番号を共有するパッケージが同じアーキテクチャを持つことはできません。ストアで各パッケージに使用する完全な ID は一意である必要があるためです。 詳しくは、「[**Identity**](https://docs.microsoft.com/uwp/schemas/appxpackage/appxmanifestschema/element-identity)」をご覧ください。

同じバージョン番号を使う複数の Windows 10 パッケージを提供する場合、指定のデバイスにどのパッケージを提供するかを検討する際にどのランクがより高いかを決定するのにアーキテクチャ (x64、x86、ARM、ニュートラルの順番) が使用されます。 バージョン番号が同じアプリ バンドルにランクを付けるときは、x64 パッケージが含まれているアプリ バンドルが x86 パッケージしか含まれていないアプリ バンドルより高いランクとなるようにバンドル内で最高のアーキテクチャのランクを考慮します。

これにより、アプリを時間をかけて進化させる大きな柔軟性が与えられます。 小さいバージョン番号を使って新しいパッケージをアップロードして申請し、以前サポートしていなかった手頃なデバイスのサポートを追加したり、より厳密な依存関係を持つより高いバージョンのパッケージを追加してハードウェアまたは OS の機能を利用したり、既存のユーザー ベースの一部または全部に更新となるより高いバージョンのパッケージを追加したりすることができます。

次の例は、バージョン番号を管理して複数の申請でユーザーに目的のパッケージを提供する方法について説明します。

### <a name="example-moving-to-a-single-package-over-multiple-submissions"></a>例: 複数の申請で 1 つのパッケージに移行する

Windows 10 では、すべての場所で実行される単一のコードベースを記述することができます。 これにより、新しいクロスプラットフォーム プロジェクトの開始がはるかに簡単になります。 ただし、さまざまな理由から、既存のコードベースを結合してすぐに 1 つのプロジェクトを作成したくない場合があります。

パッケージのバージョンの規則を使用すると、ユニバーサル デバイス ファミリではユーザーを 1 つのパッケージに徐々に移行させ、一方で (Windows 10 API を利用するものを含む) 特定のデバイス ファミリでは暫定的な多数の更新を配布することができます。 次の例では、同じ規則を一貫して適用する方法を示しています。

| 申請 | 内容                                                  | カスタマー エクスペリエンス                                                                                                                                                                             |
|------------|-----------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1          | -   パッケージ バージョン: 1.1.10.0 <br> -   デバイス ファミリ: Windows.Desktop、minVersion 10.0.10240.0 <br> <br> -   パッケージ バージョン: 1.1.0.0 <br> -   デバイス ファミリ: Windows.Mobile、minVersion 10.0.10240.0     | -   Windows 10 デスクトップ ビルド 10.0.10240.0 以上のデバイスでは 1.1.10.0 を取得。 <br> -   Windows 10 Mobile ビルド 10.0.10240.0 以上のデバイスでは 1.1.0.0 を取得。 <br> -   その他のデバイス ファミリでアプリの購入とインストールを行うことはできない。 |
| 2          | -   パッケージ バージョン: 1.1.10.0 <br> -   デバイス ファミリ: Windows.Desktop、minVersion 10.0.10240.0 <br> <br> -   パッケージ バージョン: 1.1.0.0 <br> -   デバイス ファミリ: Windows.Mobile、minVersion 10.0.10240.0 <br> <br> -   パッケージ バージョン: 1.0.0.0 <br> -   デバイス ファミリ: Windows.Universal、minVersion 10.0.10240.0    | -   Windows 10 デスクトップ ビルド 10.0.10240.0 以上のデバイスでは 1.1.10.0 を取得。 <br> -   Windows 10 Mobile ビルド 10.0.10240.0 以上のデバイスでは 1.1.0.0 を取得。 <br> -   導入されているその他の (非デスクトップ、非モバイル) デバイス ファミリでは 1.0.0.0 を取得。 <br> -   アプリが既にインストールされているデスクトップ デバイスとモバイル デバイスでは更新が表示されない (利用可能な最高のバージョンが既にあり、1.1.10.0 と 1.1.0.0 は共に 1.0.0.0 より上位であるため)。 |
| 3          | -   パッケージ バージョン: 1.1.10.0 <br> -   デバイス ファミリ: Windows.Desktop、minVersion 10.0.10240.0 <br> <br> -   パッケージ バージョン: 1.1.5.0 <br> -   デバイス ファミリ: Windows.Universal、minVersion 10.0.10250.0 <br> <br> -   パッケージ バージョン: 1.0.0.0 <br> -   デバイス ファミリ: Windows.Universal、minVersion 10.0.10240.0    | -   Windows 10 デスクトップ ビルド 10.0.10240.0 以上のデバイスでは 1.1.10.0 を取得。 <br> -   Windows 10 Mobile ビルド 10.0.10250.0 以上のデバイスでは 1.1.5.0 を取得。 <br> -   Windows 10 Mobile ビルド 10.0.10240.0 以上 10.010250.0 未満のデバイスでは 1.1.0.0 を取得。 
| 4          | -   パッケージ バージョン: 2.0.0.0 <br> -   デバイス ファミリ: Windows.Universal、minVersion 10.0.10240.0   | -   Windows 10 ビルド v10.0.10240.0 以上のすべてのデバイス ファミリのすべてのユーザーはパッケージ 2.0.0.0 を取得。 | 

> [!NOTE]
>  どの場合でも、ユーザーのデバイスでは条件を満たす最も大きいバージョン番号のパッケージを受け取ります。 たとえば、上記の 3 番目の申請では、OS バージョン 10.0.10250.0 以上で v1.1.5.0 を取得できる場合でも、すべてのデスクトップ デバイスが v1.1.10.0 を取得します。 1.1.10.0 は利用可能な最も大きいバージョン番号であるため、これが取得するパッケージになります。

### <a name="using-version-numbering-to-roll-back-to-a-previously-shipped-package-for-new-acquisitions"></a>新規の取得のためにバージョン番号を使用して以前配布したパッケージにロールバックする

以前の Windows 10 パッケージ ファイルのコピーを維持する場合は、リリースに関する問題が見つかった場合にストア内のアプリのパッケージを以前の Windows 10 パッケージにロールバックすることができます。 これは、問題を修正する間のユーザーの中断を限定するための一時的な方法です。

このためには、新しい申請を作成します。 問題があるパッケージを削除して、ストアで提供する以前のパッケージをアップロードします。 ロールバックするパッケージを既に受け取っているユーザーは問題のあるパッケージを持ったままになります (以前のパッケージのバージョン番号がより小さいため)。 しかし、これにより、ストアでアプリを利用できるようにした間にその他のユーザーが問題のあるパッケージを取得することができなくなります。

問題があるパッケージを既に受信したユーザーの問題を解決するためには、できるだけ早く問題のあるパッケージよりも大きいバージョン番号を持つ新しい Windows 10 パッケージを申請することです。 その申請の認定プロセスが完了すると、それがより大きいバージョン番号になるため、すべてのユーザーが新しいパッケージに更新されます。


## <a name="version-numbering-for-windows-81-and-earlier-and-windows-phone-81-packages"></a>Windows 8.1 (以前) と Windows Phone 8.1 パッケージのバージョン番号付け

Windows Phone 8.1 を対象とする .appx パッケージでは、新しい申請のパッケージのバージョン番号は最後の申請 (または、以前の申請) に含まれるパッケージの番号より常に大きい必要があります。

Windows 8 と Windows 8.1 を対象とする .appx パッケージでは、アーキテクチャごとに同じ規則が適用されます。新しい申請のパッケージのバージョン番号は、同じアーキテクチャで最後に Microsoft Store に公開されたパッケージの番号より常に大きい必要があります。

さらに、Windows 8.1 用パッケージのバージョン番号は、同じアプリのどの Windows 8 用パッケージのバージョン番号よりも常に大きい必要があります。 言い換えれば、申請する Windows 8 用パッケージのバージョン番号は、同じアプリについて申請したすべての Windows 8.1 用パッケージのバージョン番号よりも小さい必要があります。

> [!NOTE]
> Windows 10 パッケージもある場合、Windows 10 パッケージのバージョン番号は、公開中または公開したことがある Windows 8、Windows 8.1、Windows Phone 8.1 のパッケージのバージョン番号より大きい必要があります。 詳しくは、「[以前に公開したアプリに Windows 10 用のパッケージを追加する](guidance-for-app-package-management.md#adding-packages-for-windows-10-to-a-previously-published-app)」をご覧ください。

ここでは、Windows 8 と Windows 8.1 のさまざまなバージョン番号の更新シナリオで何が起きるかの例を示します。

| ストア内のアプリのバージョン  | アップロードするバージョン | 新しいバージョンが Microsoft Store にアップロードされた後の動作、新規インストールのバージョン | 新しいバージョンが Microsoft Store にアップロードされた後の動作、既存のバージョンの更新 |
|---------------------------------------------|-----------------------------|--------------------------------------------------------------------------------------------|----------|
| なし                                     | x86, v1.0.0.0               | x86, v1.0.0.0 (x86 と x64 の両方のコンピューター)                                                | なし。 |
| x86, v1.0.0.0                               | x64, v1.0.0.0               | 対応するアーキテクチャ用の v1.0.0.0                                                   | なし:  バージョン番号は同じであるため。 |
| x86, v1.0.0.0 <br> x64, v1.0.0.0            | x64, v1.0.0.1               | x86 の場合は v1.0.0.0 <br> x64 の場合は v1.0.0.1                 | アプリを x86 コンピューターで実行している場合はなし。 <br> アプリを x64 コンピューターで実行している場合は v1.0.0.0 から v1.0.0.1 に更新。 <br> **注:** x86 バージョンのアプリを x64 コンピューターで実行している場合、アンインストールして再インストールしない限り、アプリは x64 バージョンに更新されません。 |
| なし                                     | neutral, v1.0.0.1           | neutral, v1.0.0.1 (すべてのコンピューター)                                                         | なし。 |
| neutral, v1.0.0.1                           | x86, v1.0.0.0 <br> x64, v1.0.0.0 <br> ARM, v1.0.0.0 | 対応するアーキテクチャ用の v1.0.0.0          | なし:  neutral, v1.0.0.1 のアプリは引き続き使用される。 |
| neutral, v1.0.0.1 <br> x86, v1.0.0.0 <br> x64, v1.0.0.0 <br> ARM, v1.0.0.0 | x86, v1.0.0.1 <br> x64, v1.0.0.1 <br> ARM, v1.0.0.1 | 対応するアーキテクチャ用の v1.0.0.1 | neutral, v1.0.0.1 のアプリを実行している場合はなし。 <br> 特定のアーキテクチャ用の v1.0.0.0 のアプリを実行している場合は v1.0.0.0 から v1.0.0.1 に更新。 |
| x86, v1.0.0.1 <br> x64, v1.0.0.1 <br> ARM, v1.0.0.1 | x86, v1.0.0.2 <br> x64, v1.0.0.2 <br> ARM, v1.0.0.2 | 対応するアーキテクチャ用の v1.0.0.2  | 特定のアーキテクチャ用の v1.0.0.1 のアプリを実行している場合は v1.0.0.1 から v1.0.0.2 に更新。 |

> [!NOTE]
> .appx パッケージとは異なり、.xap パッケージのバージョン番号は、特定の顧客にどのパッケージを提供するかを決める場合に考慮されません。 特定の .xap パッケージから新しいパッケージへと顧客を更新するには、新しい提出で以前の .xap を削除してください。
