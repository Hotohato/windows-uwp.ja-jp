---
xxxxx: Xxxxxxxxxx xxx xxxxx
xxxxxxxxxxx: Xxxxx xxx xx xxxxxxx xxx xxxxxxxxxxx xxxxxxxxxx xxxxxxxx xxxx xxxx XxxxxxX xxxx.
xx.xxxxxxx: YYYxxxYY-YYYx-YxxY-xYYY-YYYYxYYYYxYY
---

# Xxxxxxxxxx xxx xxxxx


\[ Xxxxxxx xxx XXX xxxx xx Xxxxxxx YY. Xxx Xxxxxxx Y.x xxxxxxxx, xxx xxx [xxxxxxx](http://go.microsoft.com/fwlink/p/?linkid=619132) \]

Xxxxx xxx xx xxxxxxx xxx xxxxxxxxxxx xxxxxxxxxx xxxxxxxx xxxx xxxx XxxxxxX xxxx.

## Xxxxxxxx xx x xxxxxx


X xxxxxxx xx xxxxxxxxxx xxxxxxxx xxx xx xxxx xx xxxx XxxxxxX xxxx, xxxxxxx xx xx x xxxxxx xxxxxxxxxx xxxx xx xxxxxxxxx xxxxx-xxxxxx xxxxx. Xxx xxxxxxxx xxx xx xxxxxxxxxx xxxxx xx xx xxxxx xxxx xxxxx xxx xxxx xxxxxx xx x xxxxxxx xxxxxxx xxxxxx.

Xxxxxxxxxx XXXx xxx xxxxxx xx xxxxx-xxxxxx xxxxx xxxx xxx xxx xxxxxxxxxxxxxx (xxxxxx-xxxxxx xx xxxxxxxx xxxx-xx-xxxx) xxxxx xxx xxxx xx xx xxx (xxxxx xxxx-xx-xxxx) xxxxx. Xxx xxxxxx-xxxxx xxxxx-xxxxxx xxxxx, x xxxxxxx xxxx xxxxxx xxxxxxx xxxxxxx xxxx xx xxx xxxx xxxxxxxxxx xxx xxx xxxxxx xxxx xxx xx xxxx xxx xxxxx, xxxxxxxxxx xxxxxxxx, xxxxxxx xxxxx, xxx xxxxx xxxxxxxx. Xxx xxxxx xxx xxxxxxx xx xxxxxxx xxxxxxxxx xx x xxxxxxx xxx x xxxxxxxxxxxx xxxx xxxxxxxxxx.

Xxx xxxx-xx-xxxx xxxxx, xxxx xxxxxx'x xxx xxxxxxx xxx xxxxx xxx xxxxxxxx. Xx xxxx xxxxx, xxx xxxx xxxxxxx xxx xxxxxxx xx xxxxx xxxxxxxxx xx xxxx xxxxxxx xxxxxxx xxxxxx xx xxxxx xxx xx xxxxx x xxxxxxx. Xxx xx xxxxxxxxx xxxxx xxx xxxxxxxxx x xxxxxxxxxx xxxxxxx x xxxxxxx.

Xxx xxxxxx-xxxxxx xxxxx, x xxxxxxx Xxx xxxxxx xx xxxxxxx xx xxxxx xxxx xx xxxxx xxxx xxxxx, xxxx xxxxxx, xxx xxxxx xxxxxxxxxxxxx xxxxxxxxxxx. Xx xxxxx xxxxx, xxx xxxxx xxx xxxxxxx xx xxxxxxxxxx xxxxxxxxx xx xxxx xx x xxxxxxx xxxxx xx xxxxx'x xxxxxxxx xxxxxx xxxx xxxxxxxxx.

Xxxxxxx xxxxxxxxxx xxx xxxxxx xx xxx xxxx, xx xxx xxxx xxxx xxxx xxxxxxxxxx XXXx xxxxx xx xxxxxx xxxxxxx xxxxxxxxxx xxxx xxx xxxxx. Xx xxxxx xxxx xxxxx xxxxxxxx xxxxxxx xxxxxxxxxx, xxx [Xxxxxxxxxx xxxxxx](https://msdn.microsoft.com/library/windows/apps/mt280233).

Xxxxxxxxx xxx xxx xxxxxxx xxx xxxxxx xxx xxx xxxxxx xxx xxxxxxx xx xxx xxxxxxxxxx xxxxxxxx. X xxxx xxxx xxxx xxxxxxxxxx xxxxx xx xx xxxxxxxx xx xxxxxxxx xxxxxx xxxxxxxxx xxx xxxxxxx.

Xxx xxxxxx xxxxxxx, xx xx xxxxxxxxx xx xxxxxxx xxxxxxxxx xxxxxxx xxxxxxxxx xxx xxxxxx xxxxxxxxxxx xxxx xx xxxxxxx xxxxxxxx xxxxx xxxxxxx xx xxxx xxxxx xxx xx xxxxxxxxxxx.

Xxxxxxx xxxxxxxxx xx xxxx xx xxx xxx xxxxxxxx xxxxx xxxx xx Xxxxxxx. Xxxxxxx xxxxxxxx xxxxxxxxx xxxxxxx xxxxxxxxxx xxx xxxxxxxx xxxxxxx xxxxxx xxxxxxxxxxxx xxx xxxxxxx xxxxxxxxx. Xxxx xxxx xxxxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxxx xx xxxxx xx xxxxxx xxx xxxxx xx xxxxxxx xxxxxx. Xxxxxxx xxxxxxxxx xxxxx xxxxxxxxxxxx, xxxx xxx xxxx xxx xxxx xxxxxx xx xxxxxxx xxxxxxxxx. Xx xxxxx xxxx xxxxx xxx Xxxxxxx xxxxxxxx xxxxxxx xxxxxxxxx xxx xxxx, xxx [Xxx xx xxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxxx](https://msdn.microsoft.com/library/windows/apps/hh770532).

## Xxxxxx xxxxxxxxxxxxxx


X xxxxxxx xx xxxxxxxxxx XXXx xxx xx xxxx xx XxxxxxX xxxxx. Xx, xx xx xxxxxxxxx xx xxxx xxx xxxxx XXX. Xxxxxxx xxxxxxxx x xxxxxxx xx xxxxxxxxxx XXXx xxxx xxxx xxx xxx xxx xx xxxxxxxxxxx xxxx xxxxx xxxxxxxxx xxx xxxxxxx xxxx xxxxxx xxx Xxxxxxxx xx xxxxxxx xxxxxxxx. Xxxx xxxxx xxxx xx xx xxxxxx xxx xxxx xxxxxxxxxx xxxxxxxx xxxx xxx xxxxx.

Xxx xxxx xxxxxxx xxxxxxx XXXx xxx xxxxx xxxxxxx:

-   XXX xxx xxxxxxx - Xxxxxxxx x xxxxxxxx xxxxxxxxxx. Xxx XXX xxx xxxx xxxxxxxxxx xxxx xxxâ€™x xxxx xxxxxxxx. XXX xxxxxx xxx xxxxxx xx xxxxxx xxxxx, xx xx xx xxxxxxxx xxxx xx xxxxx xxxx xxx xxx xxxxxxxxxxxxxx (xxxxxx-xxxxxx xx xxxxxxxx xxxx-xx-xxxx) xxxxx. XXX xxx xxxx xx xxxx xx xx xxx (xxxxx xxxx-xx-xxxx) xxxxx xxxx Xx-Xx Xxxxxx xxx Xxxxxxxxx. XXX xx xxxxxxxx xxxx xxx xxxx xxxxxx xxxxxxxx, xxxxxxxxx xxxxxxxxxxx, xxxx xxxx, xxx xxxxx xxxxxxxxxx. Xxx [**XxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226882) xxxxx xxxxxxxx x XXX xxxxxx xxxx xxx xx xxxx xx Xxxxxxx Xxxxx xxxxx. Xxx **XxxxxxXxxxxx** xxxxx xx xxxx xxxx xxxxxxx xxxxxxx xx xxx [**Xxxxxxx::Xxxxxxxxxx::Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226960) xxxxxxxxx.
-   XXX xxx xxxxxxx xxxxx XXX - Xxxxxxxx x xxxxxxxx xxxxxxxxxx xxxx xxxxxxxx xxxxxxxxxxxxx. Xxx XXX xxxxxxxxxxx xxxx XXX xxx xxxx xxxxxxxxxx xxxx xxxx xxxxxxxx. Xxx xxxxxxxxxx xxx xxxxxxxx xx XXX xxxx x xxxx xx xxxxxxx xxx xxxxxxxxxxx, xx xx xx xxxx xxxx xxxx xxxxxxxx xx xxxxxx. XXX xxxx XXX xx xxxxxxxx xxxx xxx xxxxx, xxxxxxxxxx xxx xxxxxxx xxxxxx, xxxx xxxxxxxxx xxxxxxxx xxx xxxxxxxxxx. Xxx [**XxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226882) xxxxx xxxxxxxx x XXX xxxxxx xxxx xxxxxxxx XXX.
-   XXX xxx xxxxxxx - Xxxxxxxx xxxxxxxxxx xxxxxxx xxxxxxxxx xxxx xxx xxxxxxxx. XXX xx xxxx xxx xxxx xxxxxxxxxx xxxx xxxxxxx xxx xxxxxxx xxx xxx xxxxxxxx xxxx xxxxxx xxxx. Xxxx xx xxxxx xxxx xxx xxxxxxxx xxxxx, xxxxxxxx xxx xxxxxxx, xxxxxxx xxxxx, xxx xxxxx xxxx. Xxx [**XxxxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br241319) xxxxx xxxxxxxx x XXX xxxxxx xxxx xxx xx xxxx xx Xxxxxxx Xxxxx xxxxx. Xxx **XxxxxxxxXxxxxx** xxxxx xx xxxx xxxx xxxxxxx xxxxxxx xx xxx [**Xxxxxxx::Xxxxxxxxxx::Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226960) xxxxxxxxx.
-   XXXX Xxxxxx - Xxxxxxxx x xxxxxxxx xxxxxxxxxx xx XXXX xxxxxxx. Xxx xxxx xxxxxx xxxxxxxxxx xxxxxxxx xx xx xxxxxx x xxx xxxx xx xxxxxxxx xx xxxxx xxxxxxxxxxx. X xxxxxx xxxxxxx xxxxx xx x xxxx xxxx xxxx x xxxxxxx xx xxxxx xxxx xxxxxxxxxxx xxx xxxx xxxxxx. Xxxx xxxx xxxx XXX xxx xxxxxxxx, xx XXXX xxxxxx xxx xx xxxx xxx xxxxx, xxxxxxxxxx, xxxxxxx xxxxxx, xxxx xxxxxxxxx xxxxxxxx, xxx xxxxxxxxxx. Xxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639) xxxxx xxxxxxxx x xxxxxx XXXX xxxxxx XXX xxx xxx xx Xxxxxxx Xxxxx xxxxx. Xxx **XxxxXxxxxx** xxxxx xx xxxx xxxx xxxxxxx xxxxxxx xx xxx [**Xxxxxxx::Xxx::Xxxx**](https://msdn.microsoft.com/library/windows/apps/dn279692) xxxxxxxxx.

## Xxxxxxxx xxxxxxx xxxxxxxxxx xx xxxx XxxxxxX xxxx


Xxxx x xxxxxxx xxxxxxxxx xxxxxx xx xxxx XxxxxxX xxxx, xxxx xxxxxxxxx x xxxxxxxxxxx xxxxxxx xx xxxxxxx. Xxxxxxxxxx xxx xxxxx xxx xxxx xxxxxxx xxxx xxxxx xxxxxxxxxx XXXx. Xxxxx, xxx xxxxxxxxx xxx xxxxxx xxxx xxxxxxx xx xxxxxxx xxxxxxxxxxxx xx xxxxx xxxxxxxxxx xxxxxx xxxx xxx xxxxxx xxxx xx xxxxxx.

Xxxx xxxxxx xx xxxxxxxxxx xxxx xxxxx xxxxxxxxxx XXXx xxxxxxx xxx xxxxxxxxx:

-   Xxxxx xxxx xxx xxxx xxx x xxxxxxxx xx x XXX xxxxxxxx xxxxxx xxx xx xxx xxxxx.
-   Xxxx xxxxxxxxxxx xxxxxxxx xxxx xxxxxxx xx x xxxxxxxx xx x XXx.
-   Xxxx xx xxxxxx xx xxxxxxx xxxxxxxxxxxx.
-   Xxxxxxx xxxxxxxxxx xxxxxxxx xxxxx xxxxxxx xx xxx XXXX xxxxxx XXXx.
-   Xxxxxxx xxxxxx xx xxxxxx xxxxxxxx xxxxxx.
-   Xxxxxxxxxxxxx xxxxxxxxxx xxxxxx.

Xxxxxxxxxx xxxx xxxxxxx xxxxxx (xxx xxxxxxx, xxxx xx xxxxxx xx xxxxxxxxxxxx, xxxxxxxxxx xxxxxxxx, xxx xxxxxx xxxxxxxx) xxx xxxxxx xx xxx xxxx. Xxxxx xxxxxx xxxxxx xx xxxxxxxxxx xxxxx xxxxxx. Xx xx xxxxxxxxx xx xxx xxxxxxx xx xxxx xxx, xx xxx xxxxx xxxx xxxxxx xxx xx xx xxxxxxxxxx xx xxx xxxxxxx.

Xxx xxxx xxxxx xxxx xx xxxxxx xxxxxxxxxx xxxx xxx xxxx xxxx xxxxxxxxxxxx xxxxxxx xxxxxxx. Xxxxxxxxx, xxxx xx xxxxxxxxx xxxxxx, x xxxxxxx xxxxxx xxx xx xxxxxxx xx x xxx xx xxxxxxx xxx xxxxxxx. Xxxxx xxxxx, xxxx xxx xxx xxxx xx xxxx xx xxxxxxxx xxxxxxx xxxxxxx xxxxxxxxxxxx xxxxx xxxxxxxxxx xxxxxx xxxx.

Xxxxxxxxx Xxxxxxx Xxxxxxxx (XXX) xxxx xxxxxxxxx xxxxx x xxxxxx xxxxxxxxx. Xxxx xxxxxxxxx xxxxxxx xxx xxxxxxxx xxxx xxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxx xx xxx xxxxxxxxx xx xxxxxx xxxxxxxxxx xxx xxxxxxx xxx xxxx xxxxxxxxxxx xxxxxxxxx.

Xxxx xx xxxxxxxxx xxxxxx xx x XxxxxxX xxxx xxxx xx x XXX xxx, xxx **XXXXXXX** xxxxx xxx xxx xxxxx xx xxx xxxxx xxx xx xxxxxxxxx. Xxx *Xxxxxxxx.x* xxxxxxx xxxx xxxxxxxx x xxxxx xxxx xx xxxxxxxx **XXXXXXX** xxxxxx xxxx xxxxxxxx xxxxxxx xxxxxx.

Xxx xxxxxxxxxx XXXx xxxxxxx xxxxxxxxx xxxxxxx xxx xxxxxxxxxx xxxx xxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxx xx xx xxxxxxxxx.

-   X xxxxxx xx xxxxxxxx xxx **XXXXXXX** xxxxx xx xxx xxxxx xxxx xxxxxx xxx xxxxxxxxx. Xxx xxxxxxxx xxxx xx xxxxxxxxx **XXXXXXX** xxxxxx xx xxxxx xxx xxxxxxxxxxx. Xxx **XXXXXXX** xxxxx xxx xx xxxxxxxxx xxxx xxxxx xxx xx xxx xxxxxxxxxx XXXx.
-   X xxxxxx xxxxxx xxxx xxxxxxxx xxx **XXXXXXX** xxxxx xx xx xxxxxxxxxxx xxxxx. Xxx xxxx xx xxxxxxxx xxxxxxxxxxx xxxxxx xx xxxxxxxxx xxx xxxxxxxxxx xxxxx. X xxxxxx xxxxxx xx xxxxxxxxx xxx xxx xxxxxx xxxxxxx xx xxx [**Xxxxxxx::Xxxxxxxxxx::Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226960).

### Xxxxxxxxxx xx Xxxxxxx.Xxxxxxxxxx.Xxxxxxx

Xxx xxxxxxxxxxx xxx xxx [**XxxxXxxx**](https://msdn.microsoft.com/library/windows/apps/br207113) xxxxx xxxx xxxx xxxxxxx xxx xxxxx xx xxxxxxxxx xx xxx xxxxxx xxxxxx xx xxx x xxxxx xxxxxxxx (xxxxxxxx xxxxxxxxxx xxxx xxx xxx xxxxxxx xx x xxxx xxxx). Xx xx xxx xxxx xxxxx xxxx xxx xxxx xxx xxx **XxxxXxxx** xxx x xxxx xxxxxxxxxx xxx xxxxxx, xxx xxxxxxxxxxx xxxxxx xx xx x xxx/xxxxx xxxxx. Xx xx xxxxxxxxx xx xxxxxx, xxx xxx xxx xxxxxx xxx xxxx xxx xxxxxxx x xxx xxxxxxxx.

Xxx xxxx xx xxxxxxxx x xxxxxx xxx x xxxxxxxx xxxx xxx xxxx

```cpp

    // Define some variables at the class level.
    Windows::Networking::HostName^ remoteHost;

    bool isHostnameFromUser = false;
    bool isHostnameValid = false;

    ///...

    // If the value of 'remoteHostname' is set by the user in a control as input 
    // and is therefore untrusted input and could contain errors. 
    // If we can't create a valid hostname, we notify the user in statusText 
    // about the incorrect input.

    String ^hostString = remoteHostname;

    try 
    {
        remoteHost = ref new Windows::Networking:Host(hostString);
        isHostnameValid = true;
    }
    catch (InvalidArgumentException ^ex)
    {
        statusText->Text = "You entered a bad hostname, please re-enter a valid hostname.";
        return;
    }

    isHostnameFromUser = true;


    // ... Continue with code to execute with a valid hostname.
```

Xxx [**Xxxxxxx.Xxxxxxxxxx.Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226960) xxxxxxxxx xxx xxxxxxxxxx xxxxxx xxxxxxx xxx xxxxxxxxxxxx xxx xxxxxxxx xxxxxx xxxx xxxxx xxxxxxx. Xxxx xxx xx xxxxxx xxx xxxxxxxx xxxxxxxx xxxxxxx xxxxxxxxxx xxxxxxxxxxx xx xxxx xxx.

Xx xxxxx xxxxxxxxxxx xx [**XxxxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br241319), [**XxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226882), xx [**XxxxxxXxxxxxXxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226906) xxxxxxxxx xxxxxxx xx xx xxxxxxxxx xxxxx xxxxxx. Xxx xxxxx xx xxx xxxxxxxxx xx xx xxxxx xxxxx xxxxxxxxxxx xx xx **XXXXXXX** xxxxx. Xxx [**XxxxxxXxxxx.XxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh701462) xxxxxx xx xxxx xx xxxxxxx x xxxxxxx xxxxx xxxx x xxxxxx xxxxxxxxx xx x [**XxxxxxXxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh701457) xxxxxxxxxxx xxxxx. Xxxx xx xxx **XxxxxxXxxxxXxxxxx** xxxxxxxxxxx xxxxxx xxxxxxxxxx xx xx xxxxx xxxxxxxx xx xxx xxxxxx Xxxxxxx xxxxxxx xxxxxxxxx. Xx xxx xxx xxxxxx xx xxxxxxxx **XxxxxxXxxxxXxxxxx** xxxxxxxxxxx xxxxxx xx xxxxxx xxx xxxxxxxx xxxxxxxxx xx xxx xxxxx xx xxx xxxxxxxxx.

Xxx xxxxxxxxx xxxxxxxxxx xxxxxx, xx xxx xxx xxxx xxx xxx **XXXXXXX** xxxx xxx xxxxxxxxx xx xxxxx xxxx xxxxxxxx xxxxxxxxxxx xxxxx xxx xxxxx xxxx xxxxxx xxx xxxxxxxxx. Xxxxxxxx **XXXXXXX** xxxxxx xxx xxxxxx xx xxx *Xxxxxxxx.x* xxxxxx xxxx. Xxx xxxx xxxxxxxxx xxxxxxxxxx xxxxxx, xxx **XXXXXXX** xxxxxxxx xx **X\_XXXXXXXXXX**.

Xxx xxxx xx xxxxxx xxxxxxxxxx xxxx xxxxxx xx xxxx x xxxxxx xxxxxx xxxxxxxxxx

```cpp
using namespace Windows::Networking;
using namespace Windows::Networking::Sockets;

    
    // Define some more variables at the class level.

    bool isSocketConnected = false
    bool retrySocketConnect = false;

    // The number of times we have tried to connect the socket.
    unsigned int retryConnectCount = 0;

    // The maximum number of times to retry a connect operation.
    unsigned int maxRetryConnectCount = 5; 
    ///...

    // We pass in a valid remoteHost and serviceName parameter.
    // The hostname can contain a name or an IP address.
    // The servicename can contain a string or a TCP port number.

    StreamSocket ^ socket = ref new StreamSocket();
    SocketErrorStatus errorStatus; 
    HResult hr;

    // Save the socket, so any subsequent steps can use it.
    CoreApplication::Properties->Insert("clientSocket", socket);

    // Connect to the remote server. 
    create_task(socket->ConnectAsync(
            remoteHost,
            serviceName,
            SocketProtectionLevel::PlainSocket)).then([this] (task<void> previousTask)
    {
        try
        {
            // Try getting all exceptions from the continuation chain above this point.
            previousTask.get();

            isSocketConnected = true;
            // Mark the socket as connected. We do not really care about the value of the property, but the mere 
            // existence of  it means that we are connected.
            CoreApplication::Properties->Insert("connected", nullptr);
        }
        catch (Exception^ ex)
        {
            hr = ex.HResult;
            errorStatus = SocketStatus::GetStatus(hr); 
            if (errorStatus != Unknown)
            {
                                                                switch (errorStatus) 
                   {
                    case HostNotFound:
                        // If the hostname is from the user, this may indicate a bad input.
                        // Set a flag to ask the user to re-enter the hostname.
                        isHostnameValid = false;
                        return;
                        break;
                    case ConnectionRefused:
                        // The server might be temporarily busy.
                        retrySocketConnect = true;
                        return;
                        break; 
                    case NetworkIsUnreachable: 
                        // This could be a connectivity issue.
                        retrySocketConnect = true;
                        break;
                    case UnreachableHost: 
                        // This could be a connectivity issue.
                        retrySocketConnect = true;
                        break;
                    case NetworkIsDown: 
                        // This could be a connectivity issue.
                        retrySocketConnect = true;
                        break;
                    // Handle other errors. 
                    default: 
                        // The connection failed and no options are available.
                        // Try to use cached data if it is available. 
                        // You may want to tell the user that the connect failed.
                        break;
                }
                }
                else 
                {
                    // Received an Hresult that is not mapped to an enum.
                    // This could be a connectivity issue.
                    retrySocketConnect = true;
                }
            }
        });
    }

```

### Xxxxxxxxxx xx Xxxxxxx.Xxx.Xxxx

Xxx xxxxxxxxxxx xxx xxx [**Xxxxxxx::Xxxxxxxxxx::Xxx**](https://msdn.microsoft.com/library/windows/apps/br225998) xxxxx xxxx xxxx [**Xxxxxxx::Xxx::Xxxx::XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639) xxx xxxxx xx xxxxxxxxx xx xxx xxxxxx xxxxxx xx xxx x xxxxx XXX (xxxxxxxx xxxxxxxxxx xxxx xxx xxx xxxxxxx xx x XXX). Xx X++, xxxxx xx xx xxxxxx xx xxx xxx xxxxx x xxxxxx xx x XXX. Xx xx xxx xxxx xxxxx xxxx xxx xxxx xxx xxx **Xxxxxxx::Xxxxxxxxxx::Xxx**, xxx xxxxxxxxxxx xxxxxx xx xx x xxx/xxxxx xxxxx. Xx xx xxxxxxxxx xx xxxxxx, xxx xxx xxx xxxxxx xxx xxxx xxx xxxxxxx x xxx XXX.

Xxxx xxx xxxxxx xxxx xxxxx xxxx xxx xxxxxx xx xxx XXX xx XXXX xx XXXXX xxxxx xxxxx xxx xxx xxxx xxxxxxx xxxxxxxxx xx xxx [**Xxxxxxx::Xxx::Xxxx::XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639).

Xxx xxxx xx xxxxxxxx x xxxxxx xxx x XXX xxxx xxx xxxx

```cpp

    // Define some variables at the class level.
    Windows::Foundation::Uri^ resourceUri;

    bool isUriFromUser = false;
    bool isUriValid = false;

    ///...

    // If the value of 'inputUri' is set by the user in a control as input 
    // and is therefore untrusted input and could contain errors. 
    // If we can't create a valid hostname, we notify the user in statusText 
    // about the incorrect input.

    String ^uriString = inputUri;

    try 
    {
        isUriValid = false;
        resourceUri = ref new Windows::Foundation:Uri(uriString);

        if (resourceUri->SchemeName != "http" && resourceUri->SchemeName != "https")
        {
            statusText->Text = "Only 'http' and 'https' schemes supported. Please re-enter URI";
            return;
        }
        isUriValid = true;
    }
    catch (InvalidArgumentException ^ex)
    {
        statusText->Text = "You entered a bad URI, please re-enter Uri to continue.";
        return;
    }

    isUriFromUser = true;


    // ... Continue with code to execute with a valid URI.
```

Xxx [**Xxxxxxx::Xxx::Xxxx**](https://msdn.microsoft.com/library/windows/apps/windows.web.http.aspx) xxxxxxxxx xxxxx x xxxxxxxxxxx xxxxxxxx. Xx, xx xxx xxxxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639) xxx xxxxx xxxxxxx xx xxxx xxxxxxxxx xxxxx xx xxx xxx **XXXXXXX** xxxxx.

Xx xxxx xxxxx X++, xxx [**Xxxxxxxx::Xxxxxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh755825.aspx) xxxxxxxxxx xx xxxxx xxxxxx xxx xxxxxxxxx xxxx xx xxxxxxxxx xxxxxx. Xxx [**Xxxxxxxx::Xxxxxxxxx::XXxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh763371.aspx) xxxxxxxx xxxxxxx xxx **XXXXXXX** xxxxxxxx xx xxx xxxxxxxx xxxxxxxxx. Xxx [**Xxxxxxxx::Xxxxxxxxx::Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/hh763375.aspx) xxxxxxxx xxxxxxx xxx xxxxxx-xxxxxxxx xxxxxx xxxx xx xxxxxxxxxx xxxx xxx **XXXXXXX** xxxxx. Xxxxxxxx **XXXXXXX** xxxxxx xxx xxxxxx xx xxx *Xxxxxxxx.x* xxxxxx xxxx. Xx xxx xxx xxxxxx xx xxxxxxxx **XXXXXXX** xxxxxx xx xxxxxx xxx xxxxxxxx xxxxxxxxx xx xxx xxxxx xx xxx xxxxxxxxx.

Xxx xxxx xxxxxxxxx xxxxxxxxxx xxxxxx, xxx **XXXXXXX** xxxxxxxx xx **X\_XXXXXXXXXX**. Xxx xxxx xxxxxxx xxxxxx xxxxx, xxx **XXXXXXX** xxxxxxxx xx **X\_XXXXXXX\_XXXXXX\_XXXX**.

Xxx xxxx xx xxxxxx xxxxxxxxxx xxxx xxxxxx xx xxx [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639) xx xxxxxxx xx xx XXXX xxxxxx

```cpp
using namespace Windows::Foundation;
using namespace Windows::Web::Http;
    
    // Define some more variables at the class level.

    bool isHttpClientConnected = false
    bool retryHttpClient = false;

    // The number of times we have tried to connect the socket
    unsigned int retryConnectCount = 0;

    // The maximum number of times to retry a connect operation.
    unsigned int maxRetryConnectCount = 5; 
    ///...

    // We pass in a valid resourceUri parameter.
    // The URI must contain a scheme and a name or an IP address.

    HttpClient ^ httpClient = ref new HttpClient();
    HResult hr;

    // Save the httpClient, so any subsequent steps can use it.
    CoreApplication::Properties->Insert("httpClient", httpClient);

    // Send a GET request to the HTTP server. 
    create_task(httpClient->GetAsync(resourceUri)).then([this] (task<void> previousTask)
    {
        try
        {
            // Try getting all exceptions from the continuation chain above this point.
            previousTask.get();

            isHttpClientConnected = true;
            // Mark the HttClient as connected. We do not really care about the value of the property, but the mere 
            // existence of  it means that we are connected.
            CoreApplication::Properties->Insert("connected", nullptr);
        }
        catch (Exception^ ex)
        {
            hr = ex.HResult;
                                                switch (errorStatus) 
               {
                case WININET_E_NAME_NOT_RESOLVED:
                    // If the Uri is from the user, this may indicate a bad input.
                    // Set a flag to ask user to re-enter the Uri.
                    isUriValid = false;
                    return;
                    break;
                case WININET_E_CANNOT_CONNECT:
                    // The server might be temporarily busy.
                    retryHttpClientConnect = true;
                    return;
                    break; 
                case WININET_E_CONNECTION_ABORTED: 
                    // This could be a connectivity issue.
                    retryHttpClientConnect = true;
                    break;
                case WININET_E_CONNECTION_RESET: 
                    // This could be a connectivity issue.
                    retryHttpClientConnect = true;
                    break;
                case INET_E_RESOURCE_NOT_FOUND: 
                    // The server cannot locate the resource specified in the uri.
                    // If the Uri is from user, this may indicate a bad input.
                    // Set a flag to ask the user to re-enter the Uri
                    isUriValid = false;
                    return;
                    break;
                // Handle other errors. 
                default: 
                    // The connection failed and no options are available.
                    // Try to use cached data if it is available. 
                    // You may want to tell the user that the connect failed.
                    break;
            }
            else 
            {
                // Received an Hresult that is not mapped to an enum.
                // This could be a connectivity issue.
                retrySocketConnect = true;
            }
        }
    });
    

```

## Xxxxxxx xxxxxx


**Xxxxx xxxxxxxxx**

* [Xxxxxxxxxx xxxx x xxxxxxxx xxxxxx](https://msdn.microsoft.com/library/windows/apps/xaml/jj635238)
* [Xxxxxxxxxx xx x xxxxxxx xxxxxxxx xxxx x xxxxxx xxxxxx](https://msdn.microsoft.com/library/windows/apps/xaml/jj150599)
* [Xxxxxxxxxx xx xxxxxxx xxxxxxxx](https://msdn.microsoft.com/library/windows/apps/xaml/hh452976)
* [Xxxxxxxxxx xx xxx xxxxxxxx](https://msdn.microsoft.com/library/windows/apps/xaml/hh761504)
* [Xxxxxxxxxx xxxxxx](https://msdn.microsoft.com/library/windows/apps/mt280233)
* [Xxx xx xxxxxxxxx xxxxxxx xxxxxxxxx xxxxxxxxxxxx](https://msdn.microsoft.com/library/windows/apps/hh770532)
* [Xxx xx xxxxxx xxxxxxxx xxx xxxxx xxxxxxx xxxxxxxxx](https://msdn.microsoft.com/library/windows/apps/hh780593)

**Xxxxxxxxx**

* [**XxxxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br241319)
* [**XxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/dn298639)
* [**XxxxxxXxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226882)
* [**Xxxxxxx::Xxx::Xxxx**](https://msdn.microsoft.com/library/windows/apps/dn279692)
* [**Xxxxxxx::Xxxxxxxxxx::Xxxxxxx**](https://msdn.microsoft.com/library/windows/apps/br226960)

**Xxxxxxx**

* [XxxxxxxxXxxxxx xxxxxx](http://go.microsoft.com/fwlink/p/?LinkID=243037)
* [XxxxXxxxxx Xxxxxx]( http://go.microsoft.com/fwlink/p/?linkid=242550)
* [Xxxxxxxxx xxxxxx](http://go.microsoft.com/fwlink/p/?linkid=245082)
* [XxxxxxXxxxxx xxxxxx](http://go.microsoft.com/fwlink/p/?linkid=243037)
<!--HONumber=Mar16_HO1-->
