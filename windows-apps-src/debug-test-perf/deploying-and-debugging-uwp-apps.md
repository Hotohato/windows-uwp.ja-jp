---
author: mcleblanc
ms.assetid: 9322B3A3-8F06-4329-AFCB-BE0C260C332C
description: "この記事では、さまざまな展開およびデバッグのターゲットを指定する手順について説明します。"
title: "ユニバーサル Windows プラットフォーム (UWP) アプリの展開とデバッグ"
translationtype: Human Translation
ms.sourcegitcommit: 14f6684541716034735fbff7896348073fa55f85
ms.openlocfilehash: e2209e90080c7346bb363304b1a28f6446300332

---

# ユニバーサル Windows プラットフォーム (UWP) アプリの展開とデバッグ

\[Windows 10 の UWP アプリ向けに更新。 Windows 8.x の記事については、[アーカイブ](http://go.microsoft.com/fwlink/p/?linkid=619132)をご覧ください\]

この記事では、さまざまな展開およびデバッグのターゲットを指定する手順について説明します。

Microsoft Visual Studio では、さまざまな Windows 10 デバイスにユニバーサル Windows プラットフォーム (UWP) アプリを展開してデバッグできます。 Visual Studio は、ターゲット デバイスにアプリケーションを展開して登録するプロセスを処理します。

## 展開ターゲットの選択

ターゲットを選択するには、**[デバッグの開始]** ボタンの横にあるデバッグ ターゲットのドロップダウンに移動し、アプリケーションの展開先のターゲットを選択します。 ターゲットを選択した後で、そのターゲットに展開してデバッグする場合は **[デバッグの開始 (F5)]** を選択し、単にそのターゲットに展開する場合は **Ctrl + F5** キーを押します。

![](images/debug-device-target-list.png)

-   **[ローカル コンピューター]** は、現在の開発コンピューターにアプリケーションを展開します。 このオプションは、アプリケーションの **[ターゲット プラットフォームの最小バージョン]** が開発コンピューターのオペレーティング システム以下である場合にのみ使用できます。
-   **[シミュレーター]** は、現在の開発コンピューター上のシミュレートされた環境にアプリケーションを展開します。 このオプションは、アプリケーションの **[ターゲット プラットフォームの最小バージョン]** が開発コンピューターのオペレーティング システム以下である場合にのみ使用できます。
-   **[デバイス]** は、USB 接続のデバイスにアプリケーションを展開します。 デバイスが開発者によりロック解除され、画面がロック解除されている必要があります。
-   **[エミュレーター]** ターゲットが起動し、名前で指定された構成のエミュレーターにアプリケーションが展開されます。 エミュレーターは、Windows 8.1 以降を実行している Hyper-V 対応コンピューターでのみ使用できます。
-   **[リモート コンピューター]** では、アプリケーションを展開するリモート ターゲットを指定できます。 リモート コンピューターへの展開について詳しくは、「[リモート デバイスの指定](#specifying-a-remote-device)」をご覧ください。

## 展開されているアプリのデバッグ
Visual Studio では、**[デバッグ]**、**[プロセスにアタッチ]** の順に選ぶことによって、実行中の任意の UWP アプリ プロセスにアタッチすることもできます。 実行中のプロセスにアタッチする場合、元の Visual Studio プロジェクトは必要ありませんが、プロセスの[シンボル](#symbols)を読み込むことは、元のコードを持たないプロセスのデバッグ時に非常に役立ちます。  
  
さらに、**[デバッグ]**、**[その他]**、**[インストールされているアプリケーション パッケージのデバッグ]** を選択することによって、インストール済みのアプリ パッケージにアタッチしてデバッグすることができます。   
 
![[インストールされているアプリケーション パッケージのデバッグ] ダイアログ ボックス](images/gs-debug-uwp-apps-002.png)  

**[起動はしないが、開始時にコードをデバッグする]** を選択すると、Visual Studio デバッガーは、UWP アプリが独自のタイミングで起動したときに、UWP アプリにアタッチします。 これは、カスタム パラメーターを使ったプロトコルのアクティブ化など、[さまざまな起動方法](../xbox-apps/automate-launching-uwp-apps.md)からの制御パスをデバッグするのに効果的な方法です。  

UWP アプリは、Windows 8.1 以降で開発してコンパイルすることができますが、実行するには Windows 10 が必要です。 Windows 8.1 PC で UWP アプリを開発している場合、別の Windows 10 デバイスで実行されている UWP アプリをリモートでデバッグできます。ただし、ホストとターゲットの両方のコンピューターが同じ LAN に接続されている必要があります。 これを行うには、両方のコンピューターに [Remote Tools for Visual Studio](http://aka.ms/remotedebugger) をダウンロードしてインストールします。 インストールするバージョンはインストール済みの Visual Studio の既存のバージョンと一致している必要があり、選択するアーキテクチャ (x86、x64) もターゲット アプリケーションのアーキテクチャと一致している必要があります。   
  

## リモート デバイスの指定

### C# および Microsoft Visual Basic

C# または Microsoft Visual Basic のアプリのリモート コンピューターを指定するには、デバッグ ターゲットのドロップダウンで **[リモート コンピューター]** を選択します。 **[リモート接続]** ダイアログが表示され、IP アドレスを指定するか、または検出されたデバイスを選択できます。 既定では、**[ユニバーサル]** 認証モードが選択されます。 使用する認証モードを決定するには、「[認証モード](#authentication-modes)」をご覧ください。

![](images/debug-remote-connections.png)

このダイアログに戻るには、プロジェクト プロパティを開き、**[デバッグ]** タブに移動します。 そこから、**[リモート コンピューター:]** の横にある **[検索…]**

![](images/debug-remote-machine-config.png)

アプリケーションをリモート PC に展開するには、Visual Studio リモート ツールをターゲット PC にダウンロードしてインストールする必要もあります。 詳しい手順については、「[リモート PC の手順](#remote-pc-instructions)」をご覧ください。

### C++ および JavaScript

C++ または JavaScript UWP アプリのリモート コンピューター ターゲットを指定するには、**[ソリューション エクスプローラー]** でプロジェクトを右クリックしてプロジェクト プロパティに移動し、**[プロパティ]** をクリックします。 **[デバッグ]** 設定に移動し、**[起動するデバッガー]** を **[リモート コンピューター]** に変更します。 次に、**[コンピューター名]** を入力 (または **[検索…]** をクリックして検出) し、**[認証の種類]** プロパティを設定します。

![](images/debug-property-pages.png)
コンピューターを指定した後で、デバッグ ターゲットのドロップダウンで **[リモート コンピューター]** を選択し、その指定コンピューターに戻ることができます。 一度に選ぶことができるリモート コンピューターは 1 つだけです。

### リモート PC の手順

リモート PC に展開するには、ターゲット PC に Visual Studio リモート ツールがインストールされている必要があります。 また、リモート PC がアプリの **[ターゲット プラットフォームの最小バージョン]** プロパティ以上の Windows バージョンを実行している必要もあります。 リモート ツールをインストールしたら、ターゲット PC でリモート デバッガーを起動する必要があります。 これを行うには、**[スタート]** メニューで **[リモート デバッガー]** を探して起動し、プロンプトが表示されたらデバッガーがファイアウォール設定を構成できるようにします。 既定では、デバッガーは Windows 認証を使用して起動します。 両方の PC でログイン ユーザーが同じでない場合、これにはユーザー資格情報が必要になります。 **[認証なし]** に変更するには、**[リモート デバッガー]** で **[ツール]** -&gt;**[オプション]** の順にクリックし、**[認証なし]** に設定します。 リモート デバッガーを設定したら、開発コンピューターから展開できます。

詳しくは、[Remote Tools for Visual Studio]( http://go.microsoft.com/fwlink/?LinkId=717039) ダウンロード ページをご覧ください。

## 認証モード

リモート コンピューターへの展開用に 3 つの認証モードがあります。

- **[ユニバーサル (暗号化されていないプロトコル)]**: Windows PC (デスクトップまたはラップトップ) ではないリモート デバイスに展開するときは、必ずこの認証モードを使います。 現時点では、これは IoT デバイスのみです。 ユニバーサル (暗号化されていないプロトコル) は、信頼されたネットワークで使う必要があります。 デバッグ接続は、開発マシンとリモート マシンとの間で渡されるデータを傍受して変更できる悪意のあるユーザーに対して脆弱です。
- **[Windows]**: この認証モードは、リモート PC への展開 (デスクトップまたはラップトップ) に使用することのみを意図しています。 ターゲット コンピューターのログイン ユーザーの資格情報にアクセスできる場合は、この認証モードを使用します。 これは、リモート展開用の最も安全なチャネルです。
- **[なし]**: この認証モードは、リモート PC への展開 (デスクトップまたはラップトップ) に使用することのみを意図しています。 テスト アカウントがログインしていて資格情報を入力できない環境にテスト コンピューターがセットアップされている場合は、この認証モードを使用します。 リモート デバッガーの設定が、認証を受け入れないように設定されていることを確認してください。

## デバッグのオプション

Windows 10 では、 [事前起動](https://msdn.microsoft.com/library/windows/apps/Mt593297)と呼ばれる手法でアプリを事前に起動してから中断することにより、UWP アプリの起動パフォーマンスが向上します。 多くのアプリケーションはこのモードで動作するために特別に何もする必要はありませんが、一部のアプリケーションでは動作を調整する必要があります。 これらのコード パスの問題をデバッグするために、事前起動モードで Visual Studio からアプリのデバッグを開始できます。 デバッグは、Visual Studio プロジェクト (**[デバッグ]** -&gt;**[その他のデバッグ ターゲット]** -&gt;**[ユニバーサル Windows アプリ事前起動のデバッグ]**)、および既にコンピューターにインストールされているアプリ (**[デバッグ]** -&gt;**[その他のデバッグ ターゲット]** -&gt;**[インストールされているアプリケーション パッケージのデバッグ]**、**[事前起動を使用してアプリをアクティブ化]** のボックスをオンにする) の両方でサポートされます。 詳しくは、[事前起動 UWP をデバッグする]( http://go.microsoft.com/fwlink/?LinkId=717245)方法をお読みください。

スタートアップ プロジェクトの **[デバッグ]** プロパティ ページで、次の展開オプションを設定できます。

**[Allow Network Loopback] (ネットワーク ループバックの許可)**

セキュリティ上の理由で、標準的な方法でインストールされた UWP アプリでは、それがインストールされているデバイスに対してネットワーク呼び出しを実行することは許可されません。 既定では、Visual Studio の展開では、展開されたアプリについてこの規則が除外されます。 この除外により、単一コンピューター上で通信手順をテストできます。 アプリを Windows ストアに申請する前に、この除外を使用せずにアプリをテストする必要があります。

ネットワーク ループバックに関する除外をアプリから除去するには:

-   C# および Visual Basic の **[デバッグ]** プロパティ ページで、**[Allow Network Loopback] (ネットワーク ループバックの許可)** チェック ボックスをオフにします。
-   JavaScript および C++ の **[デバッグ]** プロパティ ページで、**[Allow Network Loopback] (ネットワーク ループバックの許可)** 値を **[いいえ]** に設定します。

**[起動しないが、開始時にマイ コードをデバッグする] (C# および Visual Basic) / [アプリの起動] (JavaScript および C++)**

アプリ起動時にデバッグ セッションが自動的に開始されるように展開を構成するには:

-   C# および Visual Basic の **[デバッグ]** プロパティ ページで、**[起動しないが、開始時にマイ コードをデバッグする]** チェック ボックスをオンにします。
-   JavaScript および C++ の **[デバッグ]** プロパティ ページで、**[アプリの起動]** 値を **[はい]** に設定します。

## シンボル

シンボル ファイルには、変数、関数名、エントリ ポイントのアドレスなど、コードをデバッグするときに非常に便利な値が格納されており、例外とコールスタックの実行順序を把握することができます。 ほとんどの種類の Windows のシンボルは、[Microsoft シンボル サーバー](http://msdl.microsoft.com/download/symbols)から利用することも、高速にオフラインで参照できるように [Windows シンボル パッケージのダウンロード サイト](http://aka.ms/winsymbols)からダウンロードすることもできます。

Visual Studio のシンボル オプションを設定するには、**[ツール] の [オプション]** を選択し、ダイアログ ウィンドウで **[デバッグ]、[シンボル]** の順に移動します。

**図 4. [オプション] ダイアログ ボックス**
            
![[オプション] ダイアログ ボックス](images/gs-debug-uwp-apps-004.png)

[WinDbg](#windbg) を使ってデバッグ セッションでシンボルを読み込むには、**sympath** 変数をシンボル パッケージの場所に設定します。 たとえば、次のコマンドを実行すると、Microsoft シンボル サーバーからシンボルが読み込まれ、C:\Symbols ディレクトリにキャッシュされます。

```
.sympath SRV*C:\Symbols*http://msdl.microsoft.com/download/symbols
.reload
```

区切り文字 ';' を使用して複数のパスを追加したり、`.sympath+` コマンドを使用することもできます。 WinDbg を使用する高度なシンボル操作については、「[パブリック シンボルとプライベート シンボル](https://msdn.microsoft.com/library/windows/hardware/ff553493)」をご覧ください。

## WinDbg

WinDbg は、[Windows SDK](http://go.microsoft.com/fwlink/p?LinkID=271979) に含まれる、Debugging Tools for Windows の一部として出荷される強力なデバッガーです。 Windows SDK のインストールでは、スタンドアロン製品として Debugging Tools for Windows をインストールすることができます。 ネイティブ コードのデバッグには非常に便利ですが、マネージ コードや HTML5 で記述されたアプリについては WinDbg の使用をお勧めできません。 

UWP アプリで WinDbg を使用するには、前のセクションで説明したように、最初に PLMDebug を使用して、アプリ パッケージの PLM を無効にする必要があります。 

```
plmdebug /enableDebug [PackageFullName] "\"C:\Program Files\Debugging Tools for Windows (x64)\WinDbg.exe\" -server npipe:pipe=test"
```

Visual Studio とは対照的に、WinDbg のコア機能の多くは、コマンド ウィンドウにコマンドを入力する必要があります。 入力したコマンドによって、実行状態の表示、ユーザー モードのクラッシュ ダンプの調査、さまざまなモードでのデバッグを行うことができます。 

WinDbg で最もよく使用されるコマンドの 1 つが `!analyze -v` であり、次のように、現在の例外に関する詳細な情報を取得するために使用されます。

- FAULTING_IP: 障害発生時の命令ポインター
- EXCEPTION_RECORD: 現在の例外のアドレス、コード、フラグ
- STACK_TEXT: 例外の前のスタック トレース

WinDbg のすべてのコマンドの一覧については、[デバッガー コマンドに関するページ](https://msdn.microsoft.com/library/ff540507)をご覧ください。

## 関連トピック
- [プロセス ライフタイム管理 (PLM) のテスト ツールとデバッグ ツール](testing-debugging-plm.md)
- [デバッグ、テスト、パフォーマンス](index.md)



<!--HONumber=Jun16_HO4-->


